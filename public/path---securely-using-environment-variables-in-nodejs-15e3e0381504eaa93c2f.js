webpackJsonp([0xfbe33b7b6555],{1313:function(e,t){e.exports={data:{post:{id:"/app/content/posts/2018-11-14--securely-using-environment-variables-in-nodejs/index.md absPath of file >>> MarkdownRemark",html:'<h2 id="handling-secrets--api-tokens-safely"><a href="#handling-secrets--api-tokens-safely" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Handling Secrets &#x26; API Tokens Safely</h2>\n<p>\n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 645px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 83.11840562719813%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5s16o56VWaSMQr//xAAbEAEAAgIDAAAAAAAAAAAAAAACATEAIQMRMv/aAAgBAQABBQIbO4hWK5OpKsYvU3//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAABBAMAAAAAAAAAAAAAAAAQAAERIQIxQf/aAAgBAQAGPwKFfBtNDXBxH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExEEFhgaH/2gAIAQEAAT8heTRZiD4NqVbKwXZoBDivcdQ/M19ci//aAAwDAQACAAMAAAAQ3ADA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhABAQACAgIDAAAAAAAAAAAAAREAMUFxUWGhwdH/2gAIAQEAAT8QFZFF7aTEO4EM8RXrFSCg8YqyW0K0WTFinAQrmHPea0CA36zZ3+8+J+Ztz//Z\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;"\n        alt="credit: john-salvino-417565-unsplash.jpg"\n        title=""\n        src="/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ef7b7.jpg"\n        srcset="/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-c3db7.jpg 161w,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-e67ed.jpg 323w,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ef7b7.jpg 645w,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-07a29.jpg 853w"\n        sizes="(max-width: 645px) 100vw, 645px"\n      />\n    </span>\n  </span>\n  </p>\n<h3 id="related-article-protect-your-tokens"><a href="#related-article-protect-your-tokens" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Related Article: <a href="/protect-your-tokens/">Protect Your Tokens</a></h3>\n<p>Let‚Äôs quickly recap the difference between <code class="language-text">secret</code> and <code class="language-text">non-secret</code>.</p>\n<ul>\n<li>üîí <code class="language-text">Secret keys</code> MUST use a custom server (e.g. Node/Express/Heroku) in order to hide (proxy) requests to 3rd party API services.</li>\n<li>üåç <code class="language-text">Non-secret keys</code> describes keys which can be sent to the browser.</li>\n</ul>\n<br />\n<hr>\n<blockquote>\n<p>We‚Äôll focus on dealing with üîí <code class="language-text">Secret keys</code> using <strong>Environment Variables</strong> in this article.</p>\n</blockquote>\n<p><a href="#%EF%B8%8F-code-example">Code examples are included below.</a></p>\n<h4 id="overview"><a href="#overview" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h4>\n<p>To <strong>safely access secrets in your NodeJS code:</strong></p>\n<ol>\n<li>Replace hard-coded keys with environment variables. e.g. <code class="language-text">process.env.API_SECRET</code></li>\n<li>Use a library like <a href="https://github.com/motdotla/dotenv"><code class="language-text">dotenv</code></a> along with a <code class="language-text">.env</code> file. Add your previously hard-coded secrets to the <code class="language-text">.env</code> file.</li>\n<li>Verify <code class="language-text">.env</code> line in your <code class="language-text">.gitignore</code> file!</li>\n</ol>\n<blockquote>\n<p><strong>DON‚ÄôT</strong> create a <code class="language-text">.env</code> file on deployed servers. Use your hosting services‚Äô (e.g. <a href="https://devcenter.heroku.com/articles/config-vars">Heroku</a>, Netlify, AWS EC2) provided environment variable management tool: e.g. <strong>dashboard or command line.</strong></p>\n</blockquote>\n<h2 id="Ô∏è-code-example"><a href="#%EF%B8%8F-code-example" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ô∏è Code Example:</h2>\n<p>We‚Äôre going to define a few files.</p>\n<ol>\n<li><code class="language-text">.env</code></li>\n<li><code class="language-text">./db/connection.js</code></li>\n<li><code class="language-text">./api/users.js</code></li>\n</ol>\n<!-- Example config object which uses `process.env.PG*`\n\n```js\n// ./db/config.js\nmodule.exports = {\n  postgres: {\n    host: process.env.PGHOST || \'localhost\',\n    port: process.env.PGPORT || 5234,\n    user: process.env.PGUSER || \'postgres\',\n    password: process.env.PGPASSWORD || \'password\',\n    database: process.env.PGDATABASE || \'postgres\',\n  }\n};\n```\n\nThe `db/config.js` file is just an example of how your secrets should be stored for re-use in your code.\n-->\n<p>First, install the <a href="https://www.npmjs.com/package/dotenv"><code class="language-text">dotenv</code></a> package.</p>\n<div class="gatsby-highlight" data-language="bash">\n      <pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> dotenv</code></pre>\n      </div>\n<p>Next, create a <code class="language-text">.env</code> in the root of your project.</p>\n<div class="gatsby-highlight" data-language="text">\n      <pre class="language-text"><code class="language-text"># .env\nPGDATABASE=&quot;postgres&quot;\nPGHOST=&quot;localhost&quot;\nPGPORT=5234\nPGUSER=&quot;postgres&quot;\nPGPASSWORD=&quot;password&quot;</code></pre>\n      </div>\n<p>‚ùå <strong>NEVER</strong> commit <code class="language-text">.env</code> file.</p>\n<p>‚ùå Avoid creating <code class="language-text">.env</code> on servers.</p>\n<p>Check your Hosting Provider docs to set up <em>environment variables</em>.</p>\n<p>To easily make sure your <code class="language-text">.gitignore</code> has a <code class="language-text">.env</code> line in it.</p>\n<div class="gatsby-highlight" data-language="bash">\n      <pre class="language-bash"><code class="language-bash"><span class="token comment"># Automatically update .gitignore</span>\n<span class="token comment"># Run in terminal:</span>\n<span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> <span class="token string">\'^.env\'</span> .gitignore<span class="token variable">)</span></span>"</span> <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">echo</span> <span class="token string">\'.env\'</span> <span class="token operator">>></span> .gitignore\n<span class="token comment"># note: no output will print</span></code></pre>\n      </div>\n<p>The <code class="language-text">./db/connection.js</code> provides a shared <code class="language-text">pg.Pool</code> instance. It‚Äôll be used to query the database.</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ./db/connection.js</span>\n<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'dotenv\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ‚úÖ Load .env file</span>\n<span class="token keyword">const</span> pg <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'pg\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token constant">PGUSER</span><span class="token punctuation">,</span> <span class="token constant">PGHOST</span><span class="token punctuation">,</span> <span class="token constant">PGPORT</span><span class="token punctuation">}</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">;</span>\n\n<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">\'development\'</span><span class="token punctuation">)</span>\n  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`Connecting to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PGUSER</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> @ </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PGHOST</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PGHOST</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ^^ only for showing debug connection vars</span>\n\n<span class="token comment">// pg automatically uses PG* env variables</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">pg<span class="token punctuation">.</span>Pool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>The <code class="language-text">./api</code> folder contains interfaces to your tables/views.</p>\n<p>Here‚Äôs an example <code class="language-text">./api/users.js</code> for the <code class="language-text">users</code> table.</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token comment">// ./api/users.js</span>\n<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'../db/connection.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  findUsername<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">\'SELECT * FROM users WHERE username=$1\'</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<h4 id="never-commit-your-env-secrets-to-git"><a href="#never-commit-your-env-secrets-to-git" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Never commit your <code class="language-text">.env</code> secrets to git!</h4>\n<h4 id="dont-share-env-files-on-a-team-"><a href="#dont-share-env-files-on-a-team-" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Don‚Äôt share <code class="language-text">.env</code> files on a team. *</h4>\n<p>* Every new development laptop or desktop should <strong>generate new access keys &#x26; tokens.</strong>\nIf it‚Äôs not possible, use plenty of care sharing your <code class="language-text">.env</code> (in cases where a service might invalidate all older keys, or you have a paid API‚Äôs limited access token.)</p>\n<h4 id="Ô∏è-important-if-necessary-always-use-a-secure-messaging-service-preferably-with-expiring-message-support"><a href="#%EF%B8%8F-important-if-necessary-always-use-a-secure-messaging-service-preferably-with-expiring-message-support" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>‚ö†Ô∏è Important: if necessary, always use a secure messaging service (preferably with expiring message support.)</h4>\n<p>Good luck and let me know if you have any questions! üéâ</p>',htmlAst:{type:"root",children:[{type:"element",tagName:"h2",properties:{id:"handling-secrets--api-tokens-safely"},children:[{type:"element",tagName:"a",properties:{href:"#handling-secrets--api-tokens-safely",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Handling Secrets & API Tokens Safely"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-wrapper"],style:"position: relative; display: block; ; max-width: 645px; margin-left: auto; margin-right: auto;"},children:[{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["gatsby-resp-image-background-image"],style:"padding-bottom: 83.11840562719813%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB5s16o56VWaSMQr//xAAbEAEAAgIDAAAAAAAAAAAAAAACATEAIQMRMv/aAAgBAQABBQIbO4hWK5OpKsYvU3//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAbEAABBAMAAAAAAAAAAAAAAAAQAAERIQIxQf/aAAgBAQAGPwKFfBtNDXBxH//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExEEFhgaH/2gAIAQEAAT8heTRZiD4NqVbKwXZoBDivcdQ/M19ci//aAAwDAQACAAMAAAAQ3ADA/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHhABAQACAgIDAAAAAAAAAAAAAREAMUFxUWGhwdH/2gAIAQEAAT8QFZFF7aTEO4EM8RXrFSCg8YqyW0K0WTFinAQrmHPea0CA36zZ3+8+J+Ztz//Z'); background-size: cover; display: block;"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"img",properties:{className:["gatsby-resp-image-image"],style:"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;",alt:"credit: john-salvino-417565-unsplash.jpg",title:"",src:"/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ef7b7.jpg",srcSet:["/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-c3db7.jpg 161w","/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-e67ed.jpg 323w","/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ef7b7.jpg 645w","/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-07a29.jpg 853w"],sizes:["(max-width:","645px)","100vw,","645px"]},children:[]},{type:"text",value:"\n    "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n  "}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{id:"related-article-protect-your-tokens"},children:[{type:"element",tagName:"a",properties:{href:"#related-article-protect-your-tokens",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Related Article: "},{type:"element",tagName:"a",properties:{href:"/protect-your-tokens/"},children:[{type:"text",value:"Protect Your Tokens"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Let‚Äôs quickly recap the difference between "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"secret"}]},{type:"text",value:" and "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"non-secret"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"ul",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"üîí "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Secret keys"}]},{type:"text",value:" MUST use a custom server (e.g. Node/Express/Heroku) in order to hide (proxy) requests to 3rd party API services."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"üåç "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Non-secret keys"}]},{type:"text",value:" describes keys which can be sent to the browser."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"br",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"hr",properties:{},children:[]},{type:"text",value:"\n"},{type:"element",tagName:"blockquote",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"We‚Äôll focus on dealing with üîí "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Secret keys"}]},{type:"text",value:" using "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"Environment Variables"}]},{type:"text",value:" in this article."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"a",properties:{href:"#%EF%B8%8F-code-example"},children:[{type:"text",value:"Code examples are included below."}]}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"overview"},children:[{type:"element",tagName:"a",properties:{href:"#overview",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Overview"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"safely access secrets in your NodeJS code:"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Replace hard-coded keys with environment variables. e.g. "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"process.env.API_SECRET"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Use a library like "},{type:"element",tagName:"a",properties:{href:"https://github.com/motdotla/dotenv"},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dotenv"}]}]},{type:"text",value:" along with a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" file. Add your previously hard-coded secrets to the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" file."}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"text",value:"Verify "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" line in your "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".gitignore"}]},{type:"text",value:" file!"}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"blockquote",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"DON‚ÄôT"}]},{type:"text",value:" create a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" file on deployed servers. Use your hosting services‚Äô (e.g. "},{type:"element",tagName:"a",properties:{href:"https://devcenter.heroku.com/articles/config-vars"},children:[{type:"text",value:"Heroku"}]},{type:"text",value:", Netlify, AWS EC2) provided environment variable management tool: e.g. "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"dashboard or command line."}]}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{id:"Ô∏è-code-example"},children:[{type:"element",tagName:"a",properties:{href:"#%EF%B8%8F-code-example",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Ô∏è Code Example:"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"We‚Äôre going to define a few files."}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./db/connection.js"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"li",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./api/users.js"}]}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"comment",value:" Example config object which uses `process.env.PG*`\n\n```js\n// ./db/config.js\nmodule.exports = {\n  postgres: {\n    host: process.env.PGHOST || 'localhost',\n    port: process.env.PGPORT || 5234,\n    user: process.env.PGUSER || 'postgres',\n    password: process.env.PGPASSWORD || 'password',\n    database: process.env.PGDATABASE || 'postgres',\n  }\n};\n```\n\nThe `db/config.js` file is just an example of how your secrets should be stored for re-use in your code.\n"},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"First, install the "},{type:"element",tagName:"a",properties:{href:"https://www.npmjs.com/package/dotenv"},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"dotenv"}]}]},{type:"text",value:" package."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"bash"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-bash"]},children:[{type:"element",tagName:"code",properties:{className:["language-bash"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"npm"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"install"}]},{type:"text",value:" dotenv"}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Next, create a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" in the root of your project."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"text"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'# .env\nPGDATABASE="postgres"\nPGHOST="localhost"\nPGPORT=5234\nPGUSER="postgres"\nPGPASSWORD="password"'}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"‚ùå "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"NEVER"}]},{type:"text",value:" commit "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" file."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"‚ùå Avoid creating "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" on servers."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Check your Hosting Provider docs to set up "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"environment variables"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To easily make sure your "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".gitignore"}]},{type:"text",value:" has a "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" line in it."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"bash"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-bash"]},children:[{type:"element",tagName:"code",properties:{className:["language-bash"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]
},children:[{type:"text",value:"# Automatically update .gitignore"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# Run in terminal:"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"'},{type:"element",tagName:"span",properties:{className:["token","variable"]},children:[{type:"element",tagName:"span",properties:{className:["token","variable"]},children:[{type:"text",value:"$("}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"grep"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'^.env'"}]},{type:"text",value:" .gitignore"},{type:"element",tagName:"span",properties:{className:["token","variable"]},children:[{type:"text",value:")"}]}]},{type:"text",value:'"'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'""'}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"&&"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"echo"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'.env'"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">>"}]},{type:"text",value:" .gitignore\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"# note: no output will print"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./db/connection.js"}]},{type:"text",value:" provides a shared "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"pg.Pool"}]},{type:"text",value:" instance. It‚Äôll be used to query the database."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ./db/connection.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'dotenv'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"config"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ‚úÖ Load .env file"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" pg "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'pg'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGUSER"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGHOST"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGPORT"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" process"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"env"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"process"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"env"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"NODE_ENV"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"==="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'development'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:"\n  console"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"log"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","template-string"]},children:[{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"`Connecting to "}]},{type:"element",tagName:"span",properties:{className:["token","interpolation"]},children:[{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"${"}]},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGUSER"}]},{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"}"}]}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:" @ "}]},{type:"element",tagName:"span",properties:{className:["token","interpolation"]},children:[{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"${"}]},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGHOST"}]},{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"}"}]}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:":"}]},{type:"element",tagName:"span",properties:{className:["token","interpolation"]},children:[{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"${"}]},{type:"element",tagName:"span",properties:{className:["token","constant"]},children:[{type:"text",value:"PGHOST"}]},{type:"element",tagName:"span",properties:{className:["token","interpolation-punctuation","punctuation"]},children:[{type:"text",value:"}"}]}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"`"}]}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ^^ only for showing debug connection vars"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// pg automatically uses PG* env variables"}]},{type:"text",value:"\nmodule"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"exports "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"new"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"pg"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Pool"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./api"}]},{type:"text",value:" folder contains interfaces to your tables/views."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Here‚Äôs an example "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"./api/users.js"}]},{type:"text",value:" for the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"users"}]},{type:"text",value:" table."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// ./api/users.js"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" db "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"require"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'../db/connection.js'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\nmodule"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"exports "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  findUsername"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"function"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"username"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" db"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"query"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'SELECT * FROM users WHERE username=$1'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" username"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n  "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"never-commit-your-env-secrets-to-git"},children:[{type:"element",tagName:"a",properties:{href:"#never-commit-your-env-secrets-to-git",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Never commit your "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" secrets to git!"}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"dont-share-env-files-on-a-team-"},children:[{type:"element",tagName:"a",properties:{href:"#dont-share-env-files-on-a-team-",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"Don‚Äôt share "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" files on a team. *"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"* Every new development laptop or desktop should "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"generate new access keys & tokens."}]},{type:"text",value:"\nIf it‚Äôs not possible, use plenty of care sharing your "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:".env"}]},{type:"text",value:" (in cases where a service might invalidate all older keys, or you have a paid API‚Äôs limited access token.)"}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{id:"Ô∏è-important-if-necessary-always-use-a-secure-messaging-service-preferably-with-expiring-message-support"},children:[{type:"element",tagName:"a",properties:{href:"#%EF%B8%8F-important-if-necessary-always-use-a-secure-messaging-service-preferably-with-expiring-message-support",ariaHidden:!0,className:["anchor"]},children:[{type:"element",tagName:"svg",properties:{ariaHidden:"true",height:16,version:"1.1",viewBox:"0 0 16 16",width:16},children:[{type:"element",tagName:"path",properties:{fillRule:"evenodd",d:"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},children:[]}]}]},{type:"text",value:"‚ö†Ô∏è Important: if necessary, always use a secure messaging service (preferably with expiring message support.)"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Good luck and let me know if you have any questions! üéâ"}]}],data:{quirksMode:!1}},wordCount:{paragraphs:36,sentences:40,words:306},fields:{slug:"/securely-using-environment-variables-in-nodejs/",prefix:"2018-11-14"},frontmatter:{title:"Securely Using Environment Variables in NodeJS",subTitle:"Using `dotenv`",category:"security",relativePath:"/content/posts/2018-11-14--securely-using-environment-variables-in-nodejs/index.md",tags:["dotenv","api-keys","secrets","tokens","security","nodejs"],date:"2018-11-13T00:00:00.000Z",modified:"2018-11-15T00:00:00.000Z",cover:{childImageSharp:{resolutions:{width:220,height:220,src:"/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-bc901.jpg",srcSet:"/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-bc901.jpg 1x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-39e82.jpg 1.5x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-a8256.jpg 2x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ef5e1.jpg 3x",srcWebp:"/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ec1cf.webp",srcSetWebp:"/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-ec1cf.webp 1x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-c5012.webp 1.5x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-6ab8f.webp 2x,\n/static/john-salvino-417565-unsplash-497c4639fa520185db205be14955aede-f9a43.webp 3x"}}}}},author:{id:"/app/content/parts/author.md absPath of file >>> MarkdownRemark",html:'<p>Dan Levy is an accomplished programmer, teacher, speaker, cat dad and writer.\n<br /><br /></p>\n<p>Dan‚Äôs Open Source documentation and related writing is relied on by countless developers who use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch">Mozilla Developer Network</a> site daily.\n<br /><br /></p>\n<p>His contributions span dozens of well-known projects, including <a href="https://github.com/nodejs/nodejs.org">NodeJS</a>, <a href="https://github.com/moby/moby">Docker</a>, <a href="https://github.com/ReactTraining/react-router/">React Router</a>, <a href="https://github.com/gatsbyjs/gatsby">GatsbyJS</a>, <a href="https://github.com/Angular/Angular">Angular</a>, <a href="https://github.com/petkaantonov/bluebird">Bluebird</a>, <a href="https://github.com/lodash/lodash">Lodash</a>, <a href="https://github.com/rancher/rancher">Rancher</a>, <a href="https://github.com/minio/minio">Minio</a>, <a href="https://github.com/lord/slate">Slate</a>, <a href="https://github.com/ReactiveX/IxJS">IxJS</a>, and <a href="https://github.com/functional-promises/functional-promises">Functional Promises</a>.\n<br /><br /></p>\n<p>Feel free to <a href="https://calendly.com/danlevy/">grab a spot on Dan‚Äôs calendar</a>, or reach out via <a href="https://twitter.com/justsml/">Twitter DMs</a> or <a href="/contact/">the contact form</a>.</p>'},footnote:{id:"/app/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:'<p>Unless otherwise noted, copyright ¬©2014-2021 Dan Levy.</p>\n<ul>\n<li>Photos by <a href="https://unsplash.com">unsplash.com</a></li>\n</ul>'},site:{siteMetadata:{facebook:{appId:""}}},allTags:{group:[{fieldValue:"ai",totalCount:1},{fieldValue:"amazon-web-services",totalCount:1},{fieldValue:"angularjs",totalCount:2},{fieldValue:"api-keys",totalCount:2},{fieldValue:"architecture",totalCount:1},{fieldValue:"artificial intelligence",totalCount:1},{fieldValue:"async",totalCount:5},{fieldValue:"async-await",totalCount:1},{fieldValue:"await",totalCount:1},{fieldValue:"axios",totalCount:1},{fieldValue:"azure",totalCount:1},{fieldValue:"benchmarks",totalCount:1},{fieldValue:"boot2docker",totalCount:1},{fieldValue:"challenge",totalCount:1},{fieldValue:"closure",totalCount:1},{fieldValue:"cloud",totalCount:1},{fieldValue:"collaborative-culture",totalCount:2},{fieldValue:"composition",totalCount:4},{fieldValue:"culture",totalCount:2},{fieldValue:"date",totalCount:1},{fieldValue:"date class",totalCount:1},{fieldValue:"debugging",totalCount:1},{fieldValue:"design",totalCount:1},{fieldValue:"development",totalCount:2},{fieldValue:"devops",totalCount:5},{fieldValue:"digital-ocean",totalCount:1},{fieldValue:"docker",totalCount:4},{fieldValue:"dos",totalCount:1},{fieldValue:"dotenv",totalCount:1},{fieldValue:"elasticsearch",totalCount:1},{fieldValue:"engineering",totalCount:1},{fieldValue:"errors",totalCount:2},{fieldValue:"examples",totalCount:1},{fieldValue:"fails",totalCount:1},{fieldValue:"fetch",totalCount:1},{fieldValue:"functional",totalCount:1},{fieldValue:"functional river",totalCount:1},{fieldValue:"git",totalCount:1},{fieldValue:"go",totalCount:1},{fieldValue:"google-cloud-engine",totalCount:1},{fieldValue:"gotchas",totalCount:1},{fieldValue:"growth",totalCount:2},{fieldValue:"guides",totalCount:1},{fieldValue:"haskell",totalCount:1},{fieldValue:"hoisting",totalCount:1},{fieldValue:"io",totalCount:1},{fieldValue:"javascript",totalCount:12},{fieldValue:"json-web-tokens",totalCount:1},{fieldValue:"languages",totalCount:1},{fieldValue:"lua",totalCount:1},{fieldValue:"merge",totalCount:1},{fieldValue:"models",totalCount:1},{fieldValue:"modules",totalCount:1},{fieldValue:"mongodb",totalCount:2},{fieldValue:"mysql",totalCount:1},{fieldValue:"naming",totalCount:1},{fieldValue:"nodejs",totalCount:3},{fieldValue:"opinion",totalCount:1},{fieldValue:"organization",totalCount:2},{fieldValue:"ovh.net",totalCount:1},{fieldValue:"packet.net",totalCount:1},{fieldValue:"patterns",totalCount:7},{fieldValue:"performance",totalCount:4},{fieldValue:"personal-development",totalCount:2},{fieldValue:"pipeline",totalCount:1},{fieldValue:"postgres",totalCount:1},{fieldValue:"programming",totalCount:10},{fieldValue:"promises",totalCount:8},{fieldValue:"python",totalCount:2},{fieldValue:"quiz",totalCount:2},{fieldValue:"rebase",totalCount:1},{fieldValue:"regex",totalCount:1},{fieldValue:"remote-exploit",totalCount:1},{fieldValue:"resources",totalCount:1},{fieldValue:"rust",totalCount:1},{fieldValue:"scala",totalCount:1},{fieldValue:"scaling",totalCount:1},{fieldValue:"scoping",totalCount:1},{fieldValue:"secrets",totalCount:2},{fieldValue:"security",totalCount:4},{fieldValue:"self-driving cars",totalCount:1},{fieldValue:"server",totalCount:1},{fieldValue:"servers",totalCount:2},{fieldValue:"setup",totalCount:1},{fieldValue:"shell script",totalCount:1},{fieldValue:"smalltalk",totalCount:1},{fieldValue:"source code",totalCount:2},{fieldValue:"ssd",totalCount:1},{fieldValue:"stateful",totalCount:1},{fieldValue:"teams",totalCount:2},{fieldValue:"tokens",totalCount:2},{fieldValue:"tuning",totalCount:1},{fieldValue:"typescript",totalCount:2},{fieldValue:"visualizing",totalCount:1}]}},pathContext:{slug:"/securely-using-environment-variables-in-nodejs/"}}}});
//# sourceMappingURL=path---securely-using-environment-variables-in-nodejs-15e3e0381504eaa93c2f.js.map