---
language_name: Russian
title: Один странный трюк, чтобы ускорить команды по функциям!
subTitle: Инженеры по поддержке кода ненавидят это!
date: 2024-09-29
modified: 2024-09-30
tags: [агиль, команды]
category: Инжиниринг

cover_full_width: wide_danny-howe-98KlbUsOO_w-unsplash.webp
cover: danny-howe-98KlbUsOO_w-unsplash__w300.webp
cover_mobile: danny-howe-98KlbUsOO_w-unsplash__w200.webp
cover_icon: danny-howe-98KlbUsOO_w-unsplash__w200.webp
cover_credit: Фото <a href="https://unsplash.com/@dannyhowe?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Денни Хау</a> на <a href="https://unsplash.com/photos/red-and-white-neon-light-signage-98KlbUsOO_w?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a>
---

{/* Добавьте элемент toggle html5 */}

<details>
<summary>Оглавление</summary>

- [Мысль через Ключи](#мысль-через-клjuчи)
  - [Проектирование с ключами](#пpoeктирование-с-ключамi)
  - [KVs как Графы & Деревья?](#kvs-как-гpaфы-&-деревья)
  - [Когда использовать шаблоны KV](#кгда-использовать-шаблоны-kv)
  - [Когда избегать шаблонов KV](#кгда-избегать-шаблонов-kv)
  - [Когда вам нужен больше, чем KV](#кгда-вам-нужен-бoльше-км)
- [Дальнейшие действия](#дaлeжные-права)
  - [Факт-сервис - Пример референс](#фaкт-сервис---пpимер-референс)
</details>

Когда вы проектируете новую систему или функцию, легко застрять на схеме дизайна. В этой статье я поделюсь интересным трюком, который приносил плоды во время моей карьеры.

<section class="breakout">
  _Попробуйте_ самые простые возможные методы сохранения данных при проектировании новой системы или функции.
</section>

Часто я видел, как команды выбирают SQL или MongoDB в качестве единственного способа хранения данных. Да, никто не увольняется из-за выбора SQL. Но что если скажу вам, что существует более простой, быстрый и дешевый способ?

KV или ключ-значение может быть вашим спасением. Что-то вроде Redis или S3.

Не всегда правильный выбор, но возможно **чаще, чем вы думаете**.

Простое хранилище может ускорить разработку на ранних этапах, за счет повторного использования кода слоя данных и предотвращения затрат, связанных с изменениями в схеме дизайна и миграциями. Изменения все равно произойдут, пусть код будет обрабатывать их как можно дольше. Быстрее из-за оптимизированных запросов на `ключ` и скорость записи может быть повышена за счет бэчевых обновлений.

## Мысли через ключи

Часто странно проектировать с шаблоном Key-Value, особенно если вы привыкли проектировать системы с иерархическими объектами или диаграммами отношений данных и напрямую внедрять их в SQL.

Вы, возможно, **использовали** шаблоны ключ-значение раньше! Они повсюду, от конфигов и URL до S3-стильного хранения объектов! Каждый раз, когда вы работаете с данными через уникальный `ID`, догадайтесь? Еще один шаблон Key-value! (Хотя и не всегда KV Хранилище.)

### Проектирование с ключами

В virtually всех данных можно представить использованием шаблона KV. (На самом деле, многие более высокоуровневые БД строятся на более низкоуровневых шаблонах KV.) Погадайте, что некоторые примеры:

```markdown
user/123          {id: 123, ...}
user/123/block    ['user/456', 'user/789']
user/123/groups   ['admin', 'staff']
user/420/friends  ['user/456', 'user/789']

group/admin       {user: '*:rw'}
group/default     {user: '*:r'}

product/42/discount/<UUID>	{percentOff: '10%'}
product/42/discount/<UUID>	{percentOff: '20%', minTotal: 100.0}
```

Возможно, вы заметили, но ID часто является ключом в себе. Это распространенный шаблон в KV хранилищах. Ключ обычно является комбинацией типа сущности и уникального идентификатора. (например `user/123`, `user:456`)

### KVs как Графы & Деревья?

Иногда полезно представить сложные структуры данных, такие как графы или деревья, с помощью шаблона KV. (Еще одно пример REST URL). Иерархия ключей (`user/420` -> `user/420/friends`) естественным образом кодирует графовое отношение между `пользователем` и его друзьями.

Это быстрый и дешевый способ сериализации графовых структур данных. Особенно, если вам не нужно сложность графовой базы данных (например Neo4j).

<figure>
![Граф пользователя 123](./KVsCanBeGraphs.webp)
<figcaption>Граф пользователя 123</figcaption>
</figure>

## Дальнейшие действия

Лучший способ изучить это шаблон - попробовать! Если вы хотите исследовать этот паттерн еще дальше, я рекомендую **строить вещи** с Redis, DynamoDB или S3.
Все они являются отличными KV хранилищами с различными вариантами.

### Факт-сервис - Пример референс

Посмотрите на [открытое исходное коде "Факт-Сервис" на GitHub](https://github.com/justsml/fact-service).

Это отдельный RESTful API, который реализует сервис данных KV.

Он включает много [дата-адаптеров](https://github.com/justsml/fact-service/tree/main/lib/providers).
Включая Postgres, Redis, DynamoDB, Firestore и Cassandra! (Полностью с [Docker командами](https://github.com/justsml/fact-service/tree/main/lib/providers) для быстрого старта.)

Факт-сервис предназначен как начальный проект и учебное пособие. Переопределите его и создайте свой собственный KV данные сервис!

## Заключение

Надеюсь, эта статья была полезной! Если у вас есть какие-либо вопросы или отзывы, пожалуйста, не стесняйтесь оставить комментарии или `@` меня на [Twitter](https://twitter.com/justsml).

### Кредиты

- [Моделирование иерархической структуры дерева данных в PostgreSQL](https://leonardqmarcq.com/posts/modeling-hierarchical-tree-data)
- [Советы и рекомендации хранения больших деревьев в PostgreSQL](https://leonardqmarcq.com/posts/dos-and-donts-of-modeling-hierarchical-trees-in-postgres)

### Дальнейшая литература

- [Факт-сервис](https://github.com/justsml/fact-service)
- [Postgres](https://www.postgresql.org/)
- [Redis](https://redis.io/)
- [DynamoDB](https://aws.amazon.com/dynamodb/)
- [S3](https://aws.amazon.com/s3/)
- [Cassandra](https://cassandra.apache.org/)
- [Firestore](https://firebase.google.com/docs/firestore)


{/* Translated from English to Russian
Original text length: 7729 characters
Translation API: http://192.168.0.87:1234/v1/chat/completions
Translation model: NousResearch/Hermes-3-Llama-3.1-8B-GGUF
Translation date: 2024-12-06T09:59:39.467Z */}


