---
lang: Spanish
title: Un truco extraño para acelerar equipos de características!
subTitle: Los ingenieros de staff odian esto!
date: 2024-09-29
modified: 2024-09-30
tags: [agile, teams]
category: Ingeniería

cover_full_width: ../../2024-09-29--one-weird-trick-to-speed-up-feature-teams/wide_danny-howe-98KlbUsOO_w-unsplash.webp
cover: ../../2024-09-29--one-weird-trick-to-speed-up-feature-teams/danny-howe-98KlbUsOO_w-unsplash__w300.webp
cover_mobile: ../../2024-09-29--one-weird-trick-to-speed-up-feature-teams/danny-howe-98KlbUsOO_w-unsplash__w200.webp
cover_icon: ../../2024-09-29--one-weird-trick-to-speed-up-feature-teams/danny-howe-98KlbUsOO_w-unsplash__w200.webp
cover_credit: Foto por <a href="https://unsplash.com/@dannyhowe?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Danny Howe</a> en <a href="https://unsplash.com/photos/red-and-white-neon-light-signage-98KlbUsOO_w?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash">Unsplash</a>
---

<details>
<summary>Tema de Contenido</summary>

- [Pensando en Claves](#thinking-in-keys)
   - [Diseñar con Claves](#designing-with-keys)
   - [KV como Grafos y Arboles?](#kvs-as-graphs--trees)
   - [Cuándo Usar Patrones de KV](#when-to-use-kv-patterns)
   - [Cuándo Evitar Patrones de KV](#when-to-avoid-kv-patterns)
   - [Cuándo Necesitas más que KV](#when-you-need-more-than-kv)
- [Pasos Siguientes](#next-steps)
   - [Servicio de Hechos - Proyecto de Referencia](#fact-service---reference-project)
- [Conclusión](#conclusion)
   - [Leer Más](#further-reading)

</details>

Cuando se diseña un nuevo sistema o característica, es fácil estar atascado en el diseño del esquema. En este artículo compartiré una trucada útil que ha pagado dividendos durante mi carrera.

<section class="breakout">
_Try_ el almacenamiento de datos más simple posible cuando se diseña un nuevo sistema o característica.
</section>

A menudo, veo equipos que llegan a SQL o MongoDB como su única opción para almacenar datos. ¡Claro que nadie se despacha por elegir SQL! Pero ¿qué si te digo que hay una manera más sencilla, rápida y barata de empezar?
Un almacén de clave-valor (KV) puede ser todo lo que necesitas. Algo como Redis o S3.

No siempre es la elección correcta, pero tal vez **más a menudo de lo que crees**.
Un simple capa de almacenamiento puede acelerar moderadamente el desarrollo temprano al reutilizar código de capa de datos y evitando costos relacionados con el diseño de schema y las migraciones. El cambio ocurrirá de cualquier manera; déjale a los códigos manejarlo mientras sea posible. Mejor evitar manejar cambios en dos lugares.

Los ganancias de rendimiento son probablemente altas ya que las búsquedas por clave están altamente optimizadas y las escrituras pueden beneficiarse de actualizaciones en lote.

{/* AVOID KV PATTERNS IF YOU NEED JOINs OR TO QUERY BY PROPERTIES IN YOUR DATASET. OR IN CASES WHERE YOU HAVE AN UNBOUNDED/INFinitely GROWING DATASETS. (Logs, Signups, etc.) */}

## Pensando en Claves

Puede sentirse extraño diseñar con un patrón de clave-valor primero, especialmente si estás acostumbrado a diseñar sistemas con jerarquías de objetos o Diagramas de Relaciones Entidad-Atributo y directamente implementarlos en SQL.

Has probablemente **usado** patrones de clave-valor antes! Están por todas partes, desde configs y URLs hasta Almacenamiento de Objetos S3! Cada vez que trates con datos a través de una clave única, ¡apuesto que otro patrón de clave-valor! (Aunque no necesariamente un almacén de KV.)

### Diseñar con Claves

Virtualmente todos los datos _pueden_ ser representados utilizando patrones de clave-valor. (De hecho, muchos bases de datos de orden superior se basan en patrones de KV más bajos.) ¡Mira algunos ejemplos!

```markdown
user/123       {id: 123, ...}
user/123/block     ['user/456', 'user/789']
user/123/groups    ['admin', 'staff']
user/420/friends   ['user/456', 'user/789']
group/admin        {user: '*:rw'}
group/default      {user: '*:r'}
product/42/discount/<UUID>     {percentOff: '10%'}
product/42/discount/<UUID>     {percentOff: '20%', minTotal: 100.0}
```
Puede haber notado que el `ID` es a menudo una clave en sí misma! Este es un patrón común en almacenes de KV. La clave a menudo es una composición del tipo de entidad y el identificador único. (e.g `user/123`, `user:456`)

### KV como Grafos & Árboles?

Puede ser útil representar estructuras de datos complejas como Grafos o Árboles utilizando patrones de clave-valor. (Otra vez, las URLs REST son un gran ejemplo de esto.)
La jerarquía de la clave ( `user/420`  -> `user/420/friends`) codifica naturalmente una relación gráfica entre el `user` y sus `friends`.
Esto es una forma rápida y barata de serializar estructuras de datos gráficas. Especialmente si no necesitas la complejidad de una base de datos gráfica (como Neo4j).

<figure>
![Graph of user/123](../../2024-09-29--one-weird-trick-to-speed-up-feature-teams/KVsCanBeGraphs.webp)
<figcaption>Gráfico de usuario/123</figcaption>
</figure>

### Cuándo Usar Patrones de KV

- Cuando necesitas una escala masiva. (Billones o incluso trillones de pares KV.)
- Cuando accedes a los datos principalmente a través de una clave única.
- Cuando necesitas estructuras de datos simples.
- Cuando tienes datos con jerarquía, gráficos o árboles.

### Cuándo Evitar Patrones de KV

No almacenes cosas como comentarios de blog en un **_solo_** par de KV. Por ejemplo, `post/666  -> {comments: [...too many...]}`. En su lugar, podrías usar `post/666/comments/1`, o `post/666/comments/<UUID>`, etc. O bien utiliza una tabla SQL.

- Cuando necesitas buscar por propiedades (no clave o ID) en tu dataset.
- Cuando necesitas unir datos a través de múltiples entidades.
- Cuando necesitas cumplir restricciones y relaciones complejas.

### Cuándo Necesitas más que KV

Como los requisitos del proyecto evolucionan naturalmente, puedes necesitar hacer más que lo que admite tu almacén de KV. En este punto, deberás buscar migrar a un almacenamiento de datos más complejo.

{/* The good news is that you can often start with a KV pattern and evolve it into a more complex system as needed. S3 has features beyond simple storage, from Athena for searching files, Glacier, and Expire policies there's a lot you can do with it. Also, Redis has added many high-level features (like Pub/Sub, Geo- spatial, Streams, and Sorted Sets) that can help you meet some requirements. */}

La buena noticia es que migrar un solo almacén de KV a SQL es relativamente más fácil que migrar un schema SQL complejo en un almacén de KV. (Con múltiples tablas, índices, restricciones, etc.) Lo he hecho muchas veces con un script de 50 líneas.
Anecdotariamente, he encontrado la calidad del diseño de SQL es mayor si comienzas con un patrón de KV primero. Esto te fuerza a realmente pensar en los datos de una manera diferente y mejor entender **exactamente** lo que necesitas de SQL.

## Pasos Siguientes

El mejor modo de aprender es intentarlo! Si estás interesado en explorar este patrón más a fondo, recomiendo **construyendo cosas** con Redis, DynamoDB o S3. Todos son almacenes de KV excelentes con diferentes trade-offs.

### Servicio de Hechos - Proyecto de Referencia

Echa un vistazo a mi proyecto Open Source ["Servicio de Hechos," un proyecto de referencia en GitHub](https://github.com/justsml/fact-service).
Es una API RESTful autónoma que implementa un servicio de datos KV.
Fue diseñado para ser un proyecto de aprendizaje y demostración, así que no dudes en **clonarlo** y construir tu propio servicio de datos KV!

## Conclusión

Espero que hayas encontrado este artículo útil! Si tienes alguna pregunta o retroalimentación, por favor no dudes en comentarios o @me en [Twitter](https://twitter.com/justsml).

### Créditos

- [Modeling Hierarchical Tree Data in PostgreSQL](https://leonardqmarcq.com/posts/modeling-hierarchical-tree-data)
- [Do's and Don'ts of Storing Large Trees in PostgreSQL](https://leonardqmarcq.com/posts/dos-and-donts-of-modeling-hierarchical-trees-in-postgres)

### Leer Más

- [Servicio de Hechos](https://github.com/justsml/fact-service)
- [Postgres](https://www.postgresql.org/)
- [Redis](https://redis.io/)
- [DynamoDB](https://aws.amazon.com/dynamodb/)
- [S3](https://aws.amazon.com/s3/)
- [Cassandra](https://cassandra.apache.org/)
- [Firestore](https://firebase.google.com/docs/firestore)
```


{/* Translated from English to Spanish
Original text length: 7729 characters
Translated text length: 8406 characters
Translation API: http://127.0.0.1:1234/v1/chat/completions
Translation model: lmstudio-community/Meta-Llama-3-8B-Instruct-GGUF
Translation date: 2024-12-04T02:39:01.860Z */}

