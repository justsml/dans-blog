import{j as t}from"./jsx-runtime.vlAWDSmm.js";import{r as n}from"./index.BwNzhqGF.js";import{c as H}from"./index.BQXz43h1.js";import{s as O}from"./pathHelpers.kwYD5byA.js";import{g as R,Q as w}from"./QuestionStore.Dp9S3Fqa.js";import{c as j}from"./clsx.B-dksMZM.js";import"./_commonjsHelpers.Cpj98o6Y.js";const $=n.createContext({answers:[],setAnswers:()=>{},currentChallenge:0,setCurrentChallenge:()=>{},totalQuestions:0,setTotalQuestions:()=>{},correctAnswers:0,setCorrectAnswers:()=>{}}),i=R();function P({children:E,title:a,group:x,question:o,options:u,explanation:A,index:l}){let s=null;const{setTotalQuestions:T,setCorrectAnswers:z}=n.useContext($),p=n.useRef(null),[c,h]=n.useState("untouched"),[d,g]=n.useState(void 0),[f,Q]=n.useState(!1),[N,v]=n.useState(A),[b,q]=n.useState(0),y=()=>{const e=document.querySelectorAll("main .challenge"),r=document.querySelectorAll("main .challenge.correct");T(e?.length),z(r?.length),window?.__updateCounts()};n.useEffect(()=>{s||(s=w(i?.location.pathname)),s&&q(s.sumOfTries())},[i?.location?.pathname]),n.useEffect(()=>{s||(s=w(i?.location.pathname)),s&&s.addQuestion({title:a,group:x,question:o,index:l})},[s,a,x,o,u,A]),n.useEffect(()=>{const e=s?.isCorrect({index:l})??void 0;g(e),h(e===!0?"correct":e===!1?"incorrect":"")},[]);const k=(e,r)=>{const m=i?.posthog;m&&m.capture(e,r)},_=e=>{s||(s=w(i?.location.pathname)),s?.answerQuestion({index:l},e),q(s.sumOfTries()),e.isAnswer?(g(!0),h("correct pulse")):(g(!1),h("incorrect shake")),k("QuizAnswer",{isCorrect:e.isAnswer,option:e,question:o||"",title:a,questionIndex:l}),setTimeout(y,20)};n.useEffect(()=>{const e=c.includes("shake")||c.includes("pulse");if(c&&e){const r=c.split(" ").filter(m=>!["shake","pulse"].includes(m));setTimeout(()=>{h(r.join(" "))},1e3)}},[c]),n.useEffect(()=>{if(p.current){const e=p.current.querySelector("div.explanation")?.innerHTML;e&&v(e)}},[N]);const C=(l??0)+1;u.filter(e=>e.isAnswer).length===0&&console.error("No correct answers found for question:",o,a,u);const S=u.map(e=>{const r=d&&e.isAnswer;return d&&!e.isAnswer?null:t.jsx("a",{className:H("option",{"correct-answer":r}),onClick:()=>!d&&_(e),children:t.jsx("label",{children:e.text})},e.text)}).filter(Boolean);return t.jsxs("div",{id:`qq-${C}`,className:j("challenge",c),ref:p,"data-answer-count":b,"data-question-correct":d,children:[t.jsxs("div",{className:"quiz-header",children:[t.jsxs("div",{className:"quiz-question-count",children:[t.jsxs("a",{href:`#qq-${C}`,children:[C,"."]}),"Â "]}),t.jsx("h2",{className:"quiz-title",id:O(a),children:x})]}),t.jsx("div",{className:"quiz-question",children:o||E}),t.jsx("aside",{className:"quiz-hint-toggle",children:t.jsxs("button",{onClick:()=>Q(!f),className:j("hint-toggle",{open:f}),children:[f?"Hide":"Show"," Explainer"," "]})}),t.jsxs("section",{className:j("quiz-body-panel","card-container",{"card-flip":f}),style:{height:`${80*S.length}px`,transition:"height 0.2s ease-in-out"},children:[t.jsx("section",{className:"quiz-options card card-front",children:S}),t.jsx("section",{className:"explanation card card-back ",children:t.jsx("p",{className:"help-box",dangerouslySetInnerHTML:{__html:N}})})]})]})}export{P as default};
