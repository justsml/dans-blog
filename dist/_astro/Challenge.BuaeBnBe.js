import{j as s}from"./jsx-runtime.vlAWDSmm.js";import{r as n}from"./index.BwNzhqGF.js";import{c as H}from"./index.BQXz43h1.js";import{s as R}from"./pathHelpers.kwYD5byA.js";import{g as $,Q as w}from"./QuestionStore.DoXL2Hea.js";import{c as j}from"./clsx.B-dksMZM.js";import"./_commonjsHelpers.Cpj98o6Y.js";const B=n.createContext({answers:[],setAnswers:()=>{},currentChallenge:0,setCurrentChallenge:()=>{},totalQuestions:0,setTotalQuestions:()=>{},correctAnswers:0,setCorrectAnswers:()=>{}}),l=$();function P({children:E,title:a,group:x,question:i,options:u,explanation:A,index:c}){let t=null;const{setTotalQuestions:T,setCorrectAnswers:z}=n.useContext(B),p=n.useRef(null),[o,h]=n.useState("untouched"),[d,g]=n.useState(void 0),[f,Q]=n.useState(!1),[N,v]=n.useState(A),[b,S]=n.useState(0),y=()=>{const e=document.querySelectorAll("main .challenge"),r=document.querySelectorAll("main .challenge.correct");T(e?.length),z(r?.length),window?.__updateCounts()};n.useEffect(()=>{t||(t=w(l?.location.pathname))},[l?.location?.pathname]),n.useEffect(()=>{if(t||(t=w(l?.location.pathname)),t){t.addQuestion({title:a,group:x,question:i,index:c});const e=t?.isCorrect({index:c})??void 0,r=t?.getTries({index:c})??0;S(r),g(e),h(e===!0?"correct":e===!1?"incorrect":"")}else console.error("QuestionStore is not initialized")},[t,a,x,i,u,A]);const k=(e,r)=>{const m=l?.posthog;m&&m.capture(e,r)},_=e=>{t||(t=w(l?.location.pathname)),t?.answerQuestion({index:c},e),S(t.sumOfTries()),e.isAnswer?(g(!0),h("correct pulse")):(g(!1),h("incorrect shake")),k("QuizAnswer",{isCorrect:e.isAnswer,option:e,question:i||"",title:a,questionIndex:c}),setTimeout(y,20)};n.useEffect(()=>{const e=o.includes("shake")||o.includes("pulse");if(o&&e){const r=o.split(" ").filter(m=>!["shake","pulse"].includes(m));setTimeout(()=>{h(r.join(" "))},1e3)}},[o]),n.useEffect(()=>{if(p.current){const e=p.current.querySelector("div.explanation")?.innerHTML;e&&v(e)}},[N]);const C=(c??0)+1;u.filter(e=>e.isAnswer).length===0&&console.error("No correct answers found for question:",i,a,u);const q=u.map(e=>{const r=d&&e.isAnswer;return d&&!e.isAnswer?null:s.jsx("a",{className:H("option",{"correct-answer":r}),onClick:()=>!d&&_(e),children:s.jsx("label",{children:e.text})},e.text)}).filter(Boolean);return s.jsxs("div",{id:`qq-${C}`,className:j("challenge",o),ref:p,"data-answer-count":b,"data-question-correct":d,children:[s.jsxs("div",{className:"quiz-header",children:[s.jsxs("div",{className:"quiz-question-count",children:[s.jsxs("a",{href:`#qq-${C}`,children:[C,"."]}),"Â "]}),s.jsx("h2",{className:"quiz-title",id:R(a),children:x})]}),s.jsx("div",{className:"quiz-question",children:i||E}),s.jsx("aside",{className:"quiz-hint-toggle",children:s.jsxs("button",{onClick:()=>Q(!f),className:j("hint-toggle",{open:f}),children:[f?"Hide":"Show"," Explainer"," "]})}),s.jsxs("section",{className:j("quiz-body-panel","card-container",{"card-flip":f}),style:{height:`${80*q.length}px`,transition:"height 0.2s ease-in-out"},children:[s.jsx("section",{className:"quiz-options card card-front",children:q}),s.jsx("section",{className:"explanation card card-back ",children:s.jsx("p",{className:"help-box",dangerouslySetInnerHTML:{__html:N}})})]})]})}export{P as default};
