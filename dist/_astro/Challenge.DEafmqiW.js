import{j as s}from"./jsx-runtime.vlAWDSmm.js";import{r as t}from"./index.BwNzhqGF.js";import{c as k}from"./index.BQXz43h1.js";import{s as H}from"./pathHelpers.kwYD5byA.js";import{g as R,Q as w}from"./QuestionStore.CLterkrh.js";import{c as j}from"./clsx.B-dksMZM.js";import"./_commonjsHelpers.Cpj98o6Y.js";const _=t.createContext({answers:[],setAnswers:()=>{},currentChallenge:0,setCurrentChallenge:()=>{},totalQuestions:0,setTotalQuestions:()=>{},correctAnswers:0,setCorrectAnswers:()=>{}}),i=R();function J({children:E,title:o,group:m,question:a,options:u,explanation:A,index:l}){let n=null;const{setTotalQuestions:S,setCorrectAnswers:z}=t.useContext(_),x=t.useRef(null),[c,h]=t.useState("untouched"),[p,g]=t.useState(void 0),[d,Q]=t.useState(!1),[N,v]=t.useState(A),T=()=>{const e=document.querySelectorAll("main .challenge"),r=document.querySelectorAll("main .challenge.correct");S(e?.length),z(r?.length)};t.useEffect(()=>{n||(n=w(i?.location.pathname))},[i?.location?.pathname]),t.useEffect(()=>{n||(n=w(i?.location.pathname)),n&&n.addQuestion({title:o,group:m,question:a,index:l})},[n,o,m,a,u,A]),t.useEffect(()=>{const e=n?.isCorrect({index:l})??void 0;g(e),h(e===!0?"correct":e===!1?"incorrect":"")},[]);const b=(e,r)=>{const f=i?.posthog;f&&f.capture(e,r)},y=e=>{n||(n=w(i?.location.pathname)),n?.answerQuestion({index:l},e),e.isAnswer?(g(!0),h("correct pulse")):(g(!1),h("incorrect shake")),b("QuizAnswer",{isCorrect:e.isAnswer,option:e,question:a||"",title:o,questionIndex:l}),setTimeout(T,20)};t.useEffect(()=>{const e=c.includes("shake")||c.includes("pulse");if(c&&e){const r=c.split(" ").filter(f=>!["shake","pulse"].includes(f));setTimeout(()=>{h(r.join(" "))},1e3)}},[c]),t.useEffect(()=>{if(x.current){const e=x.current.querySelector("div.explanation")?.innerHTML;e&&v(e)}},[N]);const C=(l??0)+1;u.filter(e=>e.isAnswer).length===0&&console.error("No correct answers found for question:",a,o,u);const q=u.map(e=>{const r=p&&e.isAnswer;return p&&!e.isAnswer?null:s.jsx("a",{className:k("option",{"correct-answer":r}),onClick:()=>!p&&y(e),children:s.jsx("label",{children:e.text})},e.text)}).filter(Boolean);return s.jsxs("div",{id:`qq-${C}`,className:j("challenge",c),ref:x,children:[s.jsxs("div",{className:"quiz-header",children:[s.jsxs("div",{className:"quiz-question-count",children:[s.jsxs("a",{href:`#qq-${C}`,children:[C,"."]}),"Â "]}),s.jsx("h2",{className:"quiz-title",id:H(o),children:m})]}),s.jsx("div",{className:"quiz-question",children:a||E}),s.jsx("aside",{className:"quiz-hint-toggle",children:s.jsxs("button",{onClick:()=>Q(!d),className:j("hint-toggle",{open:d}),children:[d?"Hide":"Show"," Explainer"," "]})}),s.jsxs("section",{className:j("quiz-body-panel","card-container",{"card-flip":d}),style:{height:`${80*q.length}px`,transition:"height 0.2s ease-in-out"},children:[s.jsx("section",{className:"quiz-options card card-front",children:q}),s.jsx("section",{className:"explanation card card-back ",children:s.jsx("p",{className:"help-box",dangerouslySetInnerHTML:{__html:N}})})]})]})}export{J as default};
