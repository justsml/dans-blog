(function(n){function e(i,o){var l=Object.keys(i);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(i);o&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(i,d).enumerable})),l.push.apply(l,c)}return l}function t(i){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?arguments[o]:{};o%2?e(Object(l),!0).forEach(function(c){a(i,c,l[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach(function(c){Object.defineProperty(i,c,Object.getOwnPropertyDescriptor(l,c))})}return i}function r(i,o,l,c,d,v,_){try{var w=i[v](_),S=w.value}catch(I){return void l(I)}w.done?o(S):Promise.resolve(S).then(c,d)}function s(i){return function(){var o=this,l=arguments;return new Promise(function(c,d){var v=i.apply(o,l);function _(S){r(v,c,d,_,w,"next",S)}function w(S){r(v,c,d,_,w,"throw",S)}_(void 0)})}}function a(i,o,l){return o in i?Object.defineProperty(i,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[o]=l,i}function u(i,o){if(i==null)return{};var l,c,d=function(_,w){if(_==null)return{};var S,I,k={},N=Object.keys(_);for(I=0;I<N.length;I++)S=N[I],w.indexOf(S)>=0||(k[S]=_[S]);return k}(i,o);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(i);for(c=0;c<v.length;c++)l=v[c],o.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(i,l)&&(d[l]=i[l])}return d}var h,p=["type"],m=Object.defineProperty,g=(i,o,l)=>((c,d,v)=>d in c?m(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v)(i,typeof o!="symbol"?o+"":o,l),f=Object.defineProperty,b=(i,o,l)=>((c,d,v)=>d in c?f(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v)(i,typeof o!="symbol"?o+"":o,l),y=(i=>(i[i.Document=0]="Document",i[i.DocumentType=1]="DocumentType",i[i.Element=2]="Element",i[i.Text=3]="Text",i[i.CDATA=4]="CDATA",i[i.Comment=5]="Comment",i))(y||{}),E={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},T={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},z=()=>{try{return!!globalThis.Zone}catch{return!1}},j={};function $(i){if(j[i])return j[i];var o=globalThis[i],l=o.prototype,c=i in E?E[i]:void 0,d=!!(c&&c.every(k=>{var N,X;return!!((X=(N=Object.getOwnPropertyDescriptor(l,k))==null?void 0:N.get)!=null&&X.toString().includes("[native code]"))})),v=i in T?T[i]:void 0,_=!!(v&&v.every(k=>{var N;return typeof l[k]=="function"&&((N=l[k])==null?void 0:N.toString().includes("[native code]"))}));if(d&&_&&!z())return j[i]=o.prototype,o.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var S=w.contentWindow;if(!S)return o.prototype;var I=S[i].prototype;return document.body.removeChild(w),I?j[i]=I:o.prototype}catch{return o.prototype}}var ae={};function oe(i,o,l){var c,d="".concat(i,".").concat(String(l));if(ae[d])return ae[d].call(o);var v=$(i),_=(c=Object.getOwnPropertyDescriptor(v,l))==null?void 0:c.get;return _?(ae[d]=_,_.call(o)):o[l]}var Se={};function qe(i,o,l){var c="".concat(i,".").concat(String(l));if(Se[c])return Se[c].bind(o);var d=$(i)[l];return typeof d!="function"?o[l]:(Se[c]=d,d.bind(o))}var be={childNodes:function(i){return oe("Node",i,"childNodes")},parentNode:function(i){return oe("Node",i,"parentNode")},parentElement:function(i){return oe("Node",i,"parentElement")},textContent:function(i){return oe("Node",i,"textContent")},contains:function(i,o){return qe("Node",i,"contains")(o)},getRootNode:function(i){return qe("Node",i,"getRootNode")()},host:function(i){return i&&"host"in i?oe("ShadowRoot",i,"host"):null},styleSheets:function(i){return i.styleSheets},shadowRoot:function(i){return i&&"shadowRoot"in i?oe("Element",i,"shadowRoot"):null},querySelector:function(i,o){return oe("Element",i,"querySelector")(o)},querySelectorAll:function(i,o){return oe("Element",i,"querySelectorAll")(o)},mutationObserver:function(){return $("MutationObserver").constructor}};function Ce(i){return i.nodeType===i.ELEMENT_NODE}function Re(i){var o=i&&"host"in i&&"mode"in i&&be.host(i)||null;return!!(o&&"shadowRoot"in o&&be.shadowRoot(o)===i)}function je(i){return Object.prototype.toString.call(i)==="[object ShadowRoot]"}function rt(i){try{var o=i.rules||i.cssRules;if(!o)return null;var l=Array.from(o,d=>ct(d,i.href)).join("");return(c=l).includes(" background-clip: text;")&&!c.includes(" -webkit-background-clip: text;")&&(c=c.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),c}catch{return null}var c}function ct(i,o){if(function(v){return"styleSheet"in v}(i)){var l;try{l=rt(i.styleSheet)||function(v){var{cssText:_}=v;if(_.split('"').length<3)return _;var w=["@import","url(".concat(JSON.stringify(v.href),")")];return v.layerName===""?w.push("layer"):v.layerName&&w.push("layer(".concat(v.layerName,")")),v.supportsText&&w.push("supports(".concat(v.supportsText,")")),v.media.length&&w.push(v.media.mediaText),w.join(" ")+";"}(i)}catch{l=i.cssText}return i.styleSheet.href?Ze(l,i.styleSheet.href):l}var c,d=i.cssText;return function(v){return"selectorText"in v}(i)&&i.selectorText.includes(":")&&(c=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,d=d.replace(c,"$1\\$2")),o?Ze(d,o):d}function pt(i,o){return Array.from(i.styleSheets).find(l=>l.href===o)}let wt=class{constructor(){b(this,"idNodeMap",new Map),b(this,"nodeMetaMap",new WeakMap)}getId(i){var o;if(!i)return-1;var l=(o=this.getMeta(i))==null?void 0:o.id;return l??-1}getNode(i){return this.idNodeMap.get(i)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(i){return this.nodeMetaMap.get(i)||null}removeNodeFromMap(i){var o=this.getId(i);this.idNodeMap.delete(o),i.childNodes&&i.childNodes.forEach(l=>this.removeNodeFromMap(l))}has(i){return this.idNodeMap.has(i)}hasNode(i){return this.nodeMetaMap.has(i)}add(i,o){var l=o.id;this.idNodeMap.set(l,i),this.nodeMetaMap.set(i,o)}replace(i,o){var l=this.getNode(i);if(l){var c=this.nodeMetaMap.get(l);c&&this.nodeMetaMap.set(o,c)}this.idNodeMap.set(i,o)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function _t(i){var{element:o,maskInputOptions:l,tagName:c,type:d,value:v,maskInputFn:_}=i,w=v||"",S=d&&Ye(d);return(l[c.toLowerCase()]||S&&l[S])&&(w=_?_(w,o):"*".repeat(w.length)),w}function Ye(i){return i.toLowerCase()}var gt="__rrweb_original__";function St(i){var o=i.type;return i.hasAttribute("data-rr-is-password")?"password":o?Ye(o):null}function It(i,o){var l,c;try{c=new URL(i,o??window.location.href)}catch{return null}var d=c.pathname.match(/\.([0-9a-z]+)(?:$)/i);return(l=d?.[1])!==null&&l!==void 0?l:null}var Ct=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,zt=/^(?:[a-z+]+:)?\/\//i,et=/^www\..*/i,st=/^(data:)([^,]*),(.*)/i;function Ze(i,o){return(i||"").replace(Ct,(l,c,d,v,_,w)=>{var S,I=d||_||w,k=c||v||"";if(!I)return l;if(zt.test(I)||et.test(I)||st.test(I))return"url(".concat(k).concat(I).concat(k,")");if(I[0]==="/")return"url(".concat(k).concat((S=o,(S.indexOf("//")>-1?S.split("/").slice(0,3).join("/"):S.split("/")[0]).split("?")[0]+I)).concat(k,")");var N=o.split("/"),X=I.split("/");for(var B of(N.pop(),X))B!=="."&&(B===".."?N.pop():N.push(B));return"url(".concat(k).concat(N.join("/")).concat(k,")")})}var Xe,Et,Gt=1,sr=new RegExp("[^a-z0-9-_:]"),Yt=-2;function O(){return Gt++}var x=/^[^ \t\n\r\u000c]+/,D=/^[, \t\n\r\u000c]+/,W=new WeakMap;function J(i,o){return o&&o.trim()!==""?me(i,o):o}function Ee(i){return!!(i.tagName==="svg"||i.ownerSVGElement)}function me(i,o){var l=W.get(i);if(l||(l=i.createElement("a"),W.set(i,l)),o){if(o.startsWith("blob:")||o.startsWith("data:"))return o}else o="";return l.setAttribute("href",o),l.href}function ze(i,o,l,c){return c&&(l==="src"||l==="href"&&(o!=="use"||c[0]!=="#")||l==="xlink:href"&&c[0]!=="#"?J(i,c):l!=="background"||o!=="table"&&o!=="td"&&o!=="th"?l==="srcset"?function(d,v){if(v.trim()==="")return v;var _=0;function w(B){var ne,de=B.exec(v.substring(_));return de?(ne=de[0],_+=ne.length,ne):""}for(var S=[];w(D),!(_>=v.length);){var I=w(x);if(I.slice(-1)===",")I=J(d,I.substring(0,I.length-1)),S.push(I);else{var k="";I=J(d,I);for(var N=!1;;){var X=v.charAt(_);if(X===""){S.push((I+k).trim());break}if(N)X===")"&&(N=!1);else{if(X===","){_+=1,S.push((I+k).trim());break}X==="("&&(N=!0)}k+=X,_+=1}}}return S.join(", ")}(i,c):l==="style"?Ze(c,me(i)):o==="object"&&l==="data"?J(i,c):c:J(i,c))}function Pe(i,o,l){return(i==="video"||i==="audio")&&o==="autoplay"}function nt(i,o,l){if(!i)return!1;if(i.nodeType!==i.ELEMENT_NODE)return!!l&&nt(be.parentNode(i),o,l);for(var c=i.classList.length;c--;){var d=i.classList[c];if(o.test(d))return!0}return!!l&&nt(be.parentNode(i),o,l)}function M(i,o,l,c){var d;if(Ce(i)){if(d=i,!be.childNodes(d).length)return!1}else{if(be.parentElement(i)===null)return!1;d=be.parentElement(i)}try{if(typeof o=="string"){if(c){if(d.closest(".".concat(o)))return!0}else if(d.classList.contains(o))return!0}else if(nt(d,o,c))return!0;if(l){if(c){if(d.closest(l))return!0}else if(d.matches(l))return!0}}catch{}return!1}function Z(i,o){var{doc:l,mirror:c,blockClass:d,blockSelector:v,needsMask:_,inlineStylesheet:w,maskInputOptions:S={},maskTextFn:I,maskInputFn:k,dataURLOptions:N={},inlineImages:X,recordCanvas:B,keepIframeSrcFn:ne,newlyAddedElement:de=!1}=o,ie=function(F,A){if(A.hasNode(F)){var R=A.getId(F);return R===1?void 0:R}}(l,c);switch(i.nodeType){case i.DOCUMENT_NODE:return i.compatMode!=="CSS1Compat"?{type:y.Document,childNodes:[],compatMode:i.compatMode}:{type:y.Document,childNodes:[]};case i.DOCUMENT_TYPE_NODE:return{type:y.DocumentType,name:i.name,publicId:i.publicId,systemId:i.systemId,rootId:ie};case i.ELEMENT_NODE:return function(F,A){for(var R,{doc:G,blockClass:K,blockSelector:Q,inlineStylesheet:ee,maskInputOptions:re={},maskInputFn:ce,dataURLOptions:ge={},inlineImages:ke,recordCanvas:Y,keepIframeSrcFn:Te,newlyAddedElement:_e=!1,rootId:ye}=A,ve=function(Fe,Bt,rr){try{if(typeof Bt=="string"){if(Fe.classList.contains(Bt))return!0}else for(var nr=Fe.classList.length;nr--;){var pr=Fe.classList[nr];if(Bt.test(pr))return!0}if(rr)return Fe.matches(rr)}catch{}return!1}(F,K,Q),se=function(Fe){if(Fe instanceof HTMLFormElement)return"form";var Bt=Ye(Fe.tagName);return sr.test(Bt)?"div":Bt}(F),te={},He=F.attributes.length,$e=0;$e<He;$e++){var Oe=F.attributes[$e];Pe(se,Oe.name,Oe.value)||(te[Oe.name]=ze(G,se,Ye(Oe.name),Oe.value))}if(se==="link"&&ee){var V=F.href,xe=pt(G,V);!xe&&V.includes(".css")&&(xe=pt(G,window.location.origin+"/"+V.replace(window.location.href,"")));var At=null;xe&&(At=rt(xe)),At&&(delete te.rel,delete te.href,te._cssText=At)}if(se==="style"&&F.sheet&&!(F.innerText||be.textContent(F)||"").trim().length){var ft=rt(F.sheet);ft&&(te._cssText=ft)}if(se==="input"||se==="textarea"||se==="select"){var it=F.value,vt=F.checked;te.type!=="radio"&&te.type!=="checkbox"&&te.type!=="submit"&&te.type!=="button"&&it?te.value=_t({element:F,type:St(F),tagName:se,value:it,maskInputOptions:re,maskInputFn:ce}):vt&&(te.checked=vt)}if(se==="option"&&(F.selected&&!re.select?te.selected=!0:delete te.selected),se==="dialog"&&F.open)try{te.rr_open_mode=F.matches("dialog:modal")?"modal":"non-modal"}catch{te.rr_open_mode="modal",te.ph_rr_could_not_detect_modal=!0}if(se==="canvas"&&Y){if(F.__context==="2d")(function(Fe){var Bt=Fe.getContext("2d");if(!Bt)return!0;for(var rr=0;rr<Fe.width;rr+=50)for(var nr=0;nr<Fe.height;nr+=50){var pr=Bt.getImageData,ni=gt in pr?pr[gt]:pr;if(new Uint32Array(ni.call(Bt,rr,nr,Math.min(50,Fe.width-rr),Math.min(50,Fe.height-nr)).data.buffer).some(po=>po!==0))return!1}return!0})(F)||(te.rr_dataURL=F.toDataURL(ge.type,ge.quality));else if(!("__context"in F)){var Ut=F.toDataURL(ge.type,ge.quality),Xt=G.createElement("canvas");Xt.width=F.width,Xt.height=F.height,Ut!==Xt.toDataURL(ge.type,ge.quality)&&(te.rr_dataURL=Ut)}}if(se==="img"&&ke){Xe||(Xe=G.createElement("canvas"),Et=Xe.getContext("2d"));var ot=F,Fr=ot.currentSrc||ot.getAttribute("src")||"<unknown-src>",_n=ot.crossOrigin,hr=()=>{ot.removeEventListener("load",hr);try{Xe.width=ot.naturalWidth,Xe.height=ot.naturalHeight,Et.drawImage(ot,0,0),te.rr_dataURL=Xe.toDataURL(ge.type,ge.quality)}catch(Fe){if(ot.crossOrigin!=="anonymous")return ot.crossOrigin="anonymous",void(ot.complete&&ot.naturalWidth!==0?hr():ot.addEventListener("load",hr));console.warn("Cannot inline img src=".concat(Fr,"! Error: ").concat(Fe))}ot.crossOrigin==="anonymous"&&(_n?te.crossOrigin=_n:ot.removeAttribute("crossorigin"))};ot.complete&&ot.naturalWidth!==0?hr():ot.addEventListener("load",hr)}if(se==="audio"||se==="video"){var Ne=te;Ne.rr_mediaState=F.paused?"paused":"played",Ne.rr_mediaCurrentTime=F.currentTime,Ne.rr_mediaPlaybackRate=F.playbackRate,Ne.rr_mediaMuted=F.muted,Ne.rr_mediaLoop=F.loop,Ne.rr_mediaVolume=F.volume}if(_e||(F.scrollLeft&&(te.rr_scrollLeft=F.scrollLeft),F.scrollTop&&(te.rr_scrollTop=F.scrollTop)),ve){var{width:Ot,height:Ie}=F.getBoundingClientRect();te={class:te.class,rr_width:"".concat(Ot,"px"),rr_height:"".concat(Ie,"px")}}se!=="iframe"||Te(te.src)||(F.contentDocument||(te.rr_src=te.src),delete te.src);try{customElements.get(se)&&(R=!0)}catch{}return{type:y.Element,tagName:se,attributes:te,childNodes:[],isSVG:Ee(F)||void 0,needBlock:ve,rootId:ye,isCustom:R}}(i,{doc:l,blockClass:d,blockSelector:v,inlineStylesheet:w,maskInputOptions:S,maskInputFn:k,dataURLOptions:N,inlineImages:X,recordCanvas:B,keepIframeSrcFn:ne,newlyAddedElement:de,rootId:ie});case i.TEXT_NODE:return function(F,A){var R,{needsMask:G,maskTextFn:K,rootId:Q}=A,ee=be.parentNode(F),re=ee&&ee.tagName,ce=be.textContent(F),ge=re==="STYLE"||void 0,ke=re==="SCRIPT"||void 0;if(ge&&ce){try{F.nextSibling||F.previousSibling||(R=ee.sheet)!=null&&R.cssRules&&(ce=rt(ee.sheet))}catch(Y){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(Y),F)}ce=Ze(ce,me(A.doc))}return ke&&(ce="SCRIPT_PLACEHOLDER"),!ge&&!ke&&ce&&G&&(ce=K?K(ce,be.parentElement(F)):ce.replace(/[\S]/g,"*")),{type:y.Text,textContent:ce||"",isStyle:ge,rootId:Q}}(i,{doc:l,needsMask:_,maskTextFn:I,rootId:ie});case i.CDATA_SECTION_NODE:return{type:y.CDATA,textContent:"",rootId:ie};case i.COMMENT_NODE:return{type:y.Comment,textContent:be.textContent(i)||"",rootId:ie};default:return!1}}function L(i){return i==null?"":i.toLowerCase()}function q(i,o){var{doc:l,mirror:c,blockClass:d,blockSelector:v,maskTextClass:_,maskTextSelector:w,skipChild:S=!1,inlineStylesheet:I=!0,maskInputOptions:k={},maskTextFn:N,maskInputFn:X,slimDOMOptions:B,dataURLOptions:ne={},inlineImages:de=!1,recordCanvas:ie=!1,onSerialize:F,onIframeLoad:A,iframeLoadTimeout:R=5e3,onStylesheetLoad:G,stylesheetLoadTimeout:K=5e3,keepIframeSrcFn:Q=()=>!1,newlyAddedElement:ee=!1}=o,{needsMask:re}=o,{preserveWhiteSpace:ce=!0}=o;re||(re=M(i,_,w,re===void 0));var ge,ke=Z(i,{doc:l,mirror:c,blockClass:d,blockSelector:v,needsMask:re,inlineStylesheet:I,maskInputOptions:k,maskTextFn:N,maskInputFn:X,dataURLOptions:ne,inlineImages:de,recordCanvas:ie,keepIframeSrcFn:Q,newlyAddedElement:ee});if(!ke)return console.warn(i,"not serialized"),null;ge=c.hasNode(i)?c.getId(i):!function(V,xe){return!!(xe.comment&&V.type===y.Comment||V.type===y.Element&&(xe.script&&(V.tagName==="script"||V.tagName==="link"&&(V.attributes.rel==="preload"||V.attributes.rel==="modulepreload")&&V.attributes.as==="script"||V.tagName==="link"&&V.attributes.rel==="prefetch"&&typeof V.attributes.href=="string"&&It(V.attributes.href)==="js")||xe.headFavicon&&(V.tagName==="link"&&V.attributes.rel==="shortcut icon"||V.tagName==="meta"&&(L(V.attributes.name).match(/^msapplication-tile(image|color)$/)||L(V.attributes.name)==="application-name"||L(V.attributes.rel)==="icon"||L(V.attributes.rel)==="apple-touch-icon"||L(V.attributes.rel)==="shortcut icon"))||V.tagName==="meta"&&(xe.headMetaDescKeywords&&L(V.attributes.name).match(/^description|keywords$/)||xe.headMetaSocial&&(L(V.attributes.property).match(/^(og|twitter|fb):/)||L(V.attributes.name).match(/^(og|twitter):/)||L(V.attributes.name)==="pinterest")||xe.headMetaRobots&&(L(V.attributes.name)==="robots"||L(V.attributes.name)==="googlebot"||L(V.attributes.name)==="bingbot")||xe.headMetaHttpEquiv&&V.attributes["http-equiv"]!==void 0||xe.headMetaAuthorship&&(L(V.attributes.name)==="author"||L(V.attributes.name)==="generator"||L(V.attributes.name)==="framework"||L(V.attributes.name)==="publisher"||L(V.attributes.name)==="progid"||L(V.attributes.property).match(/^article:/)||L(V.attributes.property).match(/^product:/))||xe.headMetaVerification&&(L(V.attributes.name)==="google-site-verification"||L(V.attributes.name)==="yandex-verification"||L(V.attributes.name)==="csrf-token"||L(V.attributes.name)==="p:domain_verify"||L(V.attributes.name)==="verify-v1"||L(V.attributes.name)==="verification"||L(V.attributes.name)==="shopify-checkout-api-token"))))}(ke,B)&&(ce||ke.type!==y.Text||ke.isStyle||ke.textContent.replace(/^\s+|\s+$/gm,"").length)?O():Yt;var Y=Object.assign(ke,{id:ge});if(c.add(i,Y),ge===Yt)return null;F&&F(i);var Te=!S;if(Y.type===y.Element){Te=Te&&!Y.needBlock,delete Y.needBlock;var _e=be.shadowRoot(i);_e&&je(_e)&&(Y.isShadowHost=!0)}if((Y.type===y.Document||Y.type===y.Element)&&Te){B.headWhitespace&&Y.type===y.Element&&Y.tagName==="head"&&(ce=!1);var ye={doc:l,mirror:c,blockClass:d,blockSelector:v,needsMask:re,maskTextClass:_,maskTextSelector:w,skipChild:S,inlineStylesheet:I,maskInputOptions:k,maskTextFn:N,maskInputFn:X,slimDOMOptions:B,dataURLOptions:ne,inlineImages:de,recordCanvas:ie,preserveWhiteSpace:ce,onSerialize:F,onIframeLoad:A,iframeLoadTimeout:R,onStylesheetLoad:G,stylesheetLoadTimeout:K,keepIframeSrcFn:Q};if(!(Y.type===y.Element&&Y.tagName==="textarea"&&Y.attributes.value!==void 0))for(var ve of Array.from(be.childNodes(i))){var se=q(ve,ye);se&&Y.childNodes.push(se)}var te=null;if(Ce(i)&&(te=be.shadowRoot(i)))for(var He of Array.from(be.childNodes(te))){var $e=q(He,ye);$e&&(je(te)&&($e.isShadow=!0),Y.childNodes.push($e))}}var Oe=be.parentNode(i);return Oe&&Re(Oe)&&je(Oe)&&(Y.isShadow=!0),Y.type===y.Element&&Y.tagName==="iframe"&&function(V,xe,At){var ft=V.contentWindow;if(ft){var it,vt=!1;try{it=ft.document.readyState}catch{return}if(it==="complete"){var Ut="about:blank";if(ft.location.href!==Ut||V.src===Ut||V.src==="")return setTimeout(xe,0),V.addEventListener("load",xe);V.addEventListener("load",xe)}else{var Xt=setTimeout(()=>{vt||(xe(),vt=!0)},At);V.addEventListener("load",()=>{clearTimeout(Xt),vt=!0,xe()})}}}(i,()=>{var V=i.contentDocument;if(V&&A){var xe=q(V,{doc:V,mirror:c,blockClass:d,blockSelector:v,needsMask:re,maskTextClass:_,maskTextSelector:w,skipChild:!1,inlineStylesheet:I,maskInputOptions:k,maskTextFn:N,maskInputFn:X,slimDOMOptions:B,dataURLOptions:ne,inlineImages:de,recordCanvas:ie,preserveWhiteSpace:ce,onSerialize:F,onIframeLoad:A,iframeLoadTimeout:R,onStylesheetLoad:G,stylesheetLoadTimeout:K,keepIframeSrcFn:Q});xe&&A(i,xe)}},R),Y.type===y.Element&&Y.tagName==="link"&&typeof Y.attributes.rel=="string"&&(Y.attributes.rel==="stylesheet"||Y.attributes.rel==="preload"&&typeof Y.attributes.href=="string"&&It(Y.attributes.href)==="css")&&function(V,xe,At){var ft,it=!1;try{ft=V.sheet}catch{return}if(!ft){var vt=setTimeout(()=>{it||(xe(),it=!0)},At);V.addEventListener("load",()=>{clearTimeout(vt),it=!0,xe()})}}(i,()=>{if(G){var V=q(i,{doc:l,mirror:c,blockClass:d,blockSelector:v,needsMask:re,maskTextClass:_,maskTextSelector:w,skipChild:!1,inlineStylesheet:I,maskInputOptions:k,maskTextFn:N,maskInputFn:X,slimDOMOptions:B,dataURLOptions:ne,inlineImages:de,recordCanvas:ie,preserveWhiteSpace:ce,onSerialize:F,onIframeLoad:A,iframeLoadTimeout:R,onStylesheetLoad:G,stylesheetLoadTimeout:K,keepIframeSrcFn:Q});V&&G(i,V)}},K),Y}let H=class Sl{constructor(){__publicField2(this,"parentElement",null),__publicField2(this,"parentNode",null),__publicField2(this,"ownerDocument"),__publicField2(this,"firstChild",null),__publicField2(this,"lastChild",null),__publicField2(this,"previousSibling",null),__publicField2(this,"nextSibling",null),__publicField2(this,"ELEMENT_NODE",1),__publicField2(this,"TEXT_NODE",3),__publicField2(this,"nodeType"),__publicField2(this,"nodeName"),__publicField2(this,"RRNodeType")}get childNodes(){for(var o=[],l=this.firstChild;l;)o.push(l),l=l.nextSibling;return o}contains(o){if(!(o instanceof Sl)||o.ownerDocument!==this.ownerDocument)return!1;if(o===this)return!0;for(;o.parentNode;){if(o.parentNode===this)return!0;o=o.parentNode}return!1}appendChild(o){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(o,l){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(o){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};var le={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},ue={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},we={};function Me(i){if(we[i])return we[i];var o=globalThis[i],l=o.prototype,c=i in le?le[i]:void 0,d=!!(c&&c.every(k=>{var N,X;return!!((X=(N=Object.getOwnPropertyDescriptor(l,k))==null?void 0:N.get)!=null&&X.toString().includes("[native code]"))})),v=i in ue?ue[i]:void 0,_=!!(v&&v.every(k=>{var N;return typeof l[k]=="function"&&((N=l[k])==null?void 0:N.toString().includes("[native code]"))}));if(d&&_&&!z())return we[i]=o.prototype,o.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var S=w.contentWindow;if(!S)return o.prototype;var I=S[i].prototype;return document.body.removeChild(w),I?we[i]=I:l}catch{return l}}var Ue={};function Ve(i,o,l){var c,d="".concat(i,".").concat(String(l));if(Ue[d])return Ue[d].call(o);var v=Me(i),_=(c=Object.getOwnPropertyDescriptor(v,l))==null?void 0:c.get;return _?(Ue[d]=_,_.call(o)):o[l]}var Je={};function er(i,o,l){var c="".concat(i,".").concat(String(l));if(Je[c])return Je[c].bind(o);var d=Me(i)[l];return typeof d!="function"?o[l]:(Je[c]=d,d.bind(o))}function wr(){return Me("MutationObserver").constructor}var Ae={childNodes:function(i){return Ve("Node",i,"childNodes")},parentNode:function(i){return Ve("Node",i,"parentNode")},parentElement:function(i){return Ve("Node",i,"parentElement")},textContent:function(i){return Ve("Node",i,"textContent")},contains:function(i,o){return er("Node",i,"contains")(o)},getRootNode:function(i){return er("Node",i,"getRootNode")()},host:function(i){return i&&"host"in i?Ve("ShadowRoot",i,"host"):null},styleSheets:function(i){return i.styleSheets},shadowRoot:function(i){return i&&"shadowRoot"in i?Ve("Element",i,"shadowRoot"):null},querySelector:function(i,o){return Ve("Element",i,"querySelector")(o)},querySelectorAll:function(i,o){return Ve("Element",i,"querySelectorAll")(o)},mutationObserver:wr};function kt(i,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,c={capture:!0,passive:!0};return l.addEventListener(i,o,c),()=>l.removeEventListener(i,o,c)}var qt=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,Bn={map:{},getId:()=>(console.error(qt),-1),getNode:()=>(console.error(qt),null),removeNodeFromMap(){console.error(qt)},has:()=>(console.error(qt),!1),reset(){console.error(qt)}};function gn(i,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=null,d=0;return function(){for(var v=arguments.length,_=new Array(v),w=0;w<v;w++)_[w]=arguments[w];var S=Date.now();d||l.leading!==!1||(d=S);var I=o-(S-d),k=this;I<=0||I>o?(c&&(clearTimeout(c),c=null),d=S,i.apply(k,_)):c||l.trailing===!1||(c=setTimeout(()=>{d=l.leading===!1?0:Date.now(),c=null,i.apply(k,_)},I))}}function Hn(i,o,l,c){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:window,v=d.Object.getOwnPropertyDescriptor(i,o);return d.Object.defineProperty(i,o,c?l:{set(_){setTimeout(()=>{l.set.call(this,_)},0),v&&v.set&&v.set.call(this,_)}}),()=>Hn(i,o,v||{},!0)}function Yr(i,o,l){try{if(!(o in i))return()=>{};var c=i[o],d=l(c);return typeof d=="function"&&(d.prototype=d.prototype||{},Object.defineProperties(d,{__rrweb_original__:{enumerable:!1,value:c}})),i[o]=d,()=>{i[o]=c}}catch{return()=>{}}}typeof window<"u"&&window.Proxy&&window.Reflect&&(Bn=new Proxy(Bn,{get:(i,o,l)=>(o==="map"&&console.error(qt),Reflect.get(i,o,l))}));var $n=Date.now;function ds(i){var o,l,c,d,v=i.document;return{left:v.scrollingElement?v.scrollingElement.scrollLeft:i.pageXOffset!==void 0?i.pageXOffset:v.documentElement.scrollLeft||v?.body&&((o=Ae.parentElement(v.body))==null?void 0:o.scrollLeft)||((l=v?.body)==null?void 0:l.scrollLeft)||0,top:v.scrollingElement?v.scrollingElement.scrollTop:i.pageYOffset!==void 0?i.pageYOffset:v?.documentElement.scrollTop||v?.body&&((c=Ae.parentElement(v.body))==null?void 0:c.scrollTop)||((d=v?.body)==null?void 0:d.scrollTop)||0}}function hs(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function ps(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function gs(i){return i?i.nodeType===i.ELEMENT_NODE?i:Ae.parentElement(i):null}function Mt(i,o,l,c){if(!i)return!1;var d=gs(i);if(!d)return!1;try{if(typeof o=="string"){if(d.classList.contains(o)||c&&d.closest("."+o)!==null)return!0}else if(nt(d,o,c))return!0}catch{}return!!(l&&(d.matches(l)||c&&d.closest(l)!==null))}function Bi(i,o,l){return!(i.tagName!=="TITLE"||!l.headTitleMutations)||o.getId(i)===Yt}function fs(i,o){if(Re(i))return!1;var l=o.getId(i);if(!o.has(l))return!0;var c=Ae.parentNode(i);return(!c||c.nodeType!==i.DOCUMENT_NODE)&&(!c||fs(c,o))}function Hi(i){return!!i.changedTouches}function vs(i,o){return!!(i.nodeName==="IFRAME"&&o.getMeta(i))}function ms(i,o){return!!(i.nodeName==="LINK"&&i.nodeType===i.ELEMENT_NODE&&i.getAttribute&&i.getAttribute("rel")==="stylesheet"&&o.getMeta(i))}function $i(i){return!!i&&(i instanceof H&&"shadowRoot"in i?!!i.shadowRoot:!!Ae.shadowRoot(i))}/[1-9][0-9]{12}/.test(Date.now().toString())||($n=()=>new Date().getTime());let xu=class{constructor(){g(this,"id",1),g(this,"styleIDMap",new WeakMap),g(this,"idStyleMap",new Map)}getId(i){var o;return(o=this.styleIDMap.get(i))!==null&&o!==void 0?o:-1}has(i){return this.styleIDMap.has(i)}add(i,o){return this.has(i)?this.getId(i):(l=o===void 0?this.id++:o,this.styleIDMap.set(i,l),this.idStyleMap.set(l,i),l);var l}getStyle(i){return this.idStyleMap.get(i)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function _s(i){var o,l=null;return"getRootNode"in i&&((o=Ae.getRootNode(i))==null?void 0:o.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&Ae.host(Ae.getRootNode(i))&&(l=Ae.host(Ae.getRootNode(i))),l}function Ru(i){var o=i.ownerDocument;if(!o)return!1;var l=function(c){for(var d,v=c;d=_s(v);)v=d;return v}(i);return Ae.contains(o,l)}function ys(i){var o=i.ownerDocument;return!!o&&(Ae.contains(o,i)||Ru(i))}var Ge=(i=>(i[i.DomContentLoaded=0]="DomContentLoaded",i[i.Load=1]="Load",i[i.FullSnapshot=2]="FullSnapshot",i[i.IncrementalSnapshot=3]="IncrementalSnapshot",i[i.Meta=4]="Meta",i[i.Custom=5]="Custom",i[i.Plugin=6]="Plugin",i))(Ge||{}),Be=(i=>(i[i.Mutation=0]="Mutation",i[i.MouseMove=1]="MouseMove",i[i.MouseInteraction=2]="MouseInteraction",i[i.Scroll=3]="Scroll",i[i.ViewportResize=4]="ViewportResize",i[i.Input=5]="Input",i[i.TouchMove=6]="TouchMove",i[i.MediaInteraction=7]="MediaInteraction",i[i.StyleSheetRule=8]="StyleSheetRule",i[i.CanvasMutation=9]="CanvasMutation",i[i.Font=10]="Font",i[i.Log=11]="Log",i[i.Drag=12]="Drag",i[i.StyleDeclaration=13]="StyleDeclaration",i[i.Selection=14]="Selection",i[i.AdoptedStyleSheet=15]="AdoptedStyleSheet",i[i.CustomElement=16]="CustomElement",i))(Be||{}),Pt=(i=>(i[i.MouseUp=0]="MouseUp",i[i.MouseDown=1]="MouseDown",i[i.Click=2]="Click",i[i.ContextMenu=3]="ContextMenu",i[i.DblClick=4]="DblClick",i[i.Focus=5]="Focus",i[i.Blur=6]="Blur",i[i.TouchStart=7]="TouchStart",i[i.TouchMove_Departed=8]="TouchMove_Departed",i[i.TouchEnd=9]="TouchEnd",i[i.TouchCancel=10]="TouchCancel",i))(Pt||{}),cr=(i=>(i[i.Mouse=0]="Mouse",i[i.Pen=1]="Pen",i[i.Touch=2]="Touch",i))(cr||{}),Zr=(i=>(i[i["2D"]=0]="2D",i[i.WebGL=1]="WebGL",i[i.WebGL2=2]="WebGL2",i))(Zr||{}),Xr=(i=>(i[i.Play=0]="Play",i[i.Pause=1]="Pause",i[i.Seeked=2]="Seeked",i[i.VolumeChange=3]="VolumeChange",i[i.RateChange=4]="RateChange",i))(Xr||{});function bs(i){return"__ln"in i}class Mu{constructor(){g(this,"length",0),g(this,"head",null),g(this,"tail",null)}get(o){if(o>=this.length)throw new Error("Position outside of list range");for(var l=this.head,c=0;c<o;c++)l=l?.next||null;return l}addNode(o){var l={value:o,previous:null,next:null};if(o.__ln=l,o.previousSibling&&bs(o.previousSibling)){var c=o.previousSibling.__ln.next;l.next=c,l.previous=o.previousSibling.__ln,o.previousSibling.__ln.next=l,c&&(c.previous=l)}else if(o.nextSibling&&bs(o.nextSibling)&&o.nextSibling.__ln.previous){var d=o.nextSibling.__ln.previous;l.previous=d,l.next=o.nextSibling.__ln,o.nextSibling.__ln.previous=l,d&&(d.next=l)}else this.head&&(this.head.previous=l),l.next=this.head,this.head=l;l.next===null&&(this.tail=l),this.length++}removeNode(o){var l=o.__ln;this.head&&(l.previous?(l.previous.next=l.next,l.next?l.next.previous=l.previous:this.tail=l.previous):(this.head=l.next,this.head?this.head.previous=null:this.tail=null),o.__ln&&delete o.__ln,this.length--)}}var fn,ws=(i,o)=>"".concat(i,"@").concat(o);class Au{constructor(){g(this,"frozen",!1),g(this,"locked",!1),g(this,"texts",[]),g(this,"attributes",[]),g(this,"attributeMap",new WeakMap),g(this,"removes",[]),g(this,"mapRemoves",[]),g(this,"movedMap",{}),g(this,"addedSet",new Set),g(this,"movedSet",new Set),g(this,"droppedSet",new Set),g(this,"mutationCb"),g(this,"blockClass"),g(this,"blockSelector"),g(this,"maskTextClass"),g(this,"maskTextSelector"),g(this,"inlineStylesheet"),g(this,"maskInputOptions"),g(this,"maskTextFn"),g(this,"maskInputFn"),g(this,"keepIframeSrcFn"),g(this,"recordCanvas"),g(this,"inlineImages"),g(this,"slimDOMOptions"),g(this,"dataURLOptions"),g(this,"doc"),g(this,"mirror"),g(this,"iframeManager"),g(this,"stylesheetManager"),g(this,"shadowDomManager"),g(this,"canvasManager"),g(this,"processedNodeManager"),g(this,"unattachedDoc"),g(this,"processMutations",o=>{o.forEach(this.processMutation),this.emit()}),g(this,"emit",()=>{if(!this.frozen&&!this.locked){for(var o=[],l=new Set,c=new Mu,d=R=>{for(var G=R,K=Yt;K===Yt;)K=(G=G&&G.nextSibling)&&this.mirror.getId(G);return K},v=R=>{var G=Ae.parentNode(R);if(G&&ys(R)&&G.tagName!=="TEXTAREA"){var K=Re(G)?this.mirror.getId(_s(R)):this.mirror.getId(G),Q=d(R);if(K===-1||Q===-1)return c.addNode(R);var ee=q(R,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:re=>{vs(re,this.mirror)&&this.iframeManager.addIframe(re),ms(re,this.mirror)&&this.stylesheetManager.trackLinkElement(re),$i(R)&&this.shadowDomManager.addShadowRoot(Ae.shadowRoot(R),this.doc)},onIframeLoad:(re,ce)=>{this.iframeManager.attachIframe(re,ce),this.shadowDomManager.observeAttachShadow(re)},onStylesheetLoad:(re,ce)=>{this.stylesheetManager.attachLinkElement(re,ce)}});ee&&(o.push({parentId:K,nextId:Q,node:ee}),l.add(ee.id))}};this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(var _ of this.movedSet)Ss(this.removes,_,this.mirror)&&!this.movedSet.has(Ae.parentNode(_))||v(_);for(var w of this.addedSet)Is(this.droppedSet,w)||Ss(this.removes,w,this.mirror)?Is(this.movedSet,w)?v(w):this.droppedSet.add(w):v(w);for(var S=null;c.length;){var I=null;if(S){var k=this.mirror.getId(Ae.parentNode(S.value)),N=d(S.value);k!==-1&&N!==-1&&(I=S)}if(!I)for(var X=c.tail;X;){var B=X;if(X=X.previous,B){var ne=this.mirror.getId(Ae.parentNode(B.value));if(d(B.value)===-1)continue;if(ne!==-1){I=B;break}var de=B.value,ie=Ae.parentNode(de);if(ie&&ie.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var F=Ae.host(ie);if(this.mirror.getId(F)!==-1){I=B;break}}}}if(!I){for(;c.head;)c.removeNode(c.head.value);break}S=I.previous,c.removeNode(I.value),v(I.value)}var A={texts:this.texts.map(R=>{var G=R.node,K=Ae.parentNode(G);return K&&K.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(K),{id:this.mirror.getId(G),value:R.value}}).filter(R=>!l.has(R.id)).filter(R=>this.mirror.has(R.id)),attributes:this.attributes.map(R=>{var{attributes:G}=R;if(typeof G.style=="string"){var K=JSON.stringify(R.styleDiff),Q=JSON.stringify(R._unchangedStyles);K.length<G.style.length&&(K+Q).split("var(").length===G.style.split("var(").length&&(G.style=R.styleDiff)}return{id:this.mirror.getId(R.node),attributes:G}}).filter(R=>!l.has(R.id)).filter(R=>this.mirror.has(R.id)),removes:this.removes,adds:o};(A.texts.length||A.attributes.length||A.removes.length||A.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(A))}}),g(this,"genTextAreaValueMutation",o=>{var l=this.attributeMap.get(o);l||(l={node:o,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(l),this.attributeMap.set(o,l)),l.attributes.value=Array.from(Ae.childNodes(o),c=>Ae.textContent(c)||"").join("")}),g(this,"processMutation",o=>{if(!Bi(o.target,this.mirror,this.slimDOMOptions))switch(o.type){case"characterData":var l=Ae.textContent(o.target);Mt(o.target,this.blockClass,this.blockSelector,!1)||l===o.oldValue||this.texts.push({value:M(o.target,this.maskTextClass,this.maskTextSelector,!0)&&l?this.maskTextFn?this.maskTextFn(l,gs(o.target)):l.replace(/[\S]/g,"*"):l,node:o.target});break;case"attributes":var c=o.target,d=o.attributeName,v=o.target.getAttribute(d);if(d==="value"){var _=St(c);v=_t({element:c,maskInputOptions:this.maskInputOptions,tagName:c.tagName,type:_,value:v,maskInputFn:this.maskInputFn})}if(Mt(o.target,this.blockClass,this.blockSelector,!1)||v===o.oldValue)return;var w=this.attributeMap.get(o.target);if(c.tagName==="IFRAME"&&d==="src"&&!this.keepIframeSrcFn(v)){if(c.contentDocument)return;d="rr_src"}if(w||(w={node:o.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(w),this.attributeMap.set(o.target,w)),d==="type"&&c.tagName==="INPUT"&&(o.oldValue||"").toLowerCase()==="password"&&c.setAttribute("data-rr-is-password","true"),!Pe(c.tagName,d))if(w.attributes[d]=ze(this.doc,Ye(c.tagName),Ye(d),v),d==="style"){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}var S=this.unattachedDoc.createElement("span");for(var I of(o.oldValue&&S.setAttribute("style",o.oldValue),Array.from(c.style))){var k=c.style.getPropertyValue(I),N=c.style.getPropertyPriority(I);k!==S.style.getPropertyValue(I)||N!==S.style.getPropertyPriority(I)?w.styleDiff[I]=N===""?k:[k,N]:w._unchangedStyles[I]=[k,N]}for(var X of Array.from(S.style))c.style.getPropertyValue(X)===""&&(w.styleDiff[X]=!1)}else d==="open"&&c.tagName==="DIALOG"&&(c.matches("dialog:modal")?w.attributes.rr_open_mode="modal":w.attributes.rr_open_mode="non-modal");break;case"childList":if(Mt(o.target,this.blockClass,this.blockSelector,!0))return;if(o.target.tagName==="TEXTAREA")return void this.genTextAreaValueMutation(o.target);o.addedNodes.forEach(B=>this.genAdds(B,o.target)),o.removedNodes.forEach(B=>{var ne=this.mirror.getId(B),de=Re(o.target)?this.mirror.getId(Ae.host(o.target)):this.mirror.getId(o.target);Mt(o.target,this.blockClass,this.blockSelector,!1)||Bi(B,this.mirror,this.slimDOMOptions)||!function(ie,F){return F.getId(ie)!==-1}(B,this.mirror)||(this.addedSet.has(B)?(Wi(this.addedSet,B),this.droppedSet.add(B)):this.addedSet.has(o.target)&&ne===-1||fs(o.target,this.mirror)||(this.movedSet.has(B)&&this.movedMap[ws(ne,de)]?Wi(this.movedSet,B):this.removes.push({parentId:de,id:ne,isShadow:!(!Re(o.target)||!je(o.target))||void 0})),this.mapRemoves.push(B))})}}),g(this,"genAdds",(o,l)=>{if(!this.processedNodeManager.inOtherBuffer(o,this)&&!this.addedSet.has(o)&&!this.movedSet.has(o)){if(this.mirror.hasNode(o)){if(Bi(o,this.mirror,this.slimDOMOptions))return;this.movedSet.add(o);var c=null;l&&this.mirror.hasNode(l)&&(c=this.mirror.getId(l)),c&&c!==-1&&(this.movedMap[ws(this.mirror.getId(o),c)]=!0)}else this.addedSet.add(o),this.droppedSet.delete(o);Mt(o,this.blockClass,this.blockSelector,!1)||(Ae.childNodes(o).forEach(d=>this.genAdds(d)),$i(o)&&Ae.childNodes(Ae.shadowRoot(o)).forEach(d=>{this.processedNodeManager.add(d,this),this.genAdds(d,o)}))}})}init(o){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(l=>{this[l]=o[l]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Wi(i,o){i.delete(o),Ae.childNodes(o).forEach(l=>Wi(i,l))}function Ss(i,o,l){return i.length!==0&&function(c,d,v){for(var _=Ae.parentNode(d),w=function(){var I=v.getId(_);if(c.some(k=>k.id===I))return{v:!0};_=Ae.parentNode(_)};_;){var S=w();if(typeof S=="object")return S.v}return!1}(i,o,l)}function Is(i,o){return i.size!==0&&Cs(i,o)}function Cs(i,o){var l=Ae.parentNode(o);return!!l&&(!!i.has(l)||Cs(i,l))}var We=i=>fn?function(){try{return i(...arguments)}catch(o){if(fn&&fn(o)===!0)return;throw o}}:i,Or=[];function vn(i){try{if("composedPath"in i){var o=i.composedPath();if(o.length)return o[0]}else if("path"in i&&i.path.length)return i.path[0]}catch{}return i&&i.target}function Es(i,o){var l=new Au;Or.push(l),l.init(i);var c=new(wr())(We(l.processMutations.bind(l)));return c.observe(o,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),c}function Ou(i){var{mouseInteractionCb:o,doc:l,mirror:c,blockClass:d,blockSelector:v,sampling:_}=i;if(_.mouseInteraction===!1)return()=>{};var w=_.mouseInteraction===!0||_.mouseInteraction===void 0?{}:_.mouseInteraction,S=[],I=null;return Object.keys(Pt).filter(k=>Number.isNaN(Number(k))&&!k.endsWith("_Departed")&&w[k]!==!1).forEach(k=>{var N=Ye(k),X=(B=>ne=>{var de=vn(ne);if(!Mt(de,d,v,!0)){var ie=null,F=B;if("pointerType"in ne){switch(ne.pointerType){case"mouse":ie=cr.Mouse;break;case"touch":ie=cr.Touch;break;case"pen":ie=cr.Pen}ie===cr.Touch?Pt[B]===Pt.MouseDown?F="TouchStart":Pt[B]===Pt.MouseUp&&(F="TouchEnd"):cr.Pen}else Hi(ne)&&(ie=cr.Touch);ie!==null?(I=ie,(F.startsWith("Touch")&&ie===cr.Touch||F.startsWith("Mouse")&&ie===cr.Mouse)&&(ie=null)):Pt[B]===Pt.Click&&(ie=I,I=null);var A=Hi(ne)?ne.changedTouches[0]:ne;if(A){var R=c.getId(de),{clientX:G,clientY:K}=A;We(o)(t({type:Pt[F],id:R,x:G,y:K},ie!==null&&{pointerType:ie}))}}})(k);if(window.PointerEvent)switch(Pt[k]){case Pt.MouseDown:case Pt.MouseUp:N=N.replace("mouse","pointer");break;case Pt.TouchStart:case Pt.TouchEnd:return}S.push(kt(N,X,l))}),We(()=>{S.forEach(k=>k())})}function ks(i){var{scrollCb:o,doc:l,mirror:c,blockClass:d,blockSelector:v,sampling:_}=i;return kt("scroll",We(gn(We(w=>{var S=vn(w);if(S&&!Mt(S,d,v,!0)){var I=c.getId(S);if(S===l&&l.defaultView){var k=ds(l.defaultView);o({id:I,x:k.left,y:k.top})}else o({id:I,x:S.scrollLeft,y:S.scrollTop})}}),_.scroll||100)),l)}var Nu=["INPUT","TEXTAREA","SELECT"],Ts=new WeakMap;function Wn(i){return function(o,l){if(jn("CSSGroupingRule")&&o.parentRule instanceof CSSGroupingRule||jn("CSSMediaRule")&&o.parentRule instanceof CSSMediaRule||jn("CSSSupportsRule")&&o.parentRule instanceof CSSSupportsRule||jn("CSSConditionRule")&&o.parentRule instanceof CSSConditionRule){var c=Array.from(o.parentRule.cssRules).indexOf(o);l.unshift(c)}else if(o.parentStyleSheet){var d=Array.from(o.parentStyleSheet.cssRules).indexOf(o);l.unshift(d)}return l}(i,[])}function Sr(i,o,l){var c,d;return i?(i.ownerNode?c=o.getId(i.ownerNode):d=l.getId(i),{styleId:d,id:c}):{}}function xs(i,o){var l,c,d,{mirror:v,stylesheetManager:_}=i,w=null;w=o.nodeName==="#document"?v.getId(o):v.getId(Ae.host(o));var S=o.nodeName==="#document"?(l=o.defaultView)==null?void 0:l.Document:(d=(c=o.ownerDocument)==null?void 0:c.defaultView)==null?void 0:d.ShadowRoot,I=S?.prototype?Object.getOwnPropertyDescriptor(S?.prototype,"adoptedStyleSheets"):void 0;return w!==null&&w!==-1&&S&&I?(Object.defineProperty(o,"adoptedStyleSheets",{configurable:I.configurable,enumerable:I.enumerable,get(){var k;return(k=I.get)==null?void 0:k.call(this)},set(k){var N,X=(N=I.set)==null?void 0:N.call(this,k);if(w!==null&&w!==-1)try{_.adoptStyleSheets(k,w)}catch{}return X}}),We(()=>{Object.defineProperty(o,"adoptedStyleSheets",{configurable:I.configurable,enumerable:I.enumerable,get:I.get,set:I.set})})):()=>{}}function Fu(i){var o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=i.doc.defaultView;if(!c)return()=>{};(function(A,R){var{mutationCb:G,mousemoveCb:K,mouseInteractionCb:Q,scrollCb:ee,viewportResizeCb:re,inputCb:ce,mediaInteractionCb:ge,styleSheetRuleCb:ke,styleDeclarationCb:Y,canvasMutationCb:Te,fontCb:_e,selectionCb:ye,customElementCb:ve}=A;A.mutationCb=function(){R.mutation&&R.mutation(...arguments),G(...arguments)},A.mousemoveCb=function(){R.mousemove&&R.mousemove(...arguments),K(...arguments)},A.mouseInteractionCb=function(){R.mouseInteraction&&R.mouseInteraction(...arguments),Q(...arguments)},A.scrollCb=function(){R.scroll&&R.scroll(...arguments),ee(...arguments)},A.viewportResizeCb=function(){R.viewportResize&&R.viewportResize(...arguments),re(...arguments)},A.inputCb=function(){R.input&&R.input(...arguments),ce(...arguments)},A.mediaInteractionCb=function(){R.mediaInteaction&&R.mediaInteaction(...arguments),ge(...arguments)},A.styleSheetRuleCb=function(){R.styleSheetRule&&R.styleSheetRule(...arguments),ke(...arguments)},A.styleDeclarationCb=function(){R.styleDeclaration&&R.styleDeclaration(...arguments),Y(...arguments)},A.canvasMutationCb=function(){R.canvasMutation&&R.canvasMutation(...arguments),Te(...arguments)},A.fontCb=function(){R.font&&R.font(...arguments),_e(...arguments)},A.selectionCb=function(){R.selection&&R.selection(...arguments),ye(...arguments)},A.customElementCb=function(){R.customElement&&R.customElement(...arguments),ve(...arguments)}})(i,l),i.recordDOM&&(o=Es(i,i.doc));var d=function(A){var{mousemoveCb:R,sampling:G,doc:K,mirror:Q}=A;if(G.mousemove===!1)return()=>{};var ee,re=typeof G.mousemove=="number"?G.mousemove:50,ce=typeof G.mousemoveCallback=="number"?G.mousemoveCallback:500,ge=[],ke=gn(We(_e=>{var ye=Date.now()-ee;R(ge.map(ve=>(ve.timeOffset-=ye,ve)),_e),ge=[],ee=null}),ce),Y=We(gn(We(_e=>{var ye=vn(_e),{clientX:ve,clientY:se}=Hi(_e)?_e.changedTouches[0]:_e;ee||(ee=$n()),ge.push({x:ve,y:se,id:Q.getId(ye),timeOffset:$n()-ee}),ke(typeof DragEvent<"u"&&_e instanceof DragEvent?Be.Drag:_e instanceof MouseEvent?Be.MouseMove:Be.TouchMove)}),re,{trailing:!1})),Te=[kt("mousemove",Y,K),kt("touchmove",Y,K),kt("drag",Y,K)];return We(()=>{Te.forEach(_e=>_e())})}(i),v=Ou(i),_=ks(i),w=function(A,R){var{viewportResizeCb:G}=A,{win:K}=R,Q=-1,ee=-1;return kt("resize",We(gn(We(()=>{var re=hs(),ce=ps();Q===re&&ee===ce||(G({width:Number(ce),height:Number(re)}),Q=re,ee=ce)}),200)),K)}(i,{win:c}),S=function(A){var{inputCb:R,doc:G,mirror:K,blockClass:Q,blockSelector:ee,ignoreClass:re,ignoreSelector:ce,maskInputOptions:ge,maskInputFn:ke,sampling:Y,userTriggeredOnInput:Te}=A;function _e($e){var Oe=vn($e),V=$e.isTrusted,xe=Oe&&Oe.tagName;if(Oe&&xe==="OPTION"&&(Oe=Ae.parentElement(Oe)),Oe&&xe&&!(Nu.indexOf(xe)<0)&&!Mt(Oe,Q,ee,!0)&&!(Oe.classList.contains(re)||ce&&Oe.matches(ce))){var At=Oe.value,ft=!1,it=St(Oe)||"";it==="radio"||it==="checkbox"?ft=Oe.checked:(ge[xe.toLowerCase()]||ge[it])&&(At=_t({element:Oe,maskInputOptions:ge,tagName:xe,type:it,value:At,maskInputFn:ke})),ye(Oe,Te?{text:At,isChecked:ft,userTriggered:V}:{text:At,isChecked:ft});var vt=Oe.name;it==="radio"&&vt&&ft&&G.querySelectorAll('input[type="radio"][name="'.concat(vt,'"]')).forEach(Ut=>{if(Ut!==Oe){var Xt=Ut.value;ye(Ut,Te?{text:Xt,isChecked:!ft,userTriggered:!1}:{text:Xt,isChecked:!ft})}})}}function ye($e,Oe){var V=Ts.get($e);if(!V||V.text!==Oe.text||V.isChecked!==Oe.isChecked){Ts.set($e,Oe);var xe=K.getId($e);We(R)(t(t({},Oe),{},{id:xe}))}}var ve=(Y.input==="last"?["change"]:["input","change"]).map($e=>kt($e,We(_e),G)),se=G.defaultView;if(!se)return()=>{ve.forEach($e=>$e())};var te=se.Object.getOwnPropertyDescriptor(se.HTMLInputElement.prototype,"value"),He=[[se.HTMLInputElement.prototype,"value"],[se.HTMLInputElement.prototype,"checked"],[se.HTMLSelectElement.prototype,"value"],[se.HTMLTextAreaElement.prototype,"value"],[se.HTMLSelectElement.prototype,"selectedIndex"],[se.HTMLOptionElement.prototype,"selected"]];return te&&te.set&&ve.push(...He.map($e=>Hn($e[0],$e[1],{set(){We(_e)({target:this,isTrusted:!1})}},!1,se))),We(()=>{ve.forEach($e=>$e())})}(i),I=function(A){var{mediaInteractionCb:R,blockClass:G,blockSelector:K,mirror:Q,sampling:ee,doc:re}=A,ce=We(ke=>gn(We(Y=>{var Te=vn(Y);if(Te&&!Mt(Te,G,K,!0)){var{currentTime:_e,volume:ye,muted:ve,playbackRate:se,loop:te}=Te;R({type:ke,id:Q.getId(Te),currentTime:_e,volume:ye,muted:ve,playbackRate:se,loop:te})}}),ee.media||500)),ge=[kt("play",ce(Xr.Play),re),kt("pause",ce(Xr.Pause),re),kt("seeked",ce(Xr.Seeked),re),kt("volumechange",ce(Xr.VolumeChange),re),kt("ratechange",ce(Xr.RateChange),re)];return We(()=>{ge.forEach(ke=>ke())})}(i),k=()=>{},N=()=>{},X=()=>{},B=()=>{};i.recordDOM&&(k=function(A,R){var{styleSheetRuleCb:G,mirror:K,stylesheetManager:Q}=A,{win:ee}=R;if(!ee.CSSStyleSheet||!ee.CSSStyleSheet.prototype)return()=>{};var re=ee.CSSStyleSheet.prototype.insertRule;ee.CSSStyleSheet.prototype.insertRule=new Proxy(re,{apply:We((_e,ye,ve)=>{var[se,te]=ve,{id:He,styleId:$e}=Sr(ye,K,Q.styleMirror);return(He&&He!==-1||$e&&$e!==-1)&&G({id:He,styleId:$e,adds:[{rule:se,index:te}]}),_e.apply(ye,ve)})}),ee.CSSStyleSheet.prototype.addRule=function(_e,ye){var ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.cssRules.length,se="".concat(_e," { ").concat(ye," }");return ee.CSSStyleSheet.prototype.insertRule.apply(this,[se,ve])};var ce,ge,ke=ee.CSSStyleSheet.prototype.deleteRule;ee.CSSStyleSheet.prototype.deleteRule=new Proxy(ke,{apply:We((_e,ye,ve)=>{var[se]=ve,{id:te,styleId:He}=Sr(ye,K,Q.styleMirror);return(te&&te!==-1||He&&He!==-1)&&G({id:te,styleId:He,removes:[{index:se}]}),_e.apply(ye,ve)})}),ee.CSSStyleSheet.prototype.removeRule=function(_e){return ee.CSSStyleSheet.prototype.deleteRule.apply(this,[_e])},ee.CSSStyleSheet.prototype.replace&&(ce=ee.CSSStyleSheet.prototype.replace,ee.CSSStyleSheet.prototype.replace=new Proxy(ce,{apply:We((_e,ye,ve)=>{var[se]=ve,{id:te,styleId:He}=Sr(ye,K,Q.styleMirror);return(te&&te!==-1||He&&He!==-1)&&G({id:te,styleId:He,replace:se}),_e.apply(ye,ve)})})),ee.CSSStyleSheet.prototype.replaceSync&&(ge=ee.CSSStyleSheet.prototype.replaceSync,ee.CSSStyleSheet.prototype.replaceSync=new Proxy(ge,{apply:We((_e,ye,ve)=>{var[se]=ve,{id:te,styleId:He}=Sr(ye,K,Q.styleMirror);return(te&&te!==-1||He&&He!==-1)&&G({id:te,styleId:He,replaceSync:se}),_e.apply(ye,ve)})}));var Y={};Gn("CSSGroupingRule")?Y.CSSGroupingRule=ee.CSSGroupingRule:(Gn("CSSMediaRule")&&(Y.CSSMediaRule=ee.CSSMediaRule),Gn("CSSConditionRule")&&(Y.CSSConditionRule=ee.CSSConditionRule),Gn("CSSSupportsRule")&&(Y.CSSSupportsRule=ee.CSSSupportsRule));var Te={};return Object.entries(Y).forEach(_e=>{var[ye,ve]=_e;Te[ye]={insertRule:ve.prototype.insertRule,deleteRule:ve.prototype.deleteRule},ve.prototype.insertRule=new Proxy(Te[ye].insertRule,{apply:We((se,te,He)=>{var[$e,Oe]=He,{id:V,styleId:xe}=Sr(te.parentStyleSheet,K,Q.styleMirror);return(V&&V!==-1||xe&&xe!==-1)&&G({id:V,styleId:xe,adds:[{rule:$e,index:[...Wn(te),Oe||0]}]}),se.apply(te,He)})}),ve.prototype.deleteRule=new Proxy(Te[ye].deleteRule,{apply:We((se,te,He)=>{var[$e]=He,{id:Oe,styleId:V}=Sr(te.parentStyleSheet,K,Q.styleMirror);return(Oe&&Oe!==-1||V&&V!==-1)&&G({id:Oe,styleId:V,removes:[{index:[...Wn(te),$e]}]}),se.apply(te,He)})})}),We(()=>{ee.CSSStyleSheet.prototype.insertRule=re,ee.CSSStyleSheet.prototype.deleteRule=ke,ce&&(ee.CSSStyleSheet.prototype.replace=ce),ge&&(ee.CSSStyleSheet.prototype.replaceSync=ge),Object.entries(Y).forEach(_e=>{var[ye,ve]=_e;ve.prototype.insertRule=Te[ye].insertRule,ve.prototype.deleteRule=Te[ye].deleteRule})})}(i,{win:c}),N=xs(i,i.doc),X=function(A,R){var{styleDeclarationCb:G,mirror:K,ignoreCSSAttributes:Q,stylesheetManager:ee}=A,{win:re}=R,ce=re.CSSStyleDeclaration.prototype.setProperty;re.CSSStyleDeclaration.prototype.setProperty=new Proxy(ce,{apply:We((ke,Y,Te)=>{var _e,[ye,ve,se]=Te;if(Q.has(ye))return ce.apply(Y,[ye,ve,se]);var{id:te,styleId:He}=Sr((_e=Y.parentRule)==null?void 0:_e.parentStyleSheet,K,ee.styleMirror);return(te&&te!==-1||He&&He!==-1)&&G({id:te,styleId:He,set:{property:ye,value:ve,priority:se},index:Wn(Y.parentRule)}),ke.apply(Y,Te)})});var ge=re.CSSStyleDeclaration.prototype.removeProperty;return re.CSSStyleDeclaration.prototype.removeProperty=new Proxy(ge,{apply:We((ke,Y,Te)=>{var _e,[ye]=Te;if(Q.has(ye))return ge.apply(Y,[ye]);var{id:ve,styleId:se}=Sr((_e=Y.parentRule)==null?void 0:_e.parentStyleSheet,K,ee.styleMirror);return(ve&&ve!==-1||se&&se!==-1)&&G({id:ve,styleId:se,remove:{property:ye},index:Wn(Y.parentRule)}),ke.apply(Y,Te)})}),We(()=>{re.CSSStyleDeclaration.prototype.setProperty=ce,re.CSSStyleDeclaration.prototype.removeProperty=ge})}(i,{win:c}),i.collectFonts&&(B=function(A){var{fontCb:R,doc:G}=A,K=G.defaultView;if(!K)return()=>{};var Q=[],ee=new WeakMap,re=K.FontFace;K.FontFace=function(ge,ke,Y){var Te=new re(ge,ke,Y);return ee.set(Te,{family:ge,buffer:typeof ke!="string",descriptors:Y,fontSource:typeof ke=="string"?ke:JSON.stringify(Array.from(new Uint8Array(ke)))}),Te};var ce=Yr(G.fonts,"add",function(ge){return function(ke){return setTimeout(We(()=>{var Y=ee.get(ke);Y&&(R(Y),ee.delete(ke))}),0),ge.apply(this,[ke])}});return Q.push(()=>{K.FontFace=re}),Q.push(ce),We(()=>{Q.forEach(ge=>ge())})}(i)));var ne=function(A){var{doc:R,mirror:G,blockClass:K,blockSelector:Q,selectionCb:ee}=A,re=!0,ce=We(()=>{var ge=R.getSelection();if(!(!ge||re&&ge?.isCollapsed)){re=ge.isCollapsed||!1;for(var ke=[],Y=ge.rangeCount||0,Te=0;Te<Y;Te++){var _e=ge.getRangeAt(Te),{startContainer:ye,startOffset:ve,endContainer:se,endOffset:te}=_e;Mt(ye,K,Q,!0)||Mt(se,K,Q,!0)||ke.push({start:G.getId(ye),startOffset:ve,end:G.getId(se),endOffset:te})}ee({ranges:ke})}});return ce(),kt("selectionchange",ce)}(i),de=function(A){var{doc:R,customElementCb:G}=A,K=R.defaultView;return K&&K.customElements?Yr(K.customElements,"define",function(Q){return function(ee,re,ce){try{G({define:{name:ee}})}catch{console.warn("Custom element callback failed for ".concat(ee))}return Q.apply(this,[ee,re,ce])}}):()=>{}}(i),ie=[];for(var F of i.plugins)ie.push(F.observer(F.callback,c,F.options));return We(()=>{Or.forEach(A=>A.reset()),o?.disconnect(),d(),v(),_(),w(),S(),I(),k(),N(),X(),B(),ne(),de(),ie.forEach(A=>A())})}function jn(i){return window[i]!==void 0}function Gn(i){return!!(window[i]!==void 0&&window[i].prototype&&"insertRule"in window[i].prototype&&"deleteRule"in window[i].prototype)}class Rs{constructor(o){g(this,"iframeIdToRemoteIdMap",new WeakMap),g(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=o}getId(o,l,c,d){var v=c||this.getIdToRemoteIdMap(o),_=d||this.getRemoteIdToIdMap(o),w=v.get(l);return w||(w=this.generateIdFn(),v.set(l,w),_.set(w,l)),w}getIds(o,l){var c=this.getIdToRemoteIdMap(o),d=this.getRemoteIdToIdMap(o);return l.map(v=>this.getId(o,v,c,d))}getRemoteId(o,l,c){var d=c||this.getRemoteIdToIdMap(o);if(typeof l!="number")return l;var v=d.get(l);return v||-1}getRemoteIds(o,l){var c=this.getRemoteIdToIdMap(o);return l.map(d=>this.getRemoteId(o,d,c))}reset(o){if(!o)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(o),this.iframeRemoteIdToIdMap.delete(o)}getIdToRemoteIdMap(o){var l=this.iframeIdToRemoteIdMap.get(o);return l||(l=new Map,this.iframeIdToRemoteIdMap.set(o,l)),l}getRemoteIdToIdMap(o){var l=this.iframeRemoteIdToIdMap.get(o);return l||(l=new Map,this.iframeRemoteIdToIdMap.set(o,l)),l}}class Lu{constructor(o){g(this,"iframes",new WeakMap),g(this,"crossOriginIframeMap",new WeakMap),g(this,"crossOriginIframeMirror",new Rs(O)),g(this,"crossOriginIframeStyleMirror"),g(this,"crossOriginIframeRootIdMap",new WeakMap),g(this,"mirror"),g(this,"mutationCb"),g(this,"wrappedEmit"),g(this,"loadListener"),g(this,"stylesheetManager"),g(this,"recordCrossOriginIframes"),this.mutationCb=o.mutationCb,this.wrappedEmit=o.wrappedEmit,this.stylesheetManager=o.stylesheetManager,this.recordCrossOriginIframes=o.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Rs(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=o.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(o){this.iframes.set(o,!0),o.contentWindow&&this.crossOriginIframeMap.set(o.contentWindow,o)}addLoadListener(o){this.loadListener=o}attachIframe(o,l){var c,d;this.mutationCb({adds:[{parentId:this.mirror.getId(o),nextId:null,node:l}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&((c=o.contentWindow)==null||c.addEventListener("message",this.handleMessage.bind(this))),(d=this.loadListener)==null||d.call(this,o),o.contentDocument&&o.contentDocument.adoptedStyleSheets&&o.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(o.contentDocument.adoptedStyleSheets,this.mirror.getId(o.contentDocument))}handleMessage(o){var l=o;if(l.data.type==="rrweb"&&l.origin===l.data.origin&&o.source){var c=this.crossOriginIframeMap.get(o.source);if(c){var d=this.transformCrossOriginEvent(c,l.data.event);d&&this.wrappedEmit(d,l.data.isCheckout)}}}transformCrossOriginEvent(o,l){var c;switch(l.type){case Ge.FullSnapshot:this.crossOriginIframeMirror.reset(o),this.crossOriginIframeStyleMirror.reset(o),this.replaceIdOnNode(l.data.node,o);var d=l.data.node.id;return this.crossOriginIframeRootIdMap.set(o,d),this.patchRootIdOnNode(l.data.node,d),{timestamp:l.timestamp,type:Ge.IncrementalSnapshot,data:{source:Be.Mutation,adds:[{parentId:this.mirror.getId(o),nextId:null,node:l.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case Ge.Meta:case Ge.Load:case Ge.DomContentLoaded:return!1;case Ge.Plugin:return l;case Ge.Custom:return this.replaceIds(l.data.payload,o,["id","parentId","previousId","nextId"]),l;case Ge.IncrementalSnapshot:switch(l.data.source){case Be.Mutation:return l.data.adds.forEach(v=>{this.replaceIds(v,o,["parentId","nextId","previousId"]),this.replaceIdOnNode(v.node,o);var _=this.crossOriginIframeRootIdMap.get(o);_&&this.patchRootIdOnNode(v.node,_)}),l.data.removes.forEach(v=>{this.replaceIds(v,o,["parentId","id"])}),l.data.attributes.forEach(v=>{this.replaceIds(v,o,["id"])}),l.data.texts.forEach(v=>{this.replaceIds(v,o,["id"])}),l;case Be.Drag:case Be.TouchMove:case Be.MouseMove:return l.data.positions.forEach(v=>{this.replaceIds(v,o,["id"])}),l;case Be.ViewportResize:return!1;case Be.MediaInteraction:case Be.MouseInteraction:case Be.Scroll:case Be.CanvasMutation:case Be.Input:return this.replaceIds(l.data,o,["id"]),l;case Be.StyleSheetRule:case Be.StyleDeclaration:return this.replaceIds(l.data,o,["id"]),this.replaceStyleIds(l.data,o,["styleId"]),l;case Be.Font:return l;case Be.Selection:return l.data.ranges.forEach(v=>{this.replaceIds(v,o,["start","end"])}),l;case Be.AdoptedStyleSheet:return this.replaceIds(l.data,o,["id"]),this.replaceStyleIds(l.data,o,["styleIds"]),(c=l.data.styles)==null||c.forEach(v=>{this.replaceStyleIds(v,o,["styleId"])}),l}}return!1}replace(o,l,c,d){for(var v of d)(Array.isArray(l[v])||typeof l[v]=="number")&&(Array.isArray(l[v])?l[v]=o.getIds(c,l[v]):l[v]=o.getId(c,l[v]));return l}replaceIds(o,l,c){return this.replace(this.crossOriginIframeMirror,o,l,c)}replaceStyleIds(o,l,c){return this.replace(this.crossOriginIframeStyleMirror,o,l,c)}replaceIdOnNode(o,l){this.replaceIds(o,l,["id","rootId"]),"childNodes"in o&&o.childNodes.forEach(c=>{this.replaceIdOnNode(c,l)})}patchRootIdOnNode(o,l){o.type===y.Document||o.rootId||(o.rootId=l),"childNodes"in o&&o.childNodes.forEach(c=>{this.patchRootIdOnNode(c,l)})}}class Pu{constructor(o){g(this,"shadowDoms",new WeakSet),g(this,"mutationCb"),g(this,"scrollCb"),g(this,"bypassOptions"),g(this,"mirror"),g(this,"restoreHandlers",[]),this.mutationCb=o.mutationCb,this.scrollCb=o.scrollCb,this.bypassOptions=o.bypassOptions,this.mirror=o.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(o,l){if(je(o)&&!this.shadowDoms.has(o)){this.shadowDoms.add(o);var c=Es(t(t({},this.bypassOptions),{},{doc:l,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),o);this.restoreHandlers.push(()=>c.disconnect()),this.restoreHandlers.push(ks(t(t({},this.bypassOptions),{},{scrollCb:this.scrollCb,doc:o,mirror:this.mirror}))),setTimeout(()=>{o.adoptedStyleSheets&&o.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(o.adoptedStyleSheets,this.mirror.getId(Ae.host(o))),this.restoreHandlers.push(xs({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},o))},0)}}observeAttachShadow(o){o.contentWindow&&o.contentDocument&&this.patchAttachShadow(o.contentWindow.Element,o.contentDocument)}patchAttachShadow(o,l){var c=this;this.restoreHandlers.push(Yr(o.prototype,"attachShadow",function(d){return function(v){var _=d.call(this,v),w=Ae.shadowRoot(this);return w&&ys(this)&&c.addShadowRoot(w,l),_}}))}reset(){this.restoreHandlers.forEach(o=>{try{o()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Du=typeof Uint8Array>"u"?[]:new Uint8Array(256),qn=0;qn<64;qn++)Du[mn.charCodeAt(qn)]=qn;var Ms=new Map,As=(i,o,l)=>{if(i&&(Ns(i,o)||typeof i=="object")){var c=function(v,_){var w=Ms.get(v);return w||(w=new Map,Ms.set(v,w)),w.has(_)||w.set(_,[]),w.get(_)}(l,i.constructor.name),d=c.indexOf(i);return d===-1&&(d=c.length,c.push(i)),d}};function Un(i,o,l){if(i instanceof Array)return i.map(v=>Un(v,o,l));if(i===null)return i;if(i instanceof Float32Array||i instanceof Float64Array||i instanceof Int32Array||i instanceof Uint32Array||i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Int16Array||i instanceof Int8Array||i instanceof Uint8ClampedArray)return{rr_type:i.constructor.name,args:[Object.values(i)]};if(i instanceof ArrayBuffer)return{rr_type:i.constructor.name,base64:function(v){var _,w=new Uint8Array(v),S=w.length,I="";for(_=0;_<S;_+=3)I+=mn[w[_]>>2],I+=mn[(3&w[_])<<4|w[_+1]>>4],I+=mn[(15&w[_+1])<<2|w[_+2]>>6],I+=mn[63&w[_+2]];return S%3==2?I=I.substring(0,I.length-1)+"=":S%3==1&&(I=I.substring(0,I.length-2)+"=="),I}(i)};if(i instanceof DataView)return{rr_type:i.constructor.name,args:[Un(i.buffer,o,l),i.byteOffset,i.byteLength]};if(i instanceof HTMLImageElement){var c=i.constructor.name,{src:d}=i;return{rr_type:c,src:d}}return i instanceof HTMLCanvasElement?{rr_type:"HTMLImageElement",src:i.toDataURL()}:i instanceof ImageData?{rr_type:i.constructor.name,args:[Un(i.data,o,l),i.width,i.height]}:Ns(i,o)||typeof i=="object"?{rr_type:i.constructor.name,index:As(i,o,l)}:i}var Os=(i,o,l)=>i.map(c=>Un(c,o,l)),Ns=(i,o)=>{var l=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(c=>typeof o[c]=="function");return!!l.find(c=>i instanceof o[c])};function Fs(i,o,l,c){var d=[];try{var v=Yr(i.HTMLCanvasElement.prototype,"getContext",function(_){return function(w){for(var S=arguments.length,I=new Array(S>1?S-1:0),k=1;k<S;k++)I[k-1]=arguments[k];if(!Mt(this,o,l,!0)){var N=function(B){return B==="experimental-webgl"?"webgl":B}(w);if("__context"in this||(this.__context=N),c&&["webgl","webgl2"].includes(N))if(I[0]&&typeof I[0]=="object"){var X=I[0];X.preserveDrawingBuffer||(X.preserveDrawingBuffer=!0)}else I.splice(0,1,{preserveDrawingBuffer:!0})}return _.apply(this,[w,...I])}});d.push(v)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{d.forEach(_=>_())}}function Ls(i,o,l,c,d,v){var _=[],w=Object.getOwnPropertyNames(i),S=function(k){if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(k))return"continue";try{if(typeof i[k]!="function")return"continue";var N=Yr(i,k,function(B){return function(){for(var ne=arguments.length,de=new Array(ne),ie=0;ie<ne;ie++)de[ie]=arguments[ie];var F=B.apply(this,de);if(As(F,v,this),"tagName"in this.canvas&&!Mt(this.canvas,c,d,!0)){var A=Os(de,v,this),R={type:o,property:k,args:A};l(this.canvas,R)}return F}});_.push(N)}catch{var X=Hn(i,k,{set(ne){l(this.canvas,{type:o,property:k,args:[ne],setter:!0})}});_.push(X)}};for(var I of w)S(I);return _}var Ps,at,Vn,ji,Ds="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",Bs=typeof window<"u"&&window.Blob&&new Blob([(Ps=Ds,Uint8Array.from(atob(Ps),i=>i.charCodeAt(0)))],{type:"text/javascript;charset=utf-8"});function Bu(i){var o;try{if(!(o=Bs&&(window.URL||window.webkitURL).createObjectURL(Bs)))throw"";var l=new Worker(o,{name:i?.name});return l.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(o)}),l}catch{return new Worker("data:text/javascript;base64,"+Ds,{name:i?.name})}finally{o&&(window.URL||window.webkitURL).revokeObjectURL(o)}}class Hu{constructor(o){g(this,"pendingCanvasMutations",new Map),g(this,"rafStamps",{latestId:0,invokeId:null}),g(this,"mirror"),g(this,"mutationCb"),g(this,"resetObservers"),g(this,"frozen",!1),g(this,"locked",!1),g(this,"processMutation",(S,I)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(S)||this.pendingCanvasMutations.set(S,[]),this.pendingCanvasMutations.get(S).push(I)});var{sampling:l="all",win:c,blockClass:d,blockSelector:v,recordCanvas:_,dataURLOptions:w}=o;this.mutationCb=o.mutationCb,this.mirror=o.mirror,_&&l==="all"&&this.initCanvasMutationObserver(c,d,v),_&&typeof l=="number"&&this.initCanvasFPSObserver(l,c,d,v,{dataURLOptions:w})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(o,l,c,d,v){var _=this,w=Fs(l,c,d,!0),S=new Map,I=new Bu;I.onmessage=ne=>{var{id:de}=ne.data;if(S.set(de,!1),"base64"in ne.data){var{base64:ie,type:F,width:A,height:R}=ne.data;this.mutationCb({id:de,type:Zr["2D"],commands:[{property:"clearRect",args:[0,0,A,R]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:ie}],type:F}]},0,0]}]})}};var k,N=1e3/o,X=0,B=ne=>{var de,ie;X&&ne-X<N||(X=ne,(de=[],ie=F=>{F.querySelectorAll("canvas").forEach(A=>{Mt(A,c,d,!0)||de.push(A)}),F.querySelectorAll("*").forEach(A=>{A.shadowRoot&&ie(A.shadowRoot)})},ie(l.document),de).forEach(function(){var F=s(function*(A){var R,G=_.mirror.getId(A);if(!S.get(G)&&A.width!==0&&A.height!==0){if(S.set(G,!0),["webgl","webgl2"].includes(A.__context)){var K=A.getContext(A.__context);((R=K?.getContextAttributes())==null?void 0:R.preserveDrawingBuffer)===!1&&K.clear(K.COLOR_BUFFER_BIT)}var Q=A.clientWidth||A.width,ee=A.clientHeight||A.height,re=yield createImageBitmap(A,{resizeWidth:Q,resizeHeight:ee});I.postMessage({id:G,bitmap:re,width:Q,height:ee,dataURLOptions:v.dataURLOptions},[re])}});return function(A){return F.apply(this,arguments)}}())),k=requestAnimationFrame(B)};k=requestAnimationFrame(B),this.resetObservers=()=>{w(),cancelAnimationFrame(k)}}initCanvasMutationObserver(o,l,c){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var d=Fs(o,l,c,!1),v=function(w,S,I,k){var N=[],X=Object.getOwnPropertyNames(S.CanvasRenderingContext2D.prototype),B=function(de){try{if(typeof S.CanvasRenderingContext2D.prototype[de]!="function")return"continue";var ie=Yr(S.CanvasRenderingContext2D.prototype,de,function(A){return function(){for(var R=arguments.length,G=new Array(R),K=0;K<R;K++)G[K]=arguments[K];return Mt(this.canvas,I,k,!0)||setTimeout(()=>{var Q=Os(G,S,this);w(this.canvas,{type:Zr["2D"],property:de,args:Q})},0),A.apply(this,G)}});N.push(ie)}catch{var F=Hn(S.CanvasRenderingContext2D.prototype,de,{set(R){w(this.canvas,{type:Zr["2D"],property:de,args:[R],setter:!0})}});N.push(F)}};for(var ne of X)B(ne);return()=>{N.forEach(de=>de())}}(this.processMutation.bind(this),o,l,c),_=function(w,S,I,k){var N=[];return N.push(...Ls(S.WebGLRenderingContext.prototype,Zr.WebGL,w,I,k,S)),S.WebGL2RenderingContext!==void 0&&N.push(...Ls(S.WebGL2RenderingContext.prototype,Zr.WebGL2,w,I,k,S)),()=>{N.forEach(X=>X())}}(this.processMutation.bind(this),o,l,c);this.resetObservers=()=>{d(),v(),_()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){var o=l=>{this.rafStamps.latestId=l,requestAnimationFrame(o)};requestAnimationFrame(o)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((o,l)=>{var c=this.mirror.getId(l);this.flushPendingCanvasMutationFor(l,c)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(o,l){if(!this.frozen&&!this.locked){var c=this.pendingCanvasMutations.get(o);if(c&&l!==-1){var d=c.map(_=>u(_,p)),{type:v}=c[0];this.mutationCb({id:l,type:v,commands:d}),this.pendingCanvasMutations.delete(o)}}}}class $u{constructor(o){g(this,"trackedLinkElements",new WeakSet),g(this,"mutationCb"),g(this,"adoptedStyleSheetCb"),g(this,"styleMirror",new xu),this.mutationCb=o.mutationCb,this.adoptedStyleSheetCb=o.adoptedStyleSheetCb}attachLinkElement(o,l){"_cssText"in l.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:l.id,attributes:l.attributes}]}),this.trackLinkElement(o)}trackLinkElement(o){this.trackedLinkElements.has(o)||(this.trackedLinkElements.add(o),this.trackStylesheetInLinkElement(o))}adoptStyleSheets(o,l){var c=this;if(o.length!==0){var d={id:l,styleIds:[]},v=[],_=function(S){var I=void 0;c.styleMirror.has(S)?I=c.styleMirror.getId(S):(I=c.styleMirror.add(S),v.push({styleId:I,rules:Array.from(S.rules||CSSRule,(k,N)=>({rule:ct(k,S.href),index:N}))})),d.styleIds.push(I)};for(var w of o)_(w);v.length>0&&(d.styles=v),this.adoptedStyleSheetCb(d)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(o){}}class Wu{constructor(){g(this,"nodeMap",new WeakMap),g(this,"active",!1)}inOtherBuffer(o,l){var c=this.nodeMap.get(o);return c&&Array.from(c).some(d=>d!==l)}add(o,l){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(o,(this.nodeMap.get(o)||new Set).add(l))}destroy(){}}var zn=!1;try{if(Array.from([1],i=>2*i)[0]!==2){var Gi=document.createElement("iframe");document.body.appendChild(Gi),Array.from=((h=Gi.contentWindow)==null?void 0:h.Array.from)||Array.from,document.body.removeChild(Gi)}}catch(i){console.debug("Unable to override Array.from",i)}var Hs,Jr,tr=new wt;function Nr(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{emit:o,checkoutEveryNms:l,checkoutEveryNth:c,blockClass:d="rr-block",blockSelector:v=null,ignoreClass:_="rr-ignore",ignoreSelector:w=null,maskTextClass:S="rr-mask",maskTextSelector:I=null,inlineStylesheet:k=!0,maskAllInputs:N,maskInputOptions:X,slimDOMOptions:B,maskInputFn:ne,maskTextFn:de,hooks:ie,packFn:F,sampling:A={},dataURLOptions:R={},mousemoveWait:G,recordDOM:K=!0,recordCanvas:Q=!1,recordCrossOriginIframes:ee=!1,recordAfter:re=i.recordAfter==="DOMContentLoaded"?i.recordAfter:"load",userTriggeredOnInput:ce=!1,collectFonts:ge=!1,inlineImages:ke=!1,plugins:Y,keepIframeSrcFn:Te=()=>!1,ignoreCSSAttributes:_e=new Set([]),errorHandler:ye}=i;fn=ye;var ve=!ee||window.parent===window,se=!1;if(!ve)try{window.parent.document&&(se=!1)}catch{se=!0}if(ve&&!o)throw new Error("emit function is required");if(!ve&&!se)return()=>{};G!==void 0&&A.mousemove===void 0&&(A.mousemove=G),tr.reset();var te,He=N===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:X!==void 0?X:{password:!0},$e=B===!0||B==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:B==="all",headMetaDescKeywords:B==="all",headTitleMutations:B==="all"}:B||{};(function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;"NodeList"in Ne&&!Ne.NodeList.prototype.forEach&&(Ne.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in Ne&&!Ne.DOMTokenList.prototype.forEach&&(Ne.DOMTokenList.prototype.forEach=Array.prototype.forEach)})();var Oe=0,V=Ne=>{for(var Ot of Y||[])Ot.eventProcessor&&(Ne=Ot.eventProcessor(Ne));return F&&!se&&(Ne=F(Ne)),Ne};at=(Ne,Ot)=>{var Ie,Fe=Ne;if(Fe.timestamp=$n(),!((Ie=Or[0])!=null&&Ie.isFrozen())||Fe.type===Ge.FullSnapshot||Fe.type===Ge.IncrementalSnapshot&&Fe.data.source===Be.Mutation||Or.forEach(pr=>pr.unfreeze()),ve)o?.(V(Fe),Ot);else if(se){var Bt={type:"rrweb",event:V(Fe),origin:window.location.origin,isCheckout:Ot};window.parent.postMessage(Bt,"*")}if(Fe.type===Ge.FullSnapshot)te=Fe,Oe=0;else if(Fe.type===Ge.IncrementalSnapshot){if(Fe.data.source===Be.Mutation&&Fe.data.isAttachIframe)return;Oe++;var rr=c&&Oe>=c,nr=l&&Fe.timestamp-te.timestamp>l;(rr||nr)&&Vn(!0)}};var xe=Ne=>{at({type:Ge.IncrementalSnapshot,data:t({source:Be.Mutation},Ne)})},At=Ne=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.Scroll},Ne)}),ft=Ne=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.CanvasMutation},Ne)}),it=new $u({mutationCb:xe,adoptedStyleSheetCb:Ne=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.AdoptedStyleSheet},Ne)})}),vt=new Lu({mirror:tr,mutationCb:xe,stylesheetManager:it,recordCrossOriginIframes:ee,wrappedEmit:at});for(var Ut of Y||[])Ut.getMirror&&Ut.getMirror({nodeMirror:tr,crossOriginIframeMirror:vt.crossOriginIframeMirror,crossOriginIframeStyleMirror:vt.crossOriginIframeStyleMirror});var Xt=new Wu;ji=new Hu({recordCanvas:Q,mutationCb:ft,win:window,blockClass:d,blockSelector:v,mirror:tr,sampling:A.canvas,dataURLOptions:R});var ot=new Pu({mutationCb:xe,scrollCb:At,bypassOptions:{blockClass:d,blockSelector:v,maskTextClass:S,maskTextSelector:I,inlineStylesheet:k,maskInputOptions:He,dataURLOptions:R,maskTextFn:de,maskInputFn:ne,recordCanvas:Q,inlineImages:ke,sampling:A,slimDOMOptions:$e,iframeManager:vt,stylesheetManager:it,canvasManager:ji,keepIframeSrcFn:Te,processedNodeManager:Xt},mirror:tr});Vn=function(){var Ne=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(K){at({type:Ge.Meta,data:{href:window.location.href,width:ps(),height:hs()}},Ne),it.reset(),ot.init(),Or.forEach(Ie=>Ie.lock());var Ot=function(Ie,Fe){var{mirror:Bt=new wt,blockClass:rr="rr-block",blockSelector:nr=null,maskTextClass:pr="rr-mask",maskTextSelector:ni=null,inlineStylesheet:po=!0,inlineImages:pc=!1,recordCanvas:gc=!1,maskAllInputs:go=!1,maskTextFn:fc,maskInputFn:vc,slimDOM:yn=!1,dataURLOptions:mc,preserveWhiteSpace:_c,onSerialize:yc,onIframeLoad:bc,iframeLoadTimeout:wc,onStylesheetLoad:Sc,stylesheetLoadTimeout:Ic,keepIframeSrcFn:Cc=()=>!1}=Fe;return q(Ie,{doc:Ie,mirror:Bt,blockClass:rr,blockSelector:nr,maskTextClass:pr,maskTextSelector:ni,skipChild:!1,inlineStylesheet:po,maskInputOptions:go===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:go===!1?{password:!0}:go,maskTextFn:fc,maskInputFn:vc,slimDOMOptions:yn===!0||yn==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:yn==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:yn===!1?{}:yn,dataURLOptions:mc,inlineImages:pc,recordCanvas:gc,preserveWhiteSpace:_c,onSerialize:yc,onIframeLoad:bc,iframeLoadTimeout:wc,onStylesheetLoad:Sc,stylesheetLoadTimeout:Ic,keepIframeSrcFn:Cc,newlyAddedElement:!1})}(document,{mirror:tr,blockClass:d,blockSelector:v,maskTextClass:S,maskTextSelector:I,inlineStylesheet:k,maskAllInputs:He,maskTextFn:de,maskInputFn:ne,slimDOM:$e,dataURLOptions:R,recordCanvas:Q,inlineImages:ke,onSerialize:Ie=>{vs(Ie,tr)&&vt.addIframe(Ie),ms(Ie,tr)&&it.trackLinkElement(Ie),$i(Ie)&&ot.addShadowRoot(Ae.shadowRoot(Ie),document)},onIframeLoad:(Ie,Fe)=>{vt.attachIframe(Ie,Fe),ot.observeAttachShadow(Ie)},onStylesheetLoad:(Ie,Fe)=>{it.attachLinkElement(Ie,Fe)},keepIframeSrcFn:Te});if(!Ot)return console.warn("Failed to snapshot the document");at({type:Ge.FullSnapshot,data:{node:Ot,initialOffset:ds(window)}},Ne),Or.forEach(Ie=>Ie.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&it.adoptStyleSheets(document.adoptedStyleSheets,tr.getId(document))}};try{var Fr=[],_n=Ne=>{var Ot;return We(Fu)({mutationCb:xe,mousemoveCb:(Ie,Fe)=>at({type:Ge.IncrementalSnapshot,data:{source:Fe,positions:Ie}}),mouseInteractionCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.MouseInteraction},Ie)}),scrollCb:At,viewportResizeCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.ViewportResize},Ie)}),inputCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.Input},Ie)}),mediaInteractionCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.MediaInteraction},Ie)}),styleSheetRuleCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.StyleSheetRule},Ie)}),styleDeclarationCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.StyleDeclaration},Ie)}),canvasMutationCb:ft,fontCb:Ie=>at({type:Ge.IncrementalSnapshot,data:t({source:Be.Font},Ie)}),selectionCb:Ie=>{at({type:Ge.IncrementalSnapshot,data:t({source:Be.Selection},Ie)})},customElementCb:Ie=>{at({type:Ge.IncrementalSnapshot,data:t({source:Be.CustomElement},Ie)})},blockClass:d,ignoreClass:_,ignoreSelector:w,maskTextClass:S,maskTextSelector:I,maskInputOptions:He,inlineStylesheet:k,sampling:A,recordDOM:K,recordCanvas:Q,inlineImages:ke,userTriggeredOnInput:ce,collectFonts:ge,doc:Ne,maskInputFn:ne,maskTextFn:de,keepIframeSrcFn:Te,blockSelector:v,slimDOMOptions:$e,dataURLOptions:R,mirror:tr,iframeManager:vt,stylesheetManager:it,shadowDomManager:ot,processedNodeManager:Xt,canvasManager:ji,ignoreCSSAttributes:_e,plugins:((Ot=Y?.filter(Ie=>Ie.observer))==null?void 0:Ot.map(Ie=>({observer:Ie.observer,options:Ie.options,callback:Fe=>at({type:Ge.Plugin,data:{plugin:Ie.name,payload:Fe}})})))||[]},ie)};vt.addLoadListener(Ne=>{try{Fr.push(_n(Ne.contentDocument))}catch(Ot){console.warn(Ot)}});var hr=()=>{Vn(),Fr.push(_n(document)),zn=!0};return document.readyState==="interactive"||document.readyState==="complete"?hr():(Fr.push(kt("DOMContentLoaded",()=>{at({type:Ge.DomContentLoaded,data:{}}),re==="DOMContentLoaded"&&hr()})),Fr.push(kt("load",()=>{at({type:Ge.Load,data:{}}),re==="load"&&hr()},window))),()=>{Fr.forEach(Ne=>Ne()),Xt.destroy(),zn=!1,fn=void 0}}catch(Ne){console.warn(Ne)}}Nr.addCustomEvent=(i,o)=>{if(!zn)throw new Error("please add custom event after start recording");at({type:Ge.Custom,data:{tag:i,payload:o}})},Nr.freezePage=()=>{Or.forEach(i=>i.freeze())},Nr.takeFullSnapshot=i=>{if(!zn)throw new Error("please take full snapshot after start recording");Vn(i)},Nr.mirror=tr,(Jr=Hs||(Hs={}))[Jr.NotStarted=0]="NotStarted",Jr[Jr.Running=1]="Running",Jr[Jr.Stopped=2]="Stopped";var $s,ju=Object.defineProperty,Yn=(i,o,l)=>((c,d,v)=>d in c?ju(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v)(i,typeof o!="symbol"?o+"":o,l),Gu=Object.defineProperty,qi=(i,o,l)=>((c,d,v)=>d in c?Gu(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v)(i,typeof o!="symbol"?o+"":o,l),qu=Object.defineProperty,Ws=(i,o,l)=>((c,d,v)=>d in c?qu(c,d,{enumerable:!0,configurable:!0,writable:!0,value:v}):c[d]=v)(i,typeof o!="symbol"?o+"":o,l),js={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Gs={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Zn={};function Ui(i){if(Zn[i])return Zn[i];var o=globalThis[i],l=o.prototype,c=i in js?js[i]:void 0,d=!!(c&&c.every(k=>{var N,X;return!!((X=(N=Object.getOwnPropertyDescriptor(l,k))==null?void 0:N.get)!=null&&X.toString().includes("[native code]"))})),v=i in Gs?Gs[i]:void 0,_=!!(v&&v.every(k=>{var N;return typeof l[k]=="function"&&((N=l[k])==null?void 0:N.toString().includes("[native code]"))}));if(d&&_)return Zn[i]=o.prototype,o.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var S=w.contentWindow;if(!S)return o.prototype;var I=S[i].prototype;return document.body.removeChild(w),I?Zn[i]=I:l}catch{return l}}var Vi={};function Ir(i,o,l){var c,d="".concat(i,".").concat(String(l));if(Vi[d])return Vi[d].call(o);var v=Ui(i),_=(c=Object.getOwnPropertyDescriptor(v,l))==null?void 0:c.get;return _?(Vi[d]=_,_.call(o)):o[l]}var zi={};function qs(i,o,l){var c="".concat(i,".").concat(String(l));if(zi[c])return zi[c].bind(o);var d=Ui(i)[l];return typeof d!="function"?o[l]:(zi[c]=d,d.bind(o))}var Xn={childNodes:function(i){return Ir("Node",i,"childNodes")},parentNode:function(i){return Ir("Node",i,"parentNode")},parentElement:function(i){return Ir("Node",i,"parentElement")},textContent:function(i){return Ir("Node",i,"textContent")},contains:function(i,o){return qs("Node",i,"contains")(o)},getRootNode:function(i){return qs("Node",i,"getRootNode")()},host:function(i){return i&&"host"in i?Ir("ShadowRoot",i,"host"):null},styleSheets:function(i){return i.styleSheets},shadowRoot:function(i){return i&&"shadowRoot"in i?Ir("Element",i,"shadowRoot"):null},querySelector:function(i,o){return Ir("Element",i,"querySelector")(o)},querySelectorAll:function(i,o){return Ir("Element",i,"querySelectorAll")(o)},mutationObserver:function(){return Ui("MutationObserver").constructor}};class Uu{constructor(){Ws(this,"idNodeMap",new Map),Ws(this,"nodeMetaMap",new WeakMap)}getId(o){var l;if(!o)return-1;var c=(l=this.getMeta(o))==null?void 0:l.id;return c??-1}getNode(o){return this.idNodeMap.get(o)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(o){return this.nodeMetaMap.get(o)||null}removeNodeFromMap(o){var l=this.getId(o);this.idNodeMap.delete(l),o.childNodes&&o.childNodes.forEach(c=>this.removeNodeFromMap(c))}has(o){return this.idNodeMap.has(o)}hasNode(o){return this.nodeMetaMap.has(o)}add(o,l){var c=l.id;this.idNodeMap.set(c,o),this.nodeMetaMap.set(o,l)}replace(o,l){var c=this.getNode(o);if(c){var d=this.nodeMetaMap.get(c);d&&this.nodeMetaMap.set(l,d)}this.idNodeMap.set(o,l)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Yi(i,o,l){if(!i)return!1;if(i.nodeType!==i.ELEMENT_NODE)return!!l&&Yi(Xn.parentNode(i),o,l);for(var c=i.classList.length;c--;){var d=i.classList[c];if(o.test(d))return!0}return!!l&&Yi(Xn.parentNode(i),o,l)}class Zi{constructor(){__publicField22(this,"parentElement",null),__publicField22(this,"parentNode",null),__publicField22(this,"ownerDocument"),__publicField22(this,"firstChild",null),__publicField22(this,"lastChild",null),__publicField22(this,"previousSibling",null),__publicField22(this,"nextSibling",null),__publicField22(this,"ELEMENT_NODE",1),__publicField22(this,"TEXT_NODE",3),__publicField22(this,"nodeType"),__publicField22(this,"nodeName"),__publicField22(this,"RRNodeType")}get childNodes(){for(var o=[],l=this.firstChild;l;)o.push(l),l=l.nextSibling;return o}contains(o){if(!(o instanceof Zi)||o.ownerDocument!==this.ownerDocument)return!1;if(o===this)return!0;for(;o.parentNode;){if(o.parentNode===this)return!0;o=o.parentNode}return!1}appendChild(o){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(o,l){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(o){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}var Us={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Vs={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Jn={};function Xi(i){if(Jn[i])return Jn[i];var o=globalThis[i],l=o.prototype,c=i in Us?Us[i]:void 0,d=!!(c&&c.every(k=>{var N,X;return!!((X=(N=Object.getOwnPropertyDescriptor(l,k))==null?void 0:N.get)!=null&&X.toString().includes("[native code]"))})),v=i in Vs?Vs[i]:void 0,_=!!(v&&v.every(k=>{var N;return typeof l[k]=="function"&&((N=l[k])==null?void 0:N.toString().includes("[native code]"))}));if(d&&_)return Jn[i]=o.prototype,o.prototype;try{var w=document.createElement("iframe");document.body.appendChild(w);var S=w.contentWindow;if(!S)return o.prototype;var I=S[i].prototype;return document.body.removeChild(w),I?Jn[i]=I:l}catch{return l}}var Ji={};function Cr(i,o,l){var c,d="".concat(i,".").concat(String(l));if(Ji[d])return Ji[d].call(o);var v=Xi(i),_=(c=Object.getOwnPropertyDescriptor(v,l))==null?void 0:c.get;return _?(Ji[d]=_,_.call(o)):o[l]}var Ki={};function zs(i,o,l){var c="".concat(i,".").concat(String(l));if(Ki[c])return Ki[c].bind(o);var d=Xi(i)[l];return typeof d!="function"?o[l]:(Ki[c]=d,d.bind(o))}var Zt={childNodes:function(i){return Cr("Node",i,"childNodes")},parentNode:function(i){return Cr("Node",i,"parentNode")},parentElement:function(i){return Cr("Node",i,"parentElement")},textContent:function(i){return Cr("Node",i,"textContent")},contains:function(i,o){return zs("Node",i,"contains")(o)},getRootNode:function(i){return zs("Node",i,"getRootNode")()},host:function(i){return i&&"host"in i?Cr("ShadowRoot",i,"host"):null},styleSheets:function(i){return i.styleSheets},shadowRoot:function(i){return i&&"shadowRoot"in i?Cr("Element",i,"shadowRoot"):null},querySelector:function(i,o){return Cr("Element",i,"querySelector")(o)},querySelectorAll:function(i,o){return Cr("Element",i,"querySelectorAll")(o)},mutationObserver:function(){return Xi("MutationObserver").constructor}},Kr=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,Qi={map:{},getId:()=>(console.error(Kr),-1),getNode:()=>(console.error(Kr),null),removeNodeFromMap(){console.error(Kr)},has:()=>(console.error(Kr),!1),reset(){console.error(Kr)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(Qi=new Proxy(Qi,{get:(i,o,l)=>(o==="map"&&console.error(Kr),Reflect.get(i,o,l))}));var Ys=Date.now;function Zs(i){return i?i.nodeType===i.ELEMENT_NODE?i:Zt.parentElement(i):null}/[1-9][0-9]{12}/.test(Date.now().toString())||(Ys=()=>new Date().getTime());function Xs(i){var o,l=null;return"getRootNode"in i&&((o=Zt.getRootNode(i))==null?void 0:o.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&Zt.host(Zt.getRootNode(i))&&(l=Zt.host(Zt.getRootNode(i))),l}function Js(i){for(var o,l=i;o=Xs(l);)l=o;return l}function Ks(i){var o=i.ownerDocument;if(!o)return!1;var l=Js(i);return Zt.contains(o,l)}for(var Vu=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){qi(this,"id",1),qi(this,"styleIDMap",new WeakMap),qi(this,"idStyleMap",new Map)}getId(i){var o;return(o=this.styleIDMap.get(i))!==null&&o!==void 0?o:-1}has(i){return this.styleIDMap.has(i)}add(i,o){return this.has(i)?this.getId(i):(l=o===void 0?this.id++:o,this.styleIDMap.set(i,l),this.idStyleMap.set(l,i),l);var l}getStyle(i){return this.idStyleMap.get(i)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return Qi},closestElementOfNode:Zs,getBaseDimension:function i(o,l){var c,d,v=(d=(c=o.ownerDocument)==null?void 0:c.defaultView)==null?void 0:d.frameElement;if(!v||v===l)return{x:0,y:0,relativeScale:1,absoluteScale:1};var _=v.getBoundingClientRect(),w=i(v,l),S=_.height/v.clientHeight;return{x:_.x*w.relativeScale+w.x,y:_.y*w.relativeScale+w.y,relativeScale:S,absoluteScale:w.absoluteScale*S}},getNestedRule:function i(o,l){var c=o[l[0]];return l.length===1?c:i(c.cssRules[l[1]].cssRules,l.slice(2))},getPositionsAndIndex:function(i){var o=[...i],l=o.pop();return{positions:o,index:l}},getRootShadowHost:Js,getShadowHost:Xs,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(i){var o,l,c,d,v=i.document;return{left:v.scrollingElement?v.scrollingElement.scrollLeft:i.pageXOffset!==void 0?i.pageXOffset:v.documentElement.scrollLeft||v?.body&&((o=Zt.parentElement(v.body))==null?void 0:o.scrollLeft)||((l=v?.body)==null?void 0:l.scrollLeft)||0,top:v.scrollingElement?v.scrollingElement.scrollTop:i.pageYOffset!==void 0?i.pageYOffset:v?.documentElement.scrollTop||v?.body&&((c=Zt.parentElement(v.body))==null?void 0:c.scrollTop)||((d=v?.body)==null?void 0:d.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(i){return!!i&&(i instanceof Zi&&"shadowRoot"in i?!!i.shadowRoot:!!Zt.shadowRoot(i))},hookSetter:function i(o,l,c,d){var v=arguments.length>4&&arguments[4]!==void 0?arguments[4]:window,_=v.Object.getOwnPropertyDescriptor(o,l);return v.Object.defineProperty(o,l,d?c:{set(w){setTimeout(()=>{c.set.call(this,w)},0),_&&_.set&&_.set.call(this,w)}}),()=>i(o,l,_||{},!0)},inDom:function(i){var o=i.ownerDocument;return!!o&&(Zt.contains(o,i)||Ks(i))},isAncestorRemoved:function i(o,l){if(d=(c=o)&&"host"in c&&"mode"in c&&Xn.host(c)||null,!!(d&&"shadowRoot"in d&&Xn.shadowRoot(d)===c))return!1;var c,d,v=l.getId(o);if(!l.has(v))return!0;var _=Zt.parentNode(o);return(!_||_.nodeType!==o.DOCUMENT_NODE)&&(!_||i(_,l))},isBlocked:function(i,o,l,c){if(!i)return!1;var d=Zs(i);if(!d)return!1;try{if(typeof o=="string"){if(d.classList.contains(o)||c&&d.closest("."+o)!==null)return!0}else if(Yi(d,o,c))return!0}catch{}return!!(l&&(d.matches(l)||c&&d.closest(l)!==null))},isIgnored:function(i,o,l){return!(i.tagName!=="TITLE"||!l.headTitleMutations)||o.getId(i)===-2},isSerialized:function(i,o){return o.getId(i)!==-1},isSerializedIframe:function(i,o){return!!(i.nodeName==="IFRAME"&&o.getMeta(i))},isSerializedStylesheet:function(i,o){return!!(i.nodeName==="LINK"&&i.nodeType===i.ELEMENT_NODE&&i.getAttribute&&i.getAttribute("rel")==="stylesheet"&&o.getMeta(i))},iterateResolveTree:function i(o,l){l(o.value);for(var c=o.children.length-1;c>=0;c--)i(o.children[c],l)},legacy_isTouchEvent:function(i){return!!i.changedTouches},get nowTimestamp(){return Ys},on:function(i,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,c={capture:!0,passive:!0};return l.addEventListener(i,o,c),()=>l.removeEventListener(i,o,c)},patch:function(i,o,l){try{if(!(o in i))return()=>{};var c=i[o],d=l(c);return typeof d=="function"&&(d.prototype=d.prototype||{},Object.defineProperties(d,{__rrweb_original__:{enumerable:!1,value:c}})),i[o]=d,()=>{i[o]=c}}catch{return()=>{}}},polyfill:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;"NodeList"in i&&!i.NodeList.prototype.forEach&&(i.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in i&&!i.DOMTokenList.prototype.forEach&&(i.DOMTokenList.prototype.forEach=Array.prototype.forEach)},queueToResolveTrees:function(i){var o={},l=(N,X)=>{var B={value:N,parent:X,children:[]};return o[N.node.id]=B,B},c=[];for(var d of i){var{nextId:v,parentId:_}=d;if(v&&v in o){var w=o[v];if(w.parent){var S=w.parent.children.indexOf(w);w.parent.children.splice(S,0,l(d,w.parent))}else{var I=c.indexOf(w);c.splice(I,0,l(d,null))}}else if(_ in o){var k=o[_];k.children.push(l(d,k))}else c.push(l(d,null))}return c},shadowHostInDom:Ks,throttle:function(i,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=null,d=0;return function(){for(var v=arguments.length,_=new Array(v),w=0;w<v;w++)_[w]=arguments[w];var S=Date.now();d||l.leading!==!1||(d=S);var I=o-(S-d),k=this;I<=0||I>o?(c&&(clearTimeout(c),c=null),d=S,i.apply(k,_)):c||l.trailing===!1||(c=setTimeout(()=>{d=l.leading===!1?0:Date.now(),c=null,i.apply(k,_)},I))}},uniqueTextMutations:function(i){for(var o=new Set,l=[],c=i.length;c--;){var d=i[c];o.has(d.id)||(l.push(d),o.add(d.id))}return l}},Symbol.toStringTag,{value:"Module"})),zu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Yu=typeof Uint8Array>"u"?[]:new Uint8Array(256),Kn=0;Kn<64;Kn++)Yu[zu.charCodeAt(Kn)]=Kn;var Qs;typeof window<"u"&&window.Blob&&new Blob([(i=>Uint8Array.from(atob(i),o=>o.charCodeAt(0)))("KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=")],{type:"text/javascript;charset=utf-8"});try{if(Array.from([1],i=>2*i)[0]!==2){var eo=document.createElement("iframe");document.body.appendChild(eo),Array.from=(($s=eo.contentWindow)==null?void 0:$s.Array.from)||Array.from,document.body.removeChild(eo)}}catch(i){console.debug("Unable to override Array.from",i)}new Uu,function(i){i[i.NotStarted=0]="NotStarted",i[i.Running=1]="Running",i[i.Stopped=2]="Stopped"}(Qs||(Qs={}));class Qr{constructor(o){Yn(this,"fileName"),Yn(this,"functionName"),Yn(this,"lineNumber"),Yn(this,"columnNumber"),this.fileName=o.fileName||"",this.functionName=o.functionName||"",this.lineNumber=o.lineNumber,this.columnNumber=o.columnNumber}toString(){var o=this.lineNumber||"",l=this.columnNumber||"";return this.functionName?"".concat(this.functionName," (").concat(this.fileName,":").concat(o,":").concat(l,")"):"".concat(this.fileName,":").concat(o,":").concat(l)}}var Zu=/(^|@)\S+:\d+/,ea=/^\s*at .*(\S+:\d+|\(native\))/m,Xu=/^(eval@)?(\[native code])?$/,to={parse:function(i){return i?i.stacktrace!==void 0||i["opera#sourceloc"]!==void 0?this.parseOpera(i):i.stack&&i.stack.match(ea)?this.parseV8OrIE(i):i.stack?this.parseFFOrSafari(i):(console.warn("[console-record-plugin]: Failed to parse error object:",i),[]):[]},extractLocation:function(i){if(i.indexOf(":")===-1)return[i];var o=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(i.replace(/[()]/g,""));if(!o)throw new Error("Cannot parse given url: ".concat(i));return[o[1],o[2]||void 0,o[3]||void 0]},parseV8OrIE:function(i){return i.stack.split(`
`).filter(function(o){return!!o.match(ea)},this).map(function(o){o.indexOf("(eval ")>-1&&(o=o.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var l=o.replace(/^\s+/,"").replace(/\(eval code/g,"("),c=l.match(/ (\((.+):(\d+):(\d+)\)$)/),d=(l=c?l.replace(c[0],""):l).split(/\s+/).slice(1),v=this.extractLocation(c?c[1]:d.pop()),_=d.join(" ")||void 0,w=["eval","<anonymous>"].indexOf(v[0])>-1?void 0:v[0];return new Qr({functionName:_,fileName:w,lineNumber:v[1],columnNumber:v[2]})},this)},parseFFOrSafari:function(i){return i.stack.split(`
`).filter(function(o){return!o.match(Xu)},this).map(function(o){if(o.indexOf(" > eval")>-1&&(o=o.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),o.indexOf("@")===-1&&o.indexOf(":")===-1)return new Qr({functionName:o});var l=/((.*".+"[^@]*)?[^@]*)(?:@)/,c=o.match(l),d=c&&c[1]?c[1]:void 0,v=this.extractLocation(o.replace(l,""));return new Qr({functionName:d,fileName:v[0],lineNumber:v[1],columnNumber:v[2]})},this)},parseOpera:function(i){return!i.stacktrace||i.message.indexOf(`
`)>-1&&i.message.split(`
`).length>i.stacktrace.split(`
`).length?this.parseOpera9(i):i.stack?this.parseOpera11(i):this.parseOpera10(i)},parseOpera9:function(i){for(var o=/Line (\d+).*script (?:in )?(\S+)/i,l=i.message.split(`
`),c=[],d=2,v=l.length;d<v;d+=2){var _=o.exec(l[d]);_&&c.push(new Qr({fileName:_[2],lineNumber:parseFloat(_[1])}))}return c},parseOpera10:function(i){for(var o=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,l=i.stacktrace.split(`
`),c=[],d=0,v=l.length;d<v;d+=2){var _=o.exec(l[d]);_&&c.push(new Qr({functionName:_[3]||void 0,fileName:_[2],lineNumber:parseFloat(_[1])}))}return c},parseOpera11:function(i){return i.stack.split(`
`).filter(function(o){return!!o.match(Zu)&&!o.match(/^Error created at/)},this).map(function(o){var l=o.split("@"),c=this.extractLocation(l.pop()),d=(l.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new Qr({functionName:d,fileName:c[0],lineNumber:c[1],columnNumber:c[2]})},this)}};function Ju(i){if(!i||!i.outerHTML)return"";for(var o="";i.parentElement;){var l=i.localName;if(!l)break;l=l.toLowerCase();var c=i.parentElement,d=[];if(c.children&&c.children.length>0)for(var v=0;v<c.children.length;v++){var _=c.children[v];_.localName&&_.localName.toLowerCase&&_.localName.toLowerCase()===l&&d.push(_)}d.length>1&&(l+=":eq(".concat(d.indexOf(i),")")),o=l+(o?">"+o:""),i=c}return o}function ro(i){return Object.prototype.toString.call(i)==="[object Object]"}function ta(i,o){if(o===0)return!0;var l=Object.keys(i);for(var c of l)if(ro(i[c])&&ta(i[c],o-1))return!0;return!1}function en(i,o){var l={numOfKeysLimit:50,depthOfLimit:4};Object.assign(l,o);var c=[],d=[];return JSON.stringify(i,function(v,_){if(c.length>0){var w=c.indexOf(this);~w?c.splice(w+1):c.push(this),~w?d.splice(w,1/0,v):d.push(v),~c.indexOf(_)&&(_=c[0]===_?"[Circular ~]":"[Circular ~."+d.slice(0,c.indexOf(_)).join(".")+"]")}else c.push(_);if(_===null)return _;if(_===void 0)return"undefined";if(function(N){return!!(ro(N)&&Object.keys(N).length>l.numOfKeysLimit||typeof N=="function"||ro(N)&&ta(N,l.depthOfLimit))}(_))return function(N){var X=N.toString();return l.stringLengthLimit&&X.length>l.stringLengthLimit&&(X="".concat(X.slice(0,l.stringLengthLimit),"...")),X}(_);if(typeof _=="bigint")return _.toString()+"n";if(_ instanceof Event){var S={};for(var I in _){var k=_[I];Array.isArray(k)?S[I]=Ju(k.length?k[0]:null):S[I]=k}return S}return _ instanceof Node?_ instanceof HTMLElement?_?_.outerHTML:"":_.nodeName:_ instanceof Error?_.stack?_.stack+`
End of stack for Error object`:_.name+": "+_.message:_})}var ra={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Ku(i,o,l){var c,d=l?Object.assign({},ra,l):ra,v=d.logger;if(!v)return()=>{};c=typeof v=="string"?o[v]:v;var _=0,w=!1,S=[];if(d.level.includes("error")){var I=B=>{var ne=B.message,de=B.error,ie=to.parse(de).map(A=>A.toString()),F=[en(ne,d.stringifyOptions)];i({level:"error",trace:ie,payload:F})};o.addEventListener("error",I),S.push(()=>{o.removeEventListener("error",I)});var k=B=>{var ne,de;B.reason instanceof Error?(ne=B.reason,de=[en("Uncaught (in promise) ".concat(ne.name,": ").concat(ne.message),d.stringifyOptions)]):(ne=new Error,de=[en("Uncaught (in promise)",d.stringifyOptions),en(B.reason,d.stringifyOptions)]);var ie=to.parse(ne).map(F=>F.toString());i({level:"error",trace:ie,payload:de})};o.addEventListener("unhandledrejection",k),S.push(()=>{o.removeEventListener("unhandledrejection",k)})}for(var N of d.level)S.push(X(c,N));return()=>{S.forEach(B=>B())};function X(B,ne){var de=this;return B[ne]?Vu.patch(B,ne,ie=>function(){for(var F=arguments.length,A=new Array(F),R=0;R<F;R++)A[R]=arguments[R];if(ie.apply(de,A),!(ne==="assert"&&A[0]||w)){w=!0;try{var G=to.parse(new Error).map(Q=>Q.toString()).splice(1),K=(ne==="assert"?A.slice(1):A).map(Q=>en(Q,d.stringifyOptions));++_<d.lengthThreshold?i({level:ne,trace:G,payload:K}):_===d.lengthThreshold&&i({level:"warn",trace:[],payload:[en("The number of log records reached the threshold.")]})}catch(Q){ie("rrweb logger error:",Q,...A)}finally{w=!1}}}):()=>{}}}var na=i=>({name:"rrweb/console@1",observer:Ku,options:i}),dr=typeof window<"u"?window:void 0,Dt=typeof globalThis<"u"?globalThis:dr,ia=Array.prototype.forEach,oa=Dt?.navigator;Dt?.document,Dt?.location,Dt?.fetch,Dt!=null&&Dt.XMLHttpRequest&&"withCredentials"in new Dt.XMLHttpRequest&&Dt.XMLHttpRequest,Dt?.AbortController,oa?.userAgent;var sa,Er=dr??{};(function(i){i.GZipJS="gzip-js",i.Base64="base64"})(sa||(sa={}));var Qu=Array.isArray,aa=Object.prototype,ec=aa.hasOwnProperty,no=aa.toString,Qn=Qu||function(i){return no.call(i)==="[object Array]"},tc=i=>typeof i=="function",rc=i=>i===Object(i)&&!Qn(i),kr=i=>i===void 0,nc=i=>no.call(i)=="[object String]",io=i=>i===null,la=i=>kr(i)||io(i),oo=i=>no.call(i)==="[object Boolean]",ic=i=>i instanceof Document,ua=i=>i instanceof FormData,ca=i=>{var o={_log:function(l){if(dr&&Er.POSTHOG_DEBUG&&!kr(dr.console)&&dr.console){for(var c=("__rrweb_original__"in dr.console[l])?dr.console[l].__rrweb_original__:dr.console[l],d=arguments.length,v=new Array(d>1?d-1:0),_=1;_<d;_++)v[_-1]=arguments[_];c(i,...v)}},info:function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];o._log("log",...c)},warn:function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];o._log("warn",...c)},error:function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];o._log("error",...c)},critical:function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];console.error(i,...c)},uninitializedWarning:l=>{o.error("You must initialize PostHog before calling ".concat(l))},createLogger:l=>ca("".concat(i," ").concat(l))};return o},oc=ca("[PostHog.js]").createLogger,so={};function sc(i,o,l){if(!la(i)){if(Qn(i))return function(v,_,w){if(Qn(v)){if(ia&&v.forEach===ia)v.forEach(_,w);else if("length"in v&&v.length===+v.length){for(var S=0,I=v.length;S<I;S++)if(S in v&&_.call(w,v[S],S)===so)return}}}(i,o,l);if(ua(i)){for(var c of i.entries())if(o.call(l,c[1],c[0])===so)return}else for(var d in i)if(ec.call(i,d)&&o.call(l,i[d],d)===so)return}}var ac=function(i){var o,l,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",d=[];return sc(i,function(v,_){kr(v)||kr(_)||_==="undefined"||(o=encodeURIComponent(v instanceof File?v.name:v.toString()),l=encodeURIComponent(_),d[d.length]=l+"="+o)}),d.join(c)},da={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:i=>i,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com"]};function ha(i,o,l){try{if(!(o in i))return()=>{};var c=i[o],d=l(c);return tc(d)&&(d.prototype=d.prototype||{},Object.defineProperties(d,{__posthog_wrapped__:{enumerable:!1,value:!0}})),i[o]=d,()=>{i[o]=c}}catch{return()=>{}}}function ao(i,o){var l,c=function(_){try{return typeof _=="string"?new URL(_).hostname:"url"in _?new URL(_.url).hostname:_.hostname}catch{return null}}(i),d={hostname:c,isHostDenied:!1};if((l=o.payloadHostDenyList)===null||l===void 0||!l.length||c==null||!c.trim().length)return d;for(var v of o.payloadHostDenyList)if(c.endsWith(v))return{hostname:c,isHostDenied:!0};return d}var pa=oc("[Recorder]"),ga=i=>i.entryType==="navigation",lo=i=>i.entryType==="resource";function fa(i,o){for(var l=i.length-1;l>=0;l-=1)if(o(i[l]))return i[l]}function lc(i,o,l){if(l.recordInitialRequests){var c=o.performance.getEntries().filter(_=>ga(_)||lo(_)&&l.initiatorTypes.includes(_.initiatorType));i({requests:c.flatMap(_=>ri({entry:_,method:void 0,status:void 0,networkRequest:{},isInitial:!0})),isInitial:!0})}var d=new o.PerformanceObserver(_=>{var w=_.getEntries().filter(S=>ga(S)||lo(S)&&l.initiatorTypes.includes(S.initiatorType)&&(I=>!l.recordBody&&!l.recordHeaders||I.initiatorType!=="xmlhttprequest"&&I.initiatorType!=="fetch")(S));i({requests:w.flatMap(S=>ri({entry:S,method:void 0,status:void 0,networkRequest:{}}))})}),v=PerformanceObserver.supportedEntryTypes.filter(_=>l.performanceEntryTypeToObserve.includes(_));return d.observe({entryTypes:v}),()=>{d.disconnect()}}function ei(i,o){return!!o&&(oo(o)||o[i])}function ti(i){var{type:o,recordBody:l,headers:c}=i;function d(_){var w=Object.keys(c).find(I=>I.toLowerCase()==="content-type"),S=w&&c[w];return _.some(I=>S?.includes(I))}if(!l)return!1;if(oo(l))return!0;if(Qn(l))return d(l);var v=l[o];return oo(v)?v:d(v)}function uo(i,o,l,c,d){return co.apply(this,arguments)}function co(){return co=s(function*(i,o,l,c,d){var v=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(v>10)return pa.warn("Failed to get performance entry for request",{url:l,initiatorType:o}),null;var _=fa(i.performance.getEntriesByName(l),w=>lo(w)&&w.initiatorType===o&&(kr(c)||w.startTime>=c)&&(kr(d)||w.startTime<=d));return _||(yield new Promise(w=>setTimeout(w,50*v)),uo(i,o,l,c,d,v+1))}),co.apply(this,arguments)}function va(i){var{body:o,options:l,url:c}=i;if(la(o))return null;var{hostname:d,isHostDenied:v}=ao(c,l);if(v)return d+" is in deny list";if(nc(o))return o;if(ic(o))return o.textContent;if(ua(o))return ac(o);if(rc(o))try{return JSON.stringify(o)}catch{return"[SessionReplay] Failed to stringify response object"}return"[SessionReplay] Cannot read body of type "+toString.call(o)}var uc=i=>!io(i)&&(i.entryType==="navigation"||i.entryType==="resource");function ri(i){var{entry:o,method:l,status:c,networkRequest:d,isInitial:v,start:_,end:w,url:S,initiatorType:I}=i;_=o?o.startTime:_,w=o?o.responseEnd:w;var k=Math.floor(Date.now()-performance.now()),N=Math.floor(k+(_||0)),X=[t(t({},o?o.toJSON():{name:S}),{},{startTime:kr(_)?void 0:Math.round(_),endTime:kr(w)?void 0:Math.round(w),timeOrigin:k,timestamp:N,method:l,initiatorType:I||(o?o.initiatorType:void 0),status:c,requestHeaders:d.requestHeaders,requestBody:d.requestBody,responseHeaders:d.responseHeaders,responseBody:d.responseBody,isInitial:v})];if(uc(o))for(var B of o.serverTiming||[])X.push({timeOrigin:k,timestamp:N,startTime:Math.round(o.startTime),name:B.name,duration:B.duration,entryType:"serverTiming"});return X}var cc=["video/","audio/"];function ma(i){return new Promise((o,l)=>{var c=setTimeout(()=>o("[SessionReplay] Timeout while trying to read body"),500);try{i.clone().text().then(d=>o(d),d=>l(d)).finally(()=>clearTimeout(c))}catch{clearTimeout(c),o("[SessionReplay] Failed to read body")}})}function _a(){return(_a=s(function*(i){var{r:o,options:l,url:c}=i,{hostname:d,isHostDenied:v}=ao(c,l);return v?Promise.resolve(d+" is in deny list"):ma(o)})).apply(this,arguments)}function ya(){return(ya=s(function*(i){var{r:o,options:l,url:c}=i,d=function(v){var _,{r:w,options:S,url:I}=v;if(w.headers.get("Transfer-Encoding")==="chunked")return"Chunked Transfer-Encoding is not supported";var k=(_=w.headers.get("Content-Type"))===null||_===void 0?void 0:_.toLowerCase(),N=cc.some(ne=>k?.startsWith(ne));if(k&&N)return"Content-Type ".concat(k," is not supported");var{hostname:X,isHostDenied:B}=ao(I,S);return B?X+" is in deny list":null}({r:o,options:l,url:c});return io(d)?ma(o):Promise.resolve(d)})).apply(this,arguments)}function dc(i,o,l){if(!l.initiatorTypes.includes("fetch"))return()=>{};var c=ei("request",l.recordHeaders),d=ei("response",l.recordHeaders),v=ha(o,"fetch",_=>function(){var w=s(function*(S,I){var k,N,X,B=new Request(S,I),ne={};try{var de={};B.headers.forEach((F,A)=>{de[A]=F}),c&&(ne.requestHeaders=de),ti({type:"request",headers:de,url:S,recordBody:l.recordBody})&&(ne.requestBody=yield function(F){return _a.apply(this,arguments)}({r:B,options:l,url:S})),N=o.performance.now(),k=yield _(B),X=o.performance.now();var ie={};return k.headers.forEach((F,A)=>{ie[A]=F}),d&&(ne.responseHeaders=ie),ti({type:"response",headers:ie,url:S,recordBody:l.recordBody})&&(ne.responseBody=yield function(F){return ya.apply(this,arguments)}({r:k,options:l,url:S})),k}finally{uo(o,"fetch",B.url,N,X).then(F=>{var A,R=ri({entry:F,method:B.method,status:(A=k)===null||A===void 0?void 0:A.status,networkRequest:ne,start:N,end:X,url:B.url,initiatorType:"fetch"});i({requests:R})}).catch(()=>{})}});return function(S,I){return w.apply(this,arguments)}}());return()=>{v()}}var ba=null;function hc(i,o,l){if(!("performance"in o))return()=>{};if(ba)return pa.warn("Network observer already initialised, doing nothing"),()=>{};var c=l?Object.assign({},da,l):da,d=S=>{var I=[];S.requests.forEach(k=>{var N=c.maskRequestFn(k);N&&I.push(N)}),I.length>0&&i(t(t({},S),{},{requests:I}))},v=lc(d,o,c),_=()=>{},w=()=>{};return(c.recordHeaders||c.recordBody)&&(_=function(S,I,k){if(!k.initiatorTypes.includes("xmlhttprequest"))return()=>{};var N=ei("request",k.recordHeaders),X=ei("response",k.recordHeaders),B=ha(I.XMLHttpRequest.prototype,"open",ne=>function(de,ie){var F,A,R=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],G=arguments.length>3?arguments[3]:void 0,K=arguments.length>4?arguments[4]:void 0,Q=this,ee=new Request(ie),re={},ce={},ge=Q.setRequestHeader.bind(Q);Q.setRequestHeader=(Y,Te)=>(ce[Y]=Te,ge(Y,Te)),N&&(re.requestHeaders=ce);var ke=Q.send.bind(Q);Q.send=Y=>(ti({type:"request",headers:ce,url:ie,recordBody:k.recordBody})&&(re.requestBody=va({body:Y,options:k,url:ie})),F=I.performance.now(),ke(Y)),Q.addEventListener("readystatechange",()=>{if(Q.readyState===Q.DONE){A=I.performance.now();var Y={};Q.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(Te=>{var _e=Te.split(": "),ye=_e.shift(),ve=_e.join(": ");ye&&(Y[ye]=ve)}),X&&(re.responseHeaders=Y),ti({type:"response",headers:Y,url:ie,recordBody:k.recordBody})&&(re.responseBody=va({body:Q.response,options:k,url:ie})),uo(I,"xmlhttprequest",ee.url,F,A).then(Te=>{var _e=ri({entry:Te,method:de,status:Q?.status,networkRequest:re,start:F,end:A,url:ie.toString(),initiatorType:"xmlhttprequest"});S({requests:_e})}).catch(()=>{})}}),ne.call(Q,de,ie,R,G,K)});return()=>{B()}}(d,o,c),w=dc(d,o,c)),ba=()=>{v(),_(),w()}}var wa="rrweb/network@1",ho=i=>({name:wa,observer:hc,options:i});Er.__PosthogExtensions__=Er.__PosthogExtensions__||{},Er.__PosthogExtensions__.rrwebPlugins={getRecordConsolePlugin:na,getRecordNetworkPlugin:ho},Er.__PosthogExtensions__.rrweb={record:Nr,version:"v2"},Er.rrweb={record:Nr,version:"v2"},Er.rrwebConsoleRecord={getRecordConsolePlugin:na},Er.getRecordNetworkPlugin=ho,n.NETWORK_PLUGIN_NAME=wa,n.default=Nr,n.findLast=fa,n.getRecordNetworkPlugin=ho,Object.defineProperty(n,"__esModule",{value:!0})})({});(function(){function n(O,x){var D=Object.keys(O);if(Object.getOwnPropertySymbols){var W=Object.getOwnPropertySymbols(O);x&&(W=W.filter(function(J){return Object.getOwnPropertyDescriptor(O,J).enumerable})),D.push.apply(D,W)}return D}function e(O){for(var x=1;x<arguments.length;x++){var D=arguments[x]!=null?arguments[x]:{};x%2?n(Object(D),!0).forEach(function(W){t(O,W,D[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(O,Object.getOwnPropertyDescriptors(D)):n(Object(D)).forEach(function(W){Object.defineProperty(O,W,Object.getOwnPropertyDescriptor(D,W))})}return O}function t(O,x,D){return x in O?Object.defineProperty(O,x,{value:D,enumerable:!0,configurable:!0,writable:!0}):O[x]=D,O}var r=typeof window<"u"?window:void 0,s=typeof globalThis<"u"?globalThis:r,a=s?.navigator;s?.document,s?.location,s?.fetch,s!=null&&s.XMLHttpRequest&&"withCredentials"in new s.XMLHttpRequest&&s.XMLHttpRequest,s?.AbortController,a?.userAgent;var u,h=r??{};(function(O){O.GZipJS="gzip-js",O.Base64="base64"})(u||(u={}));var p=["fatal","error","warning","log","info","debug"],m=Array.isArray,g=Object.prototype.toString,f=m||function(O){return g.call(O)==="[object Array]"},b=O=>typeof O=="function",y=O=>O===Object(O)&&!f(O),E=O=>O===void 0,T=O=>g.call(O)=="[object String]",z=O=>T(O)&&O.trim().length===0,j=O=>O===null;function $(O){return!E(Event)&&ae(O,Event)}function ae(O,x){try{return O instanceof x}catch{return!1}}function oe(O){return j(O)||!y(O)&&!b(O)}function Se(O,x){return Object.prototype.toString.call(O)==="[object ".concat(x,"]")}function qe(O){return Se(O,"DOMError")}var be=/\(error: (.*)\)/,Ce=50,Re="?";function je(O,x,D,W){var J={platform:"web:javascript",filename:O,function:x==="<anonymous>"?Re:x,in_app:!0};return E(D)||(J.lineno=D),E(W)||(J.colno=W),J}var rt=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,ct=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,pt=/\((\S*)(?::(\d+))(?::(\d+))\)/,wt=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,_t=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ye=function(){for(var O=arguments.length,x=new Array(O),D=0;D<O;D++)x[D]=arguments[D];var W=x.sort((J,Ee)=>J[0]-Ee[0]).map(J=>J[1]);return function(J){for(var Ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,me=[],ze=J.split(`
`),Pe=Ee;Pe<ze.length;Pe++){var nt=ze[Pe];if(!(nt.length>1024)){var M=be.test(nt)?nt.replace(be,"$1"):nt;if(!M.match(/\S*Error: /)){for(var Z of W){var L=Z(M);if(L){me.push(L);break}}if(me.length>=Ce)break}}}return function(q){if(!q.length)return[];var H=Array.from(q);return H.reverse(),H.slice(0,Ce).map(le=>e(e({},le),{},{filename:le.filename||gt(H).filename,function:le.function||Re}))}(me)}}([30,O=>{var x=rt.exec(O);if(x){var[,D,W,J]=x;return je(D,Re,+W,+J)}var Ee=ct.exec(O);if(Ee){if(Ee[2]&&Ee[2].indexOf("eval")===0){var me=pt.exec(Ee[2]);me&&(Ee[2]=me[1],Ee[3]=me[2],Ee[4]=me[3])}var[ze,Pe]=St(Ee[1]||Re,Ee[2]);return je(Pe,ze,Ee[3]?+Ee[3]:void 0,Ee[4]?+Ee[4]:void 0)}}],[50,O=>{var x=wt.exec(O);if(x){if(x[3]&&x[3].indexOf(" > eval")>-1){var D=_t.exec(x[3]);D&&(x[1]=x[1]||"eval",x[3]=D[1],x[4]=D[2],x[5]="")}var W=x[3],J=x[1]||Re;return[J,W]=St(J,W),je(W,J,x[4]?+x[4]:void 0,x[5]?+x[5]:void 0)}}]);function gt(O){return O[O.length-1]||{}}var St=(O,x)=>{var D=O.indexOf("safari-extension")!==-1,W=O.indexOf("safari-web-extension")!==-1;return D||W?[O.indexOf("@")!==-1?O.split("@")[0]:Re,D?"safari-extension:".concat(x):"safari-web-extension:".concat(x)]:[O,x]},It=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function Ct(O){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=O.stacktrace||O.stack||"",W=function(Ee){return Ee&&zt.test(Ee.message)?1:0}(O);try{var J=Ye(D,W);return J.slice(0,J.length-x)}catch{}return[]}var zt=/Minified React error #\d+;/i;function et(O,x){var D,W,J=Ct(O),Ee=(D=x?.handled)===null||D===void 0||D,me=(W=x?.synthetic)!==null&&W!==void 0&&W;return{$exception_list:[{type:x!=null&&x.overrideExceptionType?x.overrideExceptionType:O.name,value:x!=null&&x.overrideExceptionMessage?x.overrideExceptionMessage:function(ze){var Pe=ze.message;return Pe.error&&typeof Pe.error.message=="string"?Pe.error.message:Pe}(O),stacktrace:{frames:J,type:"raw"},mechanism:{handled:Ee,synthetic:me}}],$exception_level:"error"}}function st(O,x){var D,W,J,Ee=(D=x?.handled)===null||D===void 0||D,me=(W=x?.synthetic)===null||W===void 0||W,ze={type:x!=null&&x.overrideExceptionType?x.overrideExceptionType:(J=x?.defaultExceptionType)!==null&&J!==void 0?J:"Error",value:x!=null&&x.overrideExceptionMessage?x.overrideExceptionMessage:O||x?.defaultExceptionMessage,mechanism:{handled:Ee,synthetic:me}};if(x!=null&&x.syntheticException){var Pe=Ct(x.syntheticException,1);Pe.length&&(ze.stacktrace={frames:Pe,type:"raw"})}return{$exception_list:[ze],$exception_level:"error"}}function Ze(O,x){var D,W,J,Ee=(D=x?.handled)===null||D===void 0||D,me=(W=x?.synthetic)===null||W===void 0||W,ze=x!=null&&x.overrideExceptionType?x.overrideExceptionType:$(O)?O.constructor.name:"Error",Pe=x!=null&&x.overrideExceptionMessage?x.overrideExceptionMessage:"Non-Error ".concat("exception"," captured with keys: ",function(Z){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:40,q=Object.keys(Z);if(q.sort(),!q.length)return"[object has no keys]";for(var H=q.length;H>0;H--){var le=q.slice(0,H).join(", ");if(!(le.length>L))return H===q.length||le.length<=L?le:"".concat(le.slice(0,L),"...")}return""}(O)),nt={type:ze,value:Pe,mechanism:{handled:Ee,synthetic:me}};if(x!=null&&x.syntheticException){var M=Ct(x?.syntheticException,1);M.length&&(nt.stacktrace={frames:M,type:"raw"})}return{$exception_list:[nt],$exception_level:(J=O.level,T(J)&&!z(J)&&p.indexOf(J)>=0?O.level:"error")}}function Xe(O,x){var[D,W,J,Ee,me]=O,ze={$exception_list:[]},Pe=me||D;if(qe(Pe)||function(ue){return Se(ue,"DOMException")}(Pe)){var nt=Pe;if(function(ue){return"stack"in ue}(Pe))ze=et(Pe,x);else{var M=nt.name||(qe(nt)?"DOMError":"DOMException"),Z=nt.message?"".concat(M,": ").concat(nt.message):M,L=qe(nt)?"DOMError":"DOMException";ze=st(Z,e(e({},x),{},{overrideExceptionType:L,defaultExceptionMessage:Z}))}return"code"in nt&&(ze.$exception_DOMException_code="".concat(nt.code)),ze}if(function(ue){return Se(ue,"ErrorEvent")}(Pe)&&Pe.error)return et(Pe.error,x);if(function(ue){switch(Object.prototype.toString.call(ue)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object DOMError]":return!0;default:return ae(ue,Error)}}(Pe))return et(Pe,x);if(function(ue){return Se(ue,"Object")}(Pe)||$(Pe))return Ze(Pe,x);if(E(me)&&T(D)){var q="Error",H=D,le=D.match(It);return le&&(q=le[1],H=le[2]),st(H,e(e({},x),{},{overrideExceptionType:q,defaultExceptionMessage:H}))}return st(Pe,x)}function Et(O){var[x]=O,D=function(W){if(oe(W))return W;try{if("reason"in W)return W.reason;if("detail"in W&&"reason"in W.detail)return W.detail.reason}catch{}return W}(x);return oe(D)?st("Non-Error promise rejection captured with value: ".concat(String(D)),{handled:!1,synthetic:!1,overrideExceptionType:"UnhandledRejection"}):Xe([D],{handled:!1,overrideExceptionType:"UnhandledRejection",defaultExceptionMessage:String(D)})}var Gt=O=>{var x={_log:function(D){if(r&&h.POSTHOG_DEBUG&&!E(r.console)&&r.console){for(var W=("__rrweb_original__"in r.console[D])?r.console[D].__rrweb_original__:r.console[D],J=arguments.length,Ee=new Array(J>1?J-1:0),me=1;me<J;me++)Ee[me-1]=arguments[me];W(O,...Ee)}},info:function(){for(var D=arguments.length,W=new Array(D),J=0;J<D;J++)W[J]=arguments[J];x._log("log",...W)},warn:function(){for(var D=arguments.length,W=new Array(D),J=0;J<D;J++)W[J]=arguments[J];x._log("warn",...W)},error:function(){for(var D=arguments.length,W=new Array(D),J=0;J<D;J++)W[J]=arguments[J];x._log("error",...W)},critical:function(){for(var D=arguments.length,W=new Array(D),J=0;J<D;J++)W[J]=arguments[J];console.error(O,...W)},uninitializedWarning:D=>{x.error("You must initialize PostHog before calling ".concat(D))},createLogger:D=>Gt("".concat(O," ").concat(D))};return x},sr=(0,Gt("[PostHog.js]").createLogger)("[ExceptionAutocapture]"),Yt={wrapOnError:O=>{var x=r;x||sr.info("window not available, cannot wrap onerror");var D=x.onerror;return x.onerror=function(){for(var W,J=arguments.length,Ee=new Array(J),me=0;me<J;me++)Ee[me]=arguments[me];var ze=Xe(Ee);return O(ze),(W=D?.(...Ee))!==null&&W!==void 0&&W},x.onerror.__POSTHOG_INSTRUMENTED__=!0,()=>{var W;(W=x.onerror)===null||W===void 0||delete W.__POSTHOG_INSTRUMENTED__,x.onerror=D}},wrapUnhandledRejection:O=>{var x=r;x||sr.info("window not available, cannot wrap onUnhandledRejection");var D=x.onunhandledrejection;return x.onunhandledrejection=function(){for(var W,J=arguments.length,Ee=new Array(J),me=0;me<J;me++)Ee[me]=arguments[me];var ze=Et(Ee);return O(ze),(W=D?.apply(x,Ee))!==null&&W!==void 0&&W},x.onunhandledrejection.__POSTHOG_INSTRUMENTED__=!0,()=>{var W;(W=x.onunhandledrejection)===null||W===void 0||delete W.__POSTHOG_INSTRUMENTED__,x.onunhandledrejection=D}}};h.__PosthogExtensions__=h.__PosthogExtensions__||{},h.__PosthogExtensions__.errorWrappingFunctions=Yt,h.__PosthogExtensions__.parseErrorAsProperties=Xe,h.posthogErrorWrappingFunctions=Yt,h.parseErrorAsProperties=Xe})();(function(){function n(m,g,f,b,y,E,T){try{var z=m[E](T),j=z.value}catch($){return void f($)}z.done?g(j):Promise.resolve(j).then(b,y)}var e=typeof window<"u"?window:void 0,t=typeof globalThis<"u"?globalThis:e,r=t?.navigator;t?.document,t?.location,t?.fetch,t!=null&&t.XMLHttpRequest&&"withCredentials"in new t.XMLHttpRequest&&t.XMLHttpRequest,t?.AbortController,r?.userAgent;var s,a=e??{};(function(m){m.GZipJS="gzip-js",m.Base64="base64"})(s||(s={}));function u(m,g,f){try{if(!(g in m))return()=>{};var b=m[g],y=f(b);return typeof y=="function"&&(y.prototype=y.prototype||{},Object.defineProperties(y,{__posthog_wrapped__:{enumerable:!1,value:!0}})),m[g]=y,()=>{m[g]=b}}catch{return()=>{}}}var h=(m,g)=>{if(m){var{sessionId:f,windowId:b}=m.checkAndGetSessionAndWindowId(!0);g.headers.set("X-POSTHOG-SESSION-ID",f),g.headers.set("X-POSTHOG-WINDOW-ID",b)}};a.__PosthogExtensions__=a.__PosthogExtensions__||{};var p={_patchFetch:m=>u(e,"fetch",g=>function(){var f,b=(f=function*(y,E){var T=new Request(y,E);return h(m,T),g(T)},function(){var y=this,E=arguments;return new Promise(function(T,z){var j=f.apply(y,E);function $(oe){n(j,T,z,$,ae,"next",oe)}function ae(oe){n(j,T,z,$,ae,"throw",oe)}$(void 0)})});return function(y,E){return b.apply(this,arguments)}}()),_patchXHR:m=>u(e.XMLHttpRequest.prototype,"open",g=>function(f,b){var y=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],E=arguments.length>3?arguments[3]:void 0,T=arguments.length>4?arguments[4]:void 0,z=new Request(b);return h(m,z),g.call(this,f,z.url,y,E,T)})};a.__PosthogExtensions__.tracingHeadersPatchFns=p,a.postHogTracingHeadersPatchFns=p})();(function(){var n,e,t,r=function(){var M=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(M&&M.responseStart>0&&M.responseStart<performance.now())return M},s=function(M){if(document.readyState==="loading")return"loading";var Z=r();if(Z){if(M<Z.domInteractive)return"loading";if(Z.domContentLoadedEventStart===0||M<Z.domContentLoadedEventStart)return"dom-interactive";if(Z.domComplete===0||M<Z.domComplete)return"dom-content-loaded"}return"complete"},a=function(M){var Z=M.nodeName;return M.nodeType===1?Z.toLowerCase():Z.toUpperCase().replace(/^#/,"")},u=function(M,Z){var L="";try{for(;M&&M.nodeType!==9;){var q=M,H=q.id?"#"+q.id:a(q)+(q.classList&&q.classList.value&&q.classList.value.trim()&&q.classList.value.trim().length?"."+q.classList.value.trim().replace(/\s+/g,"."):"");if(L.length+H.length>(Z||100)-1)return L||H;if(L=L?H+">"+L:H,q.id)break;M=q.parentNode}}catch{}return L},h=-1,p=function(){return h},m=function(M){addEventListener("pageshow",function(Z){Z.persisted&&(h=Z.timeStamp,M(Z))},!0)},g=function(){var M=r();return M&&M.activationStart||0},f=function(M,Z){var L=r(),q="navigate";return p()>=0?q="back-forward-cache":L&&(document.prerendering||g()>0?q="prerender":document.wasDiscarded?q="restore":L.type&&(q=L.type.replace(/_/g,"-"))),{name:M,value:Z===void 0?-1:Z,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:q}},b=function(M,Z,L){try{if(PerformanceObserver.supportedEntryTypes.includes(M)){var q=new PerformanceObserver(function(H){Promise.resolve().then(function(){Z(H.getEntries())})});return q.observe(Object.assign({type:M,buffered:!0},L||{})),q}}catch{}},y=function(M,Z,L,q){var H,le;return function(ue){Z.value>=0&&(ue||q)&&((le=Z.value-(H||0))||H===void 0)&&(H=Z.value,Z.delta=le,Z.rating=function(we,Me){return we>Me[1]?"poor":we>Me[0]?"needs-improvement":"good"}(Z.value,L),M(Z))}},E=function(M){requestAnimationFrame(function(){return requestAnimationFrame(function(){return M()})})},T=function(M){document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&M()})},z=function(M){var Z=!1;return function(){Z||(M(),Z=!0)}},j=-1,$=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},ae=function(M){document.visibilityState==="hidden"&&j>-1&&(j=M.type==="visibilitychange"?M.timeStamp:0,Se())},oe=function(){addEventListener("visibilitychange",ae,!0),addEventListener("prerenderingchange",ae,!0)},Se=function(){removeEventListener("visibilitychange",ae,!0),removeEventListener("prerenderingchange",ae,!0)},qe=function(){return j<0&&(j=$(),oe(),m(function(){setTimeout(function(){j=$(),oe()},0)})),{get firstHiddenTime(){return j}}},be=function(M){document.prerendering?addEventListener("prerenderingchange",function(){return M()},!0):M()},Ce=[1800,3e3],Re=function(M,Z){Z=Z||{},be(function(){var L,q=qe(),H=f("FCP"),le=b("paint",function(ue){ue.forEach(function(we){we.name==="first-contentful-paint"&&(le.disconnect(),we.startTime<q.firstHiddenTime&&(H.value=Math.max(we.startTime-g(),0),H.entries.push(we),L(!0)))})});le&&(L=y(M,H,Ce,Z.reportAllChanges),m(function(ue){H=f("FCP"),L=y(M,H,Ce,Z.reportAllChanges),E(function(){H.value=performance.now()-ue.timeStamp,L(!0)})}))})},je=[.1,.25],rt=0,ct=1/0,pt=0,wt=function(M){M.forEach(function(Z){Z.interactionId&&(ct=Math.min(ct,Z.interactionId),pt=Math.max(pt,Z.interactionId),rt=pt?(pt-ct)/7+1:0)})},_t=function(){"interactionCount"in performance||n||(n=b("event",wt,{type:"event",buffered:!0,durationThreshold:0}))},Ye=[],gt=new Map,St=0,It=function(){return(n?rt:performance.interactionCount||0)-St},Ct=[],zt=function(M){if(Ct.forEach(function(H){return H(M)}),M.interactionId||M.entryType==="first-input"){var Z=Ye[Ye.length-1],L=gt.get(M.interactionId);if(L||Ye.length<10||M.duration>Z.latency){if(L)M.duration>L.latency?(L.entries=[M],L.latency=M.duration):M.duration===L.latency&&M.startTime===L.entries[0].startTime&&L.entries.push(M);else{var q={id:M.interactionId,latency:M.duration,entries:[M]};gt.set(q.id,q),Ye.push(q)}Ye.sort(function(H,le){return le.latency-H.latency}),Ye.length>10&&Ye.splice(10).forEach(function(H){return gt.delete(H.id)})}}},et=function(M){var Z=self.requestIdleCallback||self.setTimeout,L=-1;return M=z(M),document.visibilityState==="hidden"?M():(L=Z(M),T(M)),L},st=[200,500],Ze=[],Xe=[],Et=new WeakMap,Gt=new Map,sr=-1,Yt=function(M){Ze=Ze.concat(M),O()},O=function(){sr<0&&(sr=et(x))},x=function(){Gt.size>10&&Gt.forEach(function(we,Me){gt.has(Me)||Gt.delete(Me)});var M=Ye.map(function(we){return Et.get(we.entries[0])}),Z=Xe.length-50;Xe=Xe.filter(function(we,Me){return Me>=Z||M.includes(we)});for(var L=new Set,q=0;q<Xe.length;q++){var H=Xe[q];D(H.startTime,H.processingEnd).forEach(function(we){L.add(we)})}for(var le=0;le<50;le++){var ue=Ze[Ze.length-1-le];if(!ue||ue.startTime<t)break;L.add(ue)}Ze=Array.from(L),sr=-1};Ct.push(function(M){M.interactionId&&M.target&&!Gt.has(M.interactionId)&&Gt.set(M.interactionId,M.target)},function(M){var Z,L=M.startTime+M.duration;t=Math.max(t,M.processingEnd);for(var q=Xe.length-1;q>=0;q--){var H=Xe[q];if(Math.abs(L-H.renderTime)<=8){(Z=H).startTime=Math.min(M.startTime,Z.startTime),Z.processingStart=Math.min(M.processingStart,Z.processingStart),Z.processingEnd=Math.max(M.processingEnd,Z.processingEnd),Z.entries.push(M);break}}Z||(Z={startTime:M.startTime,processingStart:M.processingStart,processingEnd:M.processingEnd,renderTime:L,entries:[M]},Xe.push(Z)),(M.interactionId||M.entryType==="first-input")&&Et.set(M,Z),O()});var D=function(M,Z){for(var L,q=[],H=0;L=Ze[H];H++)if(!(L.startTime+L.duration<M)){if(L.startTime>Z)break;q.push(L)}return q},W=[2500,4e3],J={},Ee=typeof window<"u"?window:void 0,me=typeof globalThis<"u"?globalThis:Ee,ze=me?.navigator;me?.document,me?.location,me?.fetch,me!=null&&me.XMLHttpRequest&&"withCredentials"in new me.XMLHttpRequest&&me.XMLHttpRequest,me?.AbortController,ze?.userAgent;var Pe=Ee??{},nt={onLCP:function(M,Z){(function(L,q){q=q||{},be(function(){var H,le=qe(),ue=f("LCP"),we=function(Ve){q.reportAllChanges||(Ve=Ve.slice(-1)),Ve.forEach(function(Je){Je.startTime<le.firstHiddenTime&&(ue.value=Math.max(Je.startTime-g(),0),ue.entries=[Je],H())})},Me=b("largest-contentful-paint",we);if(Me){H=y(L,ue,W,q.reportAllChanges);var Ue=z(function(){J[ue.id]||(we(Me.takeRecords()),Me.disconnect(),J[ue.id]=!0,H(!0))});["keydown","click"].forEach(function(Ve){addEventListener(Ve,function(){return et(Ue)},!0)}),T(Ue),m(function(Ve){ue=f("LCP"),H=y(L,ue,W,q.reportAllChanges),E(function(){ue.value=performance.now()-Ve.timeStamp,J[ue.id]=!0,H(!0)})})}})})(function(L){var q=function(H){var le={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:H.value};if(H.entries.length){var ue=r();if(ue){var we=ue.activationStart||0,Me=H.entries[H.entries.length-1],Ue=Me.url&&performance.getEntriesByType("resource").filter(function(Ae){return Ae.name===Me.url})[0],Ve=Math.max(0,ue.responseStart-we),Je=Math.max(Ve,Ue?(Ue.requestStart||Ue.startTime)-we:0),er=Math.max(Je,Ue?Ue.responseEnd-we:0),wr=Math.max(er,Me.startTime-we);le={element:u(Me.element),timeToFirstByte:Ve,resourceLoadDelay:Je-Ve,resourceLoadDuration:er-Je,elementRenderDelay:wr-er,navigationEntry:ue,lcpEntry:Me},Me.url&&(le.url=Me.url),Ue&&(le.lcpResourceEntry=Ue)}}return Object.assign(H,{attribution:le})}(L);M(q)},Z)},onCLS:function(M,Z){(function(L,q){q=q||{},Re(z(function(){var H,le=f("CLS",0),ue=0,we=[],Me=function(Ve){Ve.forEach(function(Je){if(!Je.hadRecentInput){var er=we[0],wr=we[we.length-1];ue&&Je.startTime-wr.startTime<1e3&&Je.startTime-er.startTime<5e3?(ue+=Je.value,we.push(Je)):(ue=Je.value,we=[Je])}}),ue>le.value&&(le.value=ue,le.entries=we,H())},Ue=b("layout-shift",Me);Ue&&(H=y(L,le,je,q.reportAllChanges),T(function(){Me(Ue.takeRecords()),H(!0)}),m(function(){ue=0,le=f("CLS",0),H=y(L,le,je,q.reportAllChanges),E(function(){return H()})}),setTimeout(H,0))}))})(function(L){var q=function(H){var le,ue={};if(H.entries.length){var we=H.entries.reduce(function(Ue,Ve){return Ue&&Ue.value>Ve.value?Ue:Ve});if(we&&we.sources&&we.sources.length){var Me=(le=we.sources).find(function(Ue){return Ue.node&&Ue.node.nodeType===1})||le[0];Me&&(ue={largestShiftTarget:u(Me.node),largestShiftTime:we.startTime,largestShiftValue:we.value,largestShiftSource:Me,largestShiftEntry:we,loadState:s(we.startTime)})}}return Object.assign(H,{attribution:ue})}(L);M(q)},Z)},onFCP:function(M,Z){Re(function(L){var q=function(H){var le={timeToFirstByte:0,firstByteToFCP:H.value,loadState:s(p())};if(H.entries.length){var ue=r(),we=H.entries[H.entries.length-1];if(ue){var Me=ue.activationStart||0,Ue=Math.max(0,ue.responseStart-Me);le={timeToFirstByte:Ue,firstByteToFCP:H.value-Ue,loadState:s(H.entries[0].startTime),navigationEntry:ue,fcpEntry:we}}}return Object.assign(H,{attribution:le})}(L);M(q)},Z)},onINP:function(M,Z){e||(e=b("long-animation-frame",Yt)),function(L,q){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(q=q||{},be(function(){var H;_t();var le,ue=f("INP"),we=function(Ue){et(function(){Ue.forEach(zt);var Ve,Je=(Ve=Math.min(Ye.length-1,Math.floor(It()/50)),Ye[Ve]);Je&&Je.latency!==ue.value&&(ue.value=Je.latency,ue.entries=Je.entries,le())})},Me=b("event",we,{durationThreshold:(H=q.durationThreshold)!==null&&H!==void 0?H:40});le=y(L,ue,st,q.reportAllChanges),Me&&(Me.observe({type:"first-input",buffered:!0}),T(function(){we(Me.takeRecords()),le(!0)}),m(function(){St=0,Ye.length=0,gt.clear(),ue=f("INP"),le=y(L,ue,st,q.reportAllChanges)}))}))}(function(L){var q=function(H){var le=H.entries[0],ue=Et.get(le),we=le.processingStart,Me=ue.processingEnd,Ue=ue.entries.sort(function(qt,Bn){return qt.processingStart-Bn.processingStart}),Ve=D(le.startTime,Me),Je=H.entries.find(function(qt){return qt.target}),er=Je&&Je.target||Gt.get(le.interactionId),wr=[le.startTime+le.duration,Me].concat(Ve.map(function(qt){return qt.startTime+qt.duration})),Ae=Math.max.apply(Math,wr),kt={interactionTarget:u(er),interactionTargetElement:er,interactionType:le.name.startsWith("key")?"keyboard":"pointer",interactionTime:le.startTime,nextPaintTime:Ae,processedEventEntries:Ue,longAnimationFrameEntries:Ve,inputDelay:we-le.startTime,processingDuration:Me-we,presentationDelay:Math.max(Ae-Me,0),loadState:s(le.startTime)};return Object.assign(H,{attribution:kt})}(L);M(q)},Z)}};Pe.__PosthogExtensions__=Pe.__PosthogExtensions__||{},Pe.__PosthogExtensions__.postHogWebVitalsCallbacks=nt,Pe.postHogWebVitalsCallbacks=nt})();function Sa(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function P(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Sa(Object(t),!0).forEach(function(r){U(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Sa(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function U(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Il(n,e){if(n==null)return{};var t,r,s=function(u,h){if(u==null)return{};var p,m,g={},f=Object.keys(u);for(m=0;m<f.length;m++)p=f[m],h.indexOf(p)>=0||(g[p]=u[p]);return g}(n,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(r=0;r<a.length;r++)t=a[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}var ar,_r={DEBUG:!1,LIB_VERSION:"1.203.2"},C=typeof window<"u"?window:void 0,$t=typeof globalThis<"u"?globalThis:C,Cl=Array.prototype,Ia=Cl.forEach,Ca=Cl.indexOf,Vt=$t?.navigator,he=$t?.document,Ht=$t?.location,To=$t?.fetch,xo=$t!=null&&$t.XMLHttpRequest&&"withCredentials"in new $t.XMLHttpRequest?$t.XMLHttpRequest:void 0,Ea=$t?.AbortController,bt=Vt?.userAgent,Le=C??{},fo="$copy_autocapture",Ec=["$snapshot","$pageview","$pageleave","$set","survey dismissed","survey sent","survey shown","$identify","$groupidentify","$create_alias","$$client_ingestion_warning","$web_experiment_applied","$feature_enrollment_update","$feature_flag_called"];(function(n){n.GZipJS="gzip-js",n.Base64="base64"})(ar||(ar={}));function De(n,e){return n.indexOf(e)!==-1}var Ni=function(n){return n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},Ro=function(n){return n.replace(/^\$/,"")},kc=Array.isArray,El=Object.prototype,kl=El.hasOwnProperty,Fi=El.toString,ht=kc||function(n){return Fi.call(n)==="[object Array]"},Jt=n=>typeof n=="function",dt=n=>n===Object(n)&&!ht(n),rn=n=>{if(dt(n)){for(var e in n)if(kl.call(n,e))return!1;return!0}return!1},pe=n=>n===void 0,xt=n=>Fi.call(n)=="[object String]",ka=n=>xt(n)&&n.trim().length===0,Ar=n=>n===null,Qe=n=>pe(n)||Ar(n),Ft=n=>Fi.call(n)=="[object Number]",qr=n=>Fi.call(n)==="[object Boolean]",Tc=n=>n instanceof FormData,xc=n=>De(Ec,n),Tl=n=>{var e={_log:function(t){if(C&&(_r.DEBUG||Le.POSTHOG_DEBUG)&&!pe(C.console)&&C.console){for(var r=("__rrweb_original__"in C.console[t])?C.console[t].__rrweb_original__:C.console[t],s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];r(n,...a)}},info:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e._log("log",...r)},warn:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e._log("warn",...r)},error:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];e._log("error",...r)},critical:function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];console.error(n,...r)},uninitializedWarning:t=>{e.error("You must initialize PostHog before calling ".concat(t))},createLogger:t=>Tl("".concat(n," ").concat(t))};return e},fe=Tl("[PostHog.js]"),jt=fe.createLogger,_i={};function on(n,e,t){if(ht(n)){if(Ia&&n.forEach===Ia)n.forEach(e,t);else if("length"in n&&n.length===+n.length){for(var r=0,s=n.length;r<s;r++)if(r in n&&e.call(t,n[r],r)===_i)return}}}function Ke(n,e,t){if(!Qe(n)){if(ht(n))return on(n,e,t);if(Tc(n)){for(var r of n.entries())if(e.call(t,r[1],r[0])===_i)return}else for(var s in n)if(kl.call(n,s)&&e.call(t,n[s],s)===_i)return}}var Lt=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return on(t,function(s){for(var a in s)s[a]!==void 0&&(n[a]=s[a])}),n};function fi(n){for(var e=Object.keys(n),t=e.length,r=new Array(t);t--;)r[t]=[e[t],n[e[t]]];return r}var Ta=function(n){try{return n()}catch{return}},Rc=function(n){return function(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(this,t)}catch(s){fe.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),fe.critical(s)}}},yi=function(n){var e={};return Ke(n,function(t,r){xt(t)&&t.length>0&&(e[r]=t)}),e};function Mc(n,e){return t=n,r=a=>xt(a)&&!Ar(e)?a.slice(0,e):a,s=new Set,function a(u,h){return u!==Object(u)?r?r(u,h):u:s.has(u)?void 0:(s.add(u),ht(u)?(p=[],on(u,m=>{p.push(a(m))})):(p={},Ke(u,(m,g)=>{s.has(m)||(p[g]=a(m,g))})),p);var p}(t);var t,r,s}var yr=function(){function n(e){return e&&(e.preventDefault=n.preventDefault,e.stopPropagation=n.stopPropagation),e}return n.preventDefault=function(){this.returnValue=!1},n.stopPropagation=function(){this.cancelBubble=!0},function(e,t,r,s,a){if(e)if(e.addEventListener&&!s)e.addEventListener(t,r,!!a);else{var u="on"+t,h=e[u];e[u]=function(p,m,g){return function(f){if(f=f||n(C?.event)){var b,y=!0;Jt(g)&&(b=g(f));var E=m.call(p,f);return b!==!1&&E!==!1||(y=!1),y}}}(e,r,h)}else fe.error("No valid element provided to register_event")}}();function xl(n,e){for(var t=0;t<n.length;t++)if(e(n[t]))return n[t]}var Rl="$people_distinct_id",Cn="__alias",En="__timers",xa="$autocapture_disabled_server_side",Mo="$heatmaps_enabled_server_side",Ra="$exception_capture_enabled_server_side",Ma="$web_vitals_enabled_server_side",Ml="$dead_clicks_enabled_server_side",Aa="$web_vitals_allowed_metrics",Ao="$session_recording_enabled_server_side",Oa="$console_log_recording_enabled_server_side",Na="$session_recording_network_payload_capture",Fa="$session_recording_canvas_recording",La="$replay_sample_rate",Pa="$replay_minimum_duration",Da="$replay_script_config",bi="$sesid",kn="$session_is_sampled",vo="$session_recording_url_trigger_activated_session",mo="$session_recording_event_trigger_activated_session",nn="$enabled_feature_flags",vi="$early_access_features",Tn="$stored_person_properties",Wr="$stored_group_properties",Oo="$surveys",ii="$surveys_activated",wi="$flag_call_reported",fr="$user_state",No="$client_session_props",Fo="$capture_rate_limit",Lo="$initial_campaign_params",Po="$initial_referrer_info",Do="$initial_person_info",Si="$epp",Al="__POSTHOG_TOOLBAR__",Ba="$posthog_cklsh",Ac=[Rl,Cn,"__cmpns",En,Ao,Mo,bi,nn,fr,vi,Wr,Tn,Oo,wi,No,Fo,Lo,Po,Si],oi=jt("[FeatureFlags]"),_o="$active_feature_flags",si="$override_feature_flags",Ha="$feature_flag_payloads",$a=n=>{var e={};for(var[t,r]of fi(n||{}))r&&(e[t]=r);return e};class Oc{constructor(e){U(this,"_override_warning",!1),U(this,"_hasLoadedFlags",!1),U(this,"_requestInFlight",!1),U(this,"_reloadingDisabled",!1),U(this,"_additionalReloadRequested",!1),U(this,"_decideCalled",!1),U(this,"_flagsLoadedFromRemote",!1),this.instance=e,this.featureFlagEventHandlers=[]}decide(){if(this.instance.config.__preview_remote_config)this._decideCalled=!0;else{var e=!this._reloadDebouncer&&(this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load);this._callDecideEndpoint({disableFlags:e})}}get hasLoadedFlags(){return this._hasLoadedFlags}getFlags(){return Object.keys(this.getFlagVariants())}getFlagVariants(){var e=this.instance.get_property(nn),t=this.instance.get_property(si);if(!t)return e||{};for(var r=Lt({},e),s=Object.keys(t),a=0;a<s.length;a++)r[s[a]]=t[s[a]];return this._override_warning||(oi.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:r}),this._override_warning=!0),r}getFlagPayloads(){return this.instance.get_property(Ha)||{}}reloadFeatureFlags(){this._reloadingDisabled||this.instance.config.advanced_disable_feature_flags||this._reloadDebouncer||(this._reloadDebouncer=setTimeout(()=>{this._callDecideEndpoint()},5))}clearDebouncer(){clearTimeout(this._reloadDebouncer),this._reloadDebouncer=void 0}ensureFlagsLoaded(){this._hasLoadedFlags||this._requestInFlight||this._reloadDebouncer||this.reloadFeatureFlags()}setAnonymousDistinctId(e){this.$anon_distinct_id=e}setReloadingPaused(e){this._reloadingDisabled=e}_callDecideEndpoint(e){if(this.clearDebouncer(),!this.instance.config.advanced_disable_decide)if(this._requestInFlight)this._additionalReloadRequested=!0;else{var t={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:this.instance.get_property(Tn),group_properties:this.instance.get_property(Wr)};(e!=null&&e.disableFlags||this.instance.config.advanced_disable_feature_flags)&&(t.disable_flags=!0),this._requestInFlight=!0,this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:t,compression:this.instance.config.disable_compression?void 0:ar.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:r=>{var s,a,u=!0;r.statusCode===200&&(this.$anon_distinct_id=void 0,u=!1),this._requestInFlight=!1,this._decideCalled||(this._decideCalled=!0,this.instance._onRemoteConfig((a=r.json)!==null&&a!==void 0?a:{})),t.disable_flags||(this._flagsLoadedFromRemote=!u,this.receivedFeatureFlags((s=r.json)!==null&&s!==void 0?s:{},u),this._additionalReloadRequested&&(this._additionalReloadRequested=!1,this._callDecideEndpoint()))}})}}getFeatureFlag(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0){var r,s,a,u,h,p=this.getFlagVariants()[e],m="".concat(p),g=this.instance.get_property(wi)||{};return(t.send_event||!("send_event"in t))&&(!(e in g)||!g[e].includes(m))&&(ht(g[e])?g[e].push(m):g[e]=[m],(r=this.instance.persistence)===null||r===void 0||r.register({[wi]:g}),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:p,$feature_flag_payload:this.getFeatureFlagPayload(e)||null,$feature_flag_bootstrapped_response:((s=this.instance.config.bootstrap)===null||s===void 0||(a=s.featureFlags)===null||a===void 0?void 0:a[e])||null,$feature_flag_bootstrapped_payload:((u=this.instance.config.bootstrap)===null||u===void 0||(h=u.featureFlagPayloads)===null||h===void 0?void 0:h[e])||null,$used_bootstrap_value:!this._flagsLoadedFromRemote})),p}oi.warn('getFeatureFlag for key "'+e+`" failed. Feature flags didn't load in time.`)}getFeatureFlagPayload(e){return this.getFlagPayloads()[e]}isFeatureEnabled(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this._hasLoadedFlags||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);oi.warn('isFeatureEnabled for key "'+e+`" failed. Feature flags didn't load in time.`)}addFeatureFlagsHandler(e){this.featureFlagEventHandlers.push(e)}removeFeatureFlagsHandler(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter(t=>t!==e)}receivedFeatureFlags(e,t){if(this.instance.persistence){this._hasLoadedFlags=!0;var r=this.getFlagVariants(),s=this.getFlagPayloads();(function(a,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},m=a.featureFlags,g=a.featureFlagPayloads;if(m)if(ht(m)){var f={};if(m)for(var b=0;b<m.length;b++)f[m[b]]=!0;u&&u.register({[_o]:m,[nn]:f})}else{var y=m,E=g;a.errorsWhileComputingFlags&&(y=P(P({},h),y),E=P(P({},p),E)),u&&u.register({[_o]:Object.keys($a(y)),[nn]:y||{},[Ha]:E||{}})}})(e,this.instance.persistence,r,s),this._fireFeatureFlagsCallbacks(t)}}override(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.instance.__loaded||!this.instance.persistence)return oi.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=t,e===!1)this.instance.persistence.unregister(si);else if(ht(e)){for(var r={},s=0;s<e.length;s++)r[e[s]]=!0;this.instance.persistence.register({[si]:r})}else this.instance.persistence.register({[si]:e})}onFeatureFlags(e){if(this.addFeatureFlagsHandler(e),this._hasLoadedFlags){var{flags:t,flagVariants:r}=this._prepareFeatureFlagsForCallbacks();e(t,r)}return()=>this.removeFeatureFlagsHandler(e)}updateEarlyAccessFeatureEnrollment(e,t){var r,s=(this.instance.get_property(vi)||[]).find(p=>p.flagKey===e),a={["$feature_enrollment/".concat(e)]:t},u={$feature_flag:e,$feature_enrollment:t,$set:a};s&&(u.$early_access_feature_name=s.name),this.instance.capture("$feature_enrollment_update",u),this.setPersonPropertiesForFlags(a,!1);var h=P(P({},this.getFlagVariants()),{},{[e]:t});(r=this.instance.persistence)===null||r===void 0||r.register({[_o]:Object.keys($a(h)),[nn]:h}),this._fireFeatureFlagsCallbacks()}getEarlyAccessFeatures(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],r=this.instance.get_property(vi);if(r&&!t)return e(r);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:s=>{var a;if(s.json){var u=s.json.earlyAccessFeatures;return(a=this.instance.persistence)===null||a===void 0||a.register({[vi]:u}),e(u)}}})}_prepareFeatureFlagsForCallbacks(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter(r=>t[r]),flagVariants:Object.keys(t).filter(r=>t[r]).reduce((r,s)=>(r[s]=t[s],r),{})}}_fireFeatureFlagsCallbacks(e){var{flags:t,flagVariants:r}=this._prepareFeatureFlagsForCallbacks();this.featureFlagEventHandlers.forEach(s=>s(t,r,{errorsLoading:e}))}setPersonPropertiesForFlags(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=this.instance.get_property(Tn)||{};this.instance.register({[Tn]:P(P({},r),e)}),t&&this.instance.reloadFeatureFlags()}resetPersonPropertiesForFlags(){this.instance.unregister(Tn)}setGroupPropertiesForFlags(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],r=this.instance.get_property(Wr)||{};Object.keys(r).length!==0&&Object.keys(r).forEach(s=>{r[s]=P(P({},r[s]),e[s]),delete e[s]}),this.instance.register({[Wr]:P(P({},r),e)}),t&&this.instance.reloadFeatureFlags()}resetGroupPropertiesForFlags(e){if(e){var t=this.instance.get_property(Wr)||{};this.instance.register({[Wr]:P(P({},t),{},{[e]:{}})})}else this.instance.unregister(Wr)}}Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)}),Number.isInteger||(Number.isInteger=function(n){return Ft(n)&&isFinite(n)&&Math.floor(n)===n});var Wa="0123456789abcdef";class Ii{constructor(e){if(this.bytes=e,e.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(e,t,r,s){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(s)||e<0||t<0||r<0||s<0||e>0xffffffffffff||t>4095||r>1073741823||s>4294967295)throw new RangeError("invalid field value");var a=new Uint8Array(16);return a[0]=e/Math.pow(2,40),a[1]=e/Math.pow(2,32),a[2]=e/Math.pow(2,24),a[3]=e/Math.pow(2,16),a[4]=e/Math.pow(2,8),a[5]=e,a[6]=112|t>>>8,a[7]=t,a[8]=128|r>>>24,a[9]=r>>>16,a[10]=r>>>8,a[11]=r,a[12]=s>>>24,a[13]=s>>>16,a[14]=s>>>8,a[15]=s,new Ii(a)}toString(){for(var e="",t=0;t<this.bytes.length;t++)e=e+Wa.charAt(this.bytes[t]>>>4)+Wa.charAt(15&this.bytes[t]),t!==3&&t!==5&&t!==7&&t!==9||(e+="-");if(e.length!==36)throw new Error("Invalid UUIDv7 was generated");return e}clone(){return new Ii(this.bytes.slice(0))}equals(e){return this.compareTo(e)===0}compareTo(e){for(var t=0;t<16;t++){var r=this.bytes[t]-e.bytes[t];if(r!==0)return Math.sign(r)}return 0}}class Nc{constructor(){U(this,"timestamp",0),U(this,"counter",0),U(this,"random",new Fc)}generate(){var e=this.generateOrAbort();if(pe(e)){this.timestamp=0;var t=this.generateOrAbort();if(pe(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}generateOrAbort(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return Ii.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}var ja,Ol=n=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var e=0;e<n.length;e++)n[e]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return n};C&&!pe(C.crypto)&&crypto.getRandomValues&&(Ol=n=>crypto.getRandomValues(n));class Fc{constructor(){U(this,"buffer",new Uint32Array(8)),U(this,"cursor",1/0)}nextUint32(){return this.cursor>=this.buffer.length&&(Ol(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}var xr=()=>Lc().toString(),Lc=()=>(ja||(ja=new Nc)).generate(),Pc="Thu, 01 Jan 1970 00:00:00 GMT",bn="",Dc=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;function Bc(n,e){if(e){var t=function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:he;if(bn)return bn;if(!a||["localhost","127.0.0.1"].includes(s))return"";for(var u=s.split("."),h=Math.min(u.length,8),p="dmn_chk_"+xr(),m=new RegExp("(^|;)\\s*"+p+"=1");!bn&&h--;){var g=u.slice(h).join("."),f=p+"=1;domain=."+g;a.cookie=f,m.test(a.cookie)&&(a.cookie=f+";expires="+Pc,bn=g)}return bn}(n);if(!t){var r=(s=>{var a=s.match(Dc);return a?a[0]:""})(n);r!==t&&fe.info("Warning: cookie subdomain discovery mismatch",r,t),t=r}return t?"; domain=."+t:""}return""}var br={is_supported:()=>!!he,error:function(n){fe.error("cookieStore error: "+n)},get:function(n){if(he){try{for(var e=n+"=",t=he.cookie.split(";").filter(a=>a.length),r=0;r<t.length;r++){for(var s=t[r];s.charAt(0)==" ";)s=s.substring(1,s.length);if(s.indexOf(e)===0)return decodeURIComponent(s.substring(e.length,s.length))}}catch{}return null}},parse:function(n){var e;try{e=JSON.parse(br.get(n))||{}}catch{}return e},set:function(n,e,t,r,s){if(he)try{var a="",u="",h=Bc(he.location.hostname,r);if(t){var p=new Date;p.setTime(p.getTime()+24*t*60*60*1e3),a="; expires="+p.toUTCString()}s&&(u="; secure");var m=n+"="+encodeURIComponent(JSON.stringify(e))+a+"; SameSite=Lax; path=/"+h+u;return m.length>3686.4&&fe.warn("cookieStore warning: large cookie, len="+m.length),he.cookie=m,m}catch{return}},remove:function(n,e){try{br.set(n,"",-1,e)}catch{return}}},yo=null,mt={is_supported:function(){if(!Ar(yo))return yo;var n=!0;if(pe(C))n=!1;else try{var e="__mplssupport__";mt.set(e,"xyz"),mt.get(e)!=='"xyz"'&&(n=!1),mt.remove(e)}catch{n=!1}return n||fe.error("localStorage unsupported; falling back to cookie store"),yo=n,n},error:function(n){fe.error("localStorage error: "+n)},get:function(n){try{return C?.localStorage.getItem(n)}catch(e){mt.error(e)}return null},parse:function(n){try{return JSON.parse(mt.get(n))||{}}catch{}return null},set:function(n,e){try{C?.localStorage.setItem(n,JSON.stringify(e))}catch(t){mt.error(t)}},remove:function(n){try{C?.localStorage.removeItem(n)}catch(e){mt.error(e)}}},Hc=["distinct_id",bi,kn,Si,Do],ai=P(P({},mt),{},{parse:function(n){try{var e={};try{e=br.parse(n)||{}}catch{}var t=Lt(e,JSON.parse(mt.get(n)||"{}"));return mt.set(n,t),t}catch{}return null},set:function(n,e,t,r,s,a){try{mt.set(n,e,void 0,void 0,a);var u={};Hc.forEach(h=>{e[h]&&(u[h]=e[h])}),Object.keys(u).length&&br.set(n,u,t,r,s,a)}catch(h){mt.error(h)}},remove:function(n,e){try{C?.localStorage.removeItem(n),br.remove(n,e)}catch(t){mt.error(t)}}}),li={},$c={is_supported:function(){return!0},error:function(n){fe.error("memoryStorage error: "+n)},get:function(n){return li[n]||null},parse:function(n){return li[n]||null},set:function(n,e){li[n]=e},remove:function(n){delete li[n]}},Lr=null,Tt={is_supported:function(){if(!Ar(Lr))return Lr;if(Lr=!0,pe(C))Lr=!1;else try{var n="__support__";Tt.set(n,"xyz"),Tt.get(n)!=='"xyz"'&&(Lr=!1),Tt.remove(n)}catch{Lr=!1}return Lr},error:function(n){fe.error("sessionStorage error: ",n)},get:function(n){try{return C?.sessionStorage.getItem(n)}catch(e){Tt.error(e)}return null},parse:function(n){try{return JSON.parse(Tt.get(n))||null}catch{}return null},set:function(n,e){try{C?.sessionStorage.setItem(n,JSON.stringify(e))}catch(t){Tt.error(t)}},remove:function(n){try{C?.sessionStorage.removeItem(n)}catch(e){Tt.error(e)}}},Wc=["localhost","127.0.0.1"],sn=n=>{var e=he?.createElement("a");return pe(e)?null:(e.href=n,e)},un=function(n,e){return!!function(t){try{new RegExp(t)}catch{return!1}return!0}(e)&&new RegExp(e).test(n)},jc=function(n){var e,t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"&",s=[];return Ke(n,function(a,u){pe(a)||pe(u)||u==="undefined"||(e=encodeURIComponent((h=>h instanceof File)(a)?a.name:a.toString()),t=encodeURIComponent(u),s[s.length]=t+"="+e)}),s.join(r)},Ci=function(n,e){for(var t,r=((n.split("#")[0]||"").split("?")[1]||"").split("&"),s=0;s<r.length;s++){var a=r[s].split("=");if(a[0]===e){t=a;break}}if(!ht(t)||t.length<2)return"";var u=t[1];try{u=decodeURIComponent(u)}catch{fe.error("Skipping decoding for malformed query param: "+u)}return u.replace(/\+/g," ")},Ei=function(n,e){var t=n.match(new RegExp(e+"=([^&]*)"));return t?t[1]:null},Kt="Mobile",ki="iOS",lr="Android",Nn="Tablet",Nl=lr+" "+Nn,Fl="iPad",Ll="Apple",Pl=Ll+" Watch",Fn="Safari",cn="BlackBerry",Dl="Samsung",Bl=Dl+"Browser",Hl=Dl+" Internet",Vr="Chrome",Gc=Vr+" OS",$l=Vr+" "+ki,ts="Internet Explorer",Wl=ts+" "+Kt,rs="Opera",qc=rs+" Mini",ns="Edge",jl="Microsoft "+ns,an="Firefox",Gl=an+" "+ki,Ln="Nintendo",Pn="PlayStation",ln="Xbox",ql=lr+" "+Kt,Ul=Kt+" "+Fn,xn="Windows",Bo=xn+" Phone",Ga="Nokia",Ho="Ouya",Vl="Generic",Uc=Vl+" "+Kt.toLowerCase(),zl=Vl+" "+Nn.toLowerCase(),$o="Konqueror",Nt="(\\d+(\\.\\d+)?)",bo=new RegExp("Version/"+Nt),Vc=new RegExp(ln,"i"),zc=new RegExp(Pn+" \\w+","i"),Yc=new RegExp(Ln+" \\w+","i"),is=new RegExp(cn+"|PlayBook|BB10","i"),Zc={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},Xc=(n,e)=>e&&De(e,Ll)||function(t){return De(t,Fn)&&!De(t,Vr)&&!De(t,lr)}(n),qa=function(n,e){return e=e||"",De(n," OPR/")&&De(n,"Mini")?qc:De(n," OPR/")?rs:is.test(n)?cn:De(n,"IE"+Kt)||De(n,"WPDesktop")?Wl:De(n,Bl)?Hl:De(n,ns)||De(n,"Edg/")?jl:De(n,"FBIOS")?"Facebook "+Kt:De(n,"UCWEB")||De(n,"UCBrowser")?"UC Browser":De(n,"CriOS")?$l:De(n,"CrMo")||De(n,Vr)?Vr:De(n,lr)&&De(n,Fn)?ql:De(n,"FxiOS")?Gl:De(n.toLowerCase(),$o.toLowerCase())?$o:Xc(n,e)?De(n,Kt)?Ul:Fn:De(n,an)?an:De(n,"MSIE")||De(n,"Trident/")?ts:De(n,"Gecko")?an:""},Jc={[Wl]:[new RegExp("rv:"+Nt)],[jl]:[new RegExp(ns+"?\\/"+Nt)],[Vr]:[new RegExp("("+Vr+"|CrMo)\\/"+Nt)],[$l]:[new RegExp("CriOS\\/"+Nt)],"UC Browser":[new RegExp("(UCBrowser|UCWEB)\\/"+Nt)],[Fn]:[bo],[Ul]:[bo],[rs]:[new RegExp("(Opera|OPR)\\/"+Nt)],[an]:[new RegExp(an+"\\/"+Nt)],[Gl]:[new RegExp("FxiOS\\/"+Nt)],[$o]:[new RegExp("Konqueror[:/]?"+Nt,"i")],[cn]:[new RegExp(cn+" "+Nt),bo],[ql]:[new RegExp("android\\s"+Nt,"i")],[Hl]:[new RegExp(Bl+"\\/"+Nt)],[ts]:[new RegExp("(rv:|MSIE )"+Nt)],Mozilla:[new RegExp("rv:"+Nt)]},Ua=[[new RegExp(ln+"; "+ln+" (.*?)[);]","i"),n=>[ln,n&&n[1]||""]],[new RegExp(Ln,"i"),[Ln,""]],[new RegExp(Pn,"i"),[Pn,""]],[is,[cn,""]],[new RegExp(xn,"i"),(n,e)=>{if(/Phone/.test(e)||/WPDesktop/.test(e))return[Bo,""];if(new RegExp(Kt).test(e)&&!/IEMobile\b/.test(e))return[xn+" "+Kt,""];var t=/Windows NT ([0-9.]+)/i.exec(e);if(t&&t[1]){var r=t[1],s=Zc[r]||"";return/arm/i.test(e)&&(s="RT"),[xn,s]}return[xn,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,n=>{if(n&&n[3]){var e=[n[3],n[4],n[5]||"0"];return[ki,e.join(".")]}return[ki,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,n=>{var e="";return n&&n.length>=3&&(e=pe(n[2])?n[3]:n[2]),["watchOS",e]}],[new RegExp("("+lr+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+lr+")","i"),n=>{if(n&&n[2]){var e=[n[2],n[3],n[4]||"0"];return[lr,e.join(".")]}return[lr,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,n=>{var e=["Mac OS X",""];if(n&&n[1]){var t=[n[1],n[2],n[3]||"0"];e[1]=t.join(".")}return e}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[Gc,""]],[/Linux|debian/i,["Linux",""]]],Va=function(n){return Yc.test(n)?Ln:zc.test(n)?Pn:Vc.test(n)?ln:new RegExp(Ho,"i").test(n)?Ho:new RegExp("("+Bo+"|WPDesktop)","i").test(n)?Bo:/iPad/.test(n)?Fl:/iPod/.test(n)?"iPod Touch":/iPhone/.test(n)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(n)?Pl:is.test(n)?cn:/(kobo)\s(ereader|touch)/i.test(n)?"Kobo":new RegExp(Ga,"i").test(n)?Ga:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(n)||/(kf[a-z]+)( bui|\)).+silk\//i.test(n)?"Kindle Fire":/(Android|ZTE)/i.test(n)?!new RegExp(Kt).test(n)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(n)?/pixel[\daxl ]{1,6}/i.test(n)&&!/pixel c/i.test(n)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(n)||/lmy47v/i.test(n)&&!/QTAQZ3/i.test(n)?lr:Nl:lr:new RegExp("(pda|"+Kt+")","i").test(n)?Uc:new RegExp(Nn,"i").test(n)&&!new RegExp(Nn+" pc","i").test(n)?zl:""},ui="https?://(.*)",Kc=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","gad_source","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","mc_cid","igshid","ttclid","rdt_cid"],lt={campaignParams:function(n){return he?this._campaignParamsFromUrl(he.URL,n):{}},_campaignParamsFromUrl:function(n,e){var t=Kc.concat(e||[]),r={};return Ke(t,function(s){var a=Ci(n,s);r[s]=a||null}),r},_searchEngine:function(n){return n?n.search(ui+"google.([^/?]*)")===0?"google":n.search(ui+"bing.com")===0?"bing":n.search(ui+"yahoo.com")===0?"yahoo":n.search(ui+"duckduckgo.com")===0?"duckduckgo":null:null},_searchInfoFromReferrer:function(n){var e=lt._searchEngine(n),t=e!="yahoo"?"q":"p",r={};if(!Ar(e)){r.$search_engine=e;var s=he?Ci(he.referrer,t):"";s.length&&(r.ph_keyword=s)}return r},searchInfo:function(){var n=he?.referrer;return n?this._searchInfoFromReferrer(n):{}},browser:qa,browserVersion:function(n,e){var t=qa(n,e),r=Jc[t];if(pe(r))return null;for(var s=0;s<r.length;s++){var a=r[s],u=n.match(a);if(u)return parseFloat(u[u.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},browserLanguagePrefix:function(){var n=this.browserLanguage();return typeof n=="string"?n.split("-")[0]:void 0},os:function(n){for(var e=0;e<Ua.length;e++){var[t,r]=Ua[e],s=t.exec(n),a=s&&(Jt(r)?r(s,n):r);if(a)return a}return["",""]},device:Va,deviceType:function(n){var e=Va(n);return e===Fl||e===Nl||e==="Kobo"||e==="Kindle Fire"||e===zl?Nn:e===Ln||e===ln||e===Pn||e===Ho?"Console":e===Pl?"Wearable":e?Kt:"Desktop"},referrer:function(){return he?.referrer||"$direct"},referringDomain:function(){var n;return he!=null&&he.referrer&&((n=sn(he.referrer))===null||n===void 0?void 0:n.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},initialPersonInfo:function(){return{r:this.referrer().substring(0,1e3),u:Ht?.href.substring(0,1e3)}},initialPersonPropsFromInfo:function(n){var e,{r:t,u:r}=n,s={$initial_referrer:t,$initial_referring_domain:t==null?void 0:t=="$direct"?"$direct":(e=sn(t))===null||e===void 0?void 0:e.host};if(r){s.$initial_current_url=r;var a=sn(r);s.$initial_host=a?.host,s.$initial_pathname=a?.pathname,Ke(this._campaignParamsFromUrl(r),function(u,h){s["$initial_"+Ro(h)]=u})}return t&&Ke(this._searchInfoFromReferrer(t),function(u,h){s["$initial_"+Ro(h)]=u}),s},timezone:function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}},timezoneOffset:function(){try{return new Date().getTimezoneOffset()}catch{return}},properties:function(){if(!bt)return{};var[n,e]=lt.os(bt);return Lt(yi({$os:n,$os_version:e,$browser:lt.browser(bt,navigator.vendor),$device:lt.device(bt),$device_type:lt.deviceType(bt),$timezone:lt.timezone(),$timezone_offset:lt.timezoneOffset()}),{$current_url:Ht?.href,$host:Ht?.host,$pathname:Ht?.pathname,$raw_user_agent:bt.length>1e3?bt.substring(0,997)+"...":bt,$browser_version:lt.browserVersion(bt,navigator.vendor),$browser_language:lt.browserLanguage(),$browser_language_prefix:lt.browserLanguagePrefix(),$screen_height:C?.screen.height,$screen_width:C?.screen.width,$viewport_height:C?.innerHeight,$viewport_width:C?.innerWidth,$lib:"web",$lib_version:_r.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:Date.now()/1e3})},people_properties:function(){if(!bt)return{};var[n,e]=lt.os(bt);return Lt(yi({$os:n,$os_version:e,$browser:lt.browser(bt,navigator.vendor)}),{$browser_version:lt.browserVersion(bt,navigator.vendor)})}},Qc=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"];class wo{constructor(e){this.config=e,this.props={},this.campaign_params_saved=!1,this.name=(t=>{var r="";return t.token&&(r=t.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),t.persistence_name?"ph_"+t.persistence_name:"ph_"+r+"_posthog"})(e),this.storage=this.buildStorage(e),this.load(),e.debug&&fe.info("Persistence loaded",e.persistence,P({},this.props)),this.update_config(e,e),this.save()}buildStorage(e){Qc.indexOf(e.persistence.toLowerCase())===-1&&(fe.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return t==="localstorage"&&mt.is_supported()?mt:t==="localstorage+cookie"&&ai.is_supported()?ai:t==="sessionstorage"&&Tt.is_supported()?Tt:t==="memory"?$c:t==="cookie"?br:ai.is_supported()?ai:br}properties(){var e={};return Ke(this.props,function(t,r){if(r===nn&&dt(t))for(var s=Object.keys(t),a=0;a<s.length;a++)e["$feature/".concat(s[a])]=t[s[a]];else h=r,p=!1,(Ar(u=Ac)?p:Ca&&u.indexOf===Ca?u.indexOf(h)!=-1:(Ke(u,function(m){if(p||(p=m===h))return _i}),p))||(e[r]=t);var u,h,p}),e}load(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=Lt({},e))}}save(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure,this.config.debug)}remove(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}clear(){this.remove(),this.props={}}register_once(e,t,r){if(dt(e)){pe(t)&&(t="None"),this.expire_days=pe(r)?this.default_expiry:r;var s=!1;if(Ke(e,(a,u)=>{this.props.hasOwnProperty(u)&&this.props[u]!==t||(this.props[u]=a,s=!0)}),s)return this.save(),!0}return!1}register(e,t){if(dt(e)){this.expire_days=pe(t)?this.default_expiry:t;var r=!1;if(Ke(e,(s,a)=>{e.hasOwnProperty(a)&&this.props[a]!==s&&(this.props[a]=s,r=!0)}),r)return this.save(),!0}return!1}unregister(e){e in this.props&&(delete this.props[e],this.save())}update_campaign_params(){if(!this.campaign_params_saved){var e=lt.campaignParams(this.config.custom_campaign_params);rn(yi(e))||this.register(e),this.campaign_params_saved=!0}}update_search_keyword(){this.register(lt.searchInfo())}update_referrer_info(){this.register_once(lt.referrerInfo(),void 0)}set_initial_person_info(){this.props[Lo]||this.props[Po]||this.register_once({[Do]:lt.initialPersonInfo()},void 0)}get_referrer_info(){return yi({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}get_initial_props(){var e={};Ke([Po,Lo],s=>{var a=this.props[s];a&&Ke(a,function(u,h){e["$initial_"+Ro(h)]=u})});var t=this.props[Do];if(t){var r=lt.initialPersonPropsFromInfo(t);Lt(e,r)}return e}safe_merge(e){return Ke(this.props,function(t,r){r in e||(e[r]=t)}),e}update_config(e,t){if(this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var r=this.buildStorage(e),s=this.props;this.clear(),this.storage=r,this.props=s,this.save()}}set_disabled(e){this.disabled=e,this.disabled?this.remove():this.save()}set_cross_subdomain(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}get_cross_subdomain(){return!!this.cross_subdomain}set_secure(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}set_event_timer(e,t){var r=this.props[En]||{};r[e]=t,this.props[En]=r,this.save()}remove_event_timer(e){var t=(this.props[En]||{})[e];return pe(t)||(delete this.props[En][e],this.save()),t}get_property(e){return this.props[e]}set_property(e,t){this.props[e]=t,this.save()}}function Ti(n){var e,t;return((e=JSON.stringify(n,(t=[],function(r,s){if(dt(s)){for(;t.length>0&&t[t.length-1]!==this;)t.pop();return t.includes(s)?"[Circular]":(t.push(s),s)}return s})))===null||e===void 0?void 0:e.length)||0}function Wo(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:66060288e-1;if(n.size>=e&&n.data.length>1){var t=Math.floor(n.data.length/2),r=n.data.slice(0,t),s=n.data.slice(t);return[Wo({size:Ti(r),data:r,sessionId:n.sessionId,windowId:n.windowId}),Wo({size:Ti(s),data:s,sessionId:n.sessionId,windowId:n.windowId})].flatMap(a=>a)}return[n]}var vr=(n=>(n[n.DomContentLoaded=0]="DomContentLoaded",n[n.Load=1]="Load",n[n.FullSnapshot=2]="FullSnapshot",n[n.IncrementalSnapshot=3]="IncrementalSnapshot",n[n.Meta=4]="Meta",n[n.Custom=5]="Custom",n[n.Plugin=6]="Plugin",n))(vr||{}),or=(n=>(n[n.Mutation=0]="Mutation",n[n.MouseMove=1]="MouseMove",n[n.MouseInteraction=2]="MouseInteraction",n[n.Scroll=3]="Scroll",n[n.ViewportResize=4]="ViewportResize",n[n.Input=5]="Input",n[n.TouchMove=6]="TouchMove",n[n.MediaInteraction=7]="MediaInteraction",n[n.StyleSheetRule=8]="StyleSheetRule",n[n.CanvasMutation=9]="CanvasMutation",n[n.Font=10]="Font",n[n.Log=11]="Log",n[n.Drag=12]="Drag",n[n.StyleDeclaration=13]="StyleDeclaration",n[n.Selection=14]="Selection",n[n.AdoptedStyleSheet=15]="AdoptedStyleSheet",n[n.CustomElement=16]="CustomElement",n))(or||{});function za(n){var e;return n instanceof Element&&(n.id===Al||!((e=n.closest)===null||e===void 0||!e.call(n,".toolbar-global-fade-container")))}function Li(n){return!!n&&n.nodeType===1}function Mr(n,e){return!!n&&!!n.tagName&&n.tagName.toLowerCase()===e.toLowerCase()}function Yl(n){return!!n&&n.nodeType===3}function Zl(n){return!!n&&n.nodeType===11}function os(n){return n?Ni(n).split(/\s+/):[]}function Ya(n){var e=C?.location.href;return!!(e&&n&&n.some(t=>e.match(t)))}function xi(n){var e="";switch(typeof n.className){case"string":e=n.className;break;case"object":e=(n.className&&"baseVal"in n.className?n.className.baseVal:null)||n.getAttribute("class")||"";break;default:e=""}return os(e)}function Xl(n){return Qe(n)?null:Ni(n).split(/(\s+)/).filter(e=>dn(e)).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function Pi(n){var e="";return Go(n)&&!Ql(n)&&n.childNodes&&n.childNodes.length&&Ke(n.childNodes,function(t){var r;Yl(t)&&t.textContent&&(e+=(r=Xl(t.textContent))!==null&&r!==void 0?r:"")}),Ni(e)}function Jl(n){return pe(n.target)?n.srcElement||null:(e=n.target)!==null&&e!==void 0&&e.shadowRoot?n.composedPath()[0]||null:n.target||null;var e}var jo=["a","button","form","input","select","textarea","label"];function Kl(n){var e=n.parentNode;return!(!e||!Li(e))&&e}function ed(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;if(!C||!n||Mr(n,"html")||!Li(n)||t!=null&&t.url_allowlist&&!Ya(t.url_allowlist)||t!=null&&t.url_ignorelist&&Ya(t.url_ignorelist))return!1;if(t!=null&&t.dom_event_allowlist){var a=t.dom_event_allowlist;if(a&&!a.some(y=>e.type===y))return!1}for(var u=!1,h=[n],p=!0,m=n;m.parentNode&&!Mr(m,"body");)if(Zl(m.parentNode))h.push(m.parentNode.host),m=m.parentNode.host;else{if(!(p=Kl(m)))break;if(r||jo.indexOf(p.tagName.toLowerCase())>-1)u=!0;else{var g=C.getComputedStyle(p);g&&g.getPropertyValue("cursor")==="pointer"&&(u=!0)}h.push(p),m=p}if(!function(y,E){var T=E?.element_allowlist;if(pe(T))return!0;var z=function(ae){if(T.some(oe=>ae.tagName.toLowerCase()===oe))return{v:!0}};for(var j of y){var $=z(j);if(typeof $=="object")return $.v}return!1}(h,t)||!function(y,E){var T=E?.css_selector_allowlist;if(pe(T))return!0;var z=function(ae){if(T.some(oe=>ae.matches(oe)))return{v:!0}};for(var j of y){var $=z(j);if(typeof $=="object")return $.v}return!1}(h,t))return!1;var f=C.getComputedStyle(n);if(f&&f.getPropertyValue("cursor")==="pointer"&&e.type==="click")return!0;var b=n.tagName.toLowerCase();switch(b){case"html":return!1;case"form":return(s||["submit"]).indexOf(e.type)>=0;case"input":case"select":case"textarea":return(s||["change","click"]).indexOf(e.type)>=0;default:return u?(s||["click"]).indexOf(e.type)>=0:(s||["click"]).indexOf(e.type)>=0&&(jo.indexOf(b)>-1||n.getAttribute("contenteditable")==="true")}}function Go(n){for(var e=n;e.parentNode&&!Mr(e,"body");e=e.parentNode){var t=xi(e);if(De(t,"ph-sensitive")||De(t,"ph-no-capture"))return!1}if(De(xi(n),"ph-include"))return!0;var r=n.type||"";if(xt(r))switch(r.toLowerCase()){case"hidden":case"password":return!1}var s=n.name||n.id||"";return!(xt(s)&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(s.replace(/[^a-zA-Z0-9]/g,"")))}function Ql(n){return!!(Mr(n,"input")&&!["button","checkbox","submit","reset"].includes(n.type)||Mr(n,"select")||Mr(n,"textarea")||n.getAttribute("contenteditable")==="true")}var eu="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",td=new RegExp("^(?:".concat(eu,")$")),rd=new RegExp(eu),tu="\\d{3}-?\\d{2}-?\\d{4}",nd=new RegExp("^(".concat(tu,")$")),id=new RegExp("(".concat(tu,")"));function dn(n){var e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return!(Qe(n)||xt(n)&&(n=Ni(n),(e?td:rd).test((n||"").replace(/[- ]/g,""))||(e?nd:id).test(n)))}function ru(n){var e=Pi(n);return dn(e="".concat(e," ").concat(nu(n)).trim())?e:""}function nu(n){var e="";return n&&n.childNodes&&n.childNodes.length&&Ke(n.childNodes,function(t){var r;if(t&&((r=t.tagName)===null||r===void 0?void 0:r.toLowerCase())==="span")try{var s=Pi(t);e="".concat(e," ").concat(s).trim(),t.childNodes&&t.childNodes.length&&(e="".concat(e," ").concat(nu(t)).trim())}catch(a){fe.error("[AutoCapture]",a)}}),e}function od(n){return function(e){var t=e.map(r=>{var s,a,u="";if(r.tag_name&&(u+=r.tag_name),r.attr_class)for(var h of(r.attr_class.sort(),r.attr_class))u+=".".concat(h.replace(/"/g,""));var p=P(P(P(P({},r.text?{text:r.text}:{}),{},{"nth-child":(s=r.nth_child)!==null&&s!==void 0?s:0,"nth-of-type":(a=r.nth_of_type)!==null&&a!==void 0?a:0},r.href?{href:r.href}:{}),r.attr_id?{attr_id:r.attr_id}:{}),r.attributes),m={};return fi(p).sort((g,f)=>{var[b]=g,[y]=f;return b.localeCompare(y)}).forEach(g=>{var[f,b]=g;return m[Za(f.toString())]=Za(b.toString())}),u+=":",u+=fi(p).map(g=>{var[f,b]=g;return"".concat(f,'="').concat(b,'"')}).join("")});return t.join(";")}(function(e){return e.map(t=>{var r,s,a={text:(r=t.$el_text)===null||r===void 0?void 0:r.slice(0,400),tag_name:t.tag_name,href:(s=t.attr__href)===null||s===void 0?void 0:s.slice(0,2048),attr_class:sd(t),attr_id:t.attr__id,nth_child:t.nth_child,nth_of_type:t.nth_of_type,attributes:{}};return fi(t).filter(u=>{var[h]=u;return h.indexOf("attr__")===0}).forEach(u=>{var[h,p]=u;return a.attributes[h]=p}),a})}(n))}function Za(n){return n.replace(/"|\\"/g,'\\"')}function sd(n){var e=n.attr__class;return e?ht(e)?e:os(e):void 0}var qo="[SessionRecording]",Uo="redacted",ci={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:n=>n,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com"]},ad=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],ld=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],ud=["/s/","/e/","/i/"];function Xa(n,e,t,r){if(Qe(n))return n;var s=e?.["content-length"]||function(a){return new Blob([a]).size}(n);return xt(s)&&(s=parseInt(s)),s>t?qo+" ".concat(r," body too large to record (").concat(s," bytes)"):n}function Ja(n,e){if(Qe(n))return n;var t=n;return dn(t,!1)||(t=qo+" "+e+" body "+Uo),Ke(ld,r=>{var s,a;(s=t)!==null&&s!==void 0&&s.length&&((a=t)===null||a===void 0?void 0:a.indexOf(r))!==-1&&(t=qo+" "+e+" body "+Uo+" as might contain: "+r)}),t}var cd=(n,e)=>{var t,r,s,a={payloadSizeLimitBytes:ci.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...ci.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...ci.payloadHostDenyList]},u=n.session_recording.recordHeaders!==!1&&e.recordHeaders,h=n.session_recording.recordBody!==!1&&e.recordBody,p=n.capture_performance!==!1&&e.recordPerformance,m=(t=a,s=Math.min(1e6,(r=t.payloadSizeLimitBytes)!==null&&r!==void 0?r:1e6),b=>(b!=null&&b.requestBody&&(b.requestBody=Xa(b.requestBody,b.requestHeaders,s,"Request")),b!=null&&b.responseBody&&(b.responseBody=Xa(b.responseBody,b.responseHeaders,s,"Response")),b)),g=b=>{return m(((T,z)=>{var j,$=sn(T.name),ae=z.indexOf("http")===0?(j=sn(z))===null||j===void 0?void 0:j.pathname:z;ae==="/"&&(ae="");var oe=$?.pathname.replace(ae||"","");if(!($&&oe&&ud.some(Se=>oe.indexOf(Se)===0)))return T})((E=(y=b).requestHeaders,Qe(E)||Ke(Object.keys(E??{}),T=>{ad.includes(T.toLowerCase())&&(E[T]=Uo)}),y),n.api_host));var y,E},f=Jt(n.session_recording.maskNetworkRequestFn);return f&&Jt(n.session_recording.maskCapturedNetworkRequestFn)&&fe.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),f&&(n.session_recording.maskCapturedNetworkRequestFn=b=>{var y=n.session_recording.maskNetworkRequestFn({url:b.name});return P(P({},b),{},{name:y?.url})}),a.maskRequestFn=Jt(n.session_recording.maskCapturedNetworkRequestFn)?b=>{var y,E,T,z=g(b);return z&&(y=(E=(T=n.session_recording).maskCapturedNetworkRequestFn)===null||E===void 0?void 0:E.call(T,z))!==null&&y!==void 0?y:void 0}:b=>function(y){if(!pe(y))return y.requestBody=Ja(y.requestBody,"Request"),y.responseBody=Ja(y.responseBody,"Response"),y}(g(b)),P(P(P({},ci),a),{},{recordHeaders:u,recordBody:h,recordPerformance:p,recordInitialRequests:p})};function ur(n,e,t,r,s){return e>t&&(fe.warn("min cannot be greater than max."),e=t),Ft(n)?n>t?(r&&fe.warn(r+" cannot be  greater than max: "+t+". Using max value instead."),t):n<e?(r&&fe.warn(r+" cannot be less than min: "+e+". Using min value instead."),e):n:(r&&fe.warn(r+" must be a number. using max or fallback. max: "+t+", fallback: "+s),ur(s||t,e,t,r))}class dd{constructor(e){var t,r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};U(this,"bucketSize",100),U(this,"refillRate",10),U(this,"mutationBuckets",{}),U(this,"loggedTracker",{}),U(this,"refillBuckets",()=>{Object.keys(this.mutationBuckets).forEach(a=>{this.mutationBuckets[a]=this.mutationBuckets[a]+this.refillRate,this.mutationBuckets[a]>=this.bucketSize&&delete this.mutationBuckets[a]})}),U(this,"getNodeOrRelevantParent",a=>{var u=this.rrweb.mirror.getNode(a);if(u?.nodeName!=="svg"&&u instanceof Element){var h=u.closest("svg");if(h)return[this.rrweb.mirror.getId(h),h]}return[a,u]}),U(this,"numberOfChanges",a=>{var u,h,p,m,g,f,b,y;return((u=(h=a.removes)===null||h===void 0?void 0:h.length)!==null&&u!==void 0?u:0)+((p=(m=a.attributes)===null||m===void 0?void 0:m.length)!==null&&p!==void 0?p:0)+((g=(f=a.texts)===null||f===void 0?void 0:f.length)!==null&&g!==void 0?g:0)+((b=(y=a.adds)===null||y===void 0?void 0:y.length)!==null&&b!==void 0?b:0)}),U(this,"throttleMutations",a=>{if(a.type!==3||a.data.source!==0)return a;var u=a.data,h=this.numberOfChanges(u);u.attributes&&(u.attributes=u.attributes.filter(m=>{var g,f,b,[y,E]=this.getNodeOrRelevantParent(m.id);return this.mutationBuckets[y]===0?!1:(this.mutationBuckets[y]=(g=this.mutationBuckets[y])!==null&&g!==void 0?g:this.bucketSize,this.mutationBuckets[y]=Math.max(this.mutationBuckets[y]-1,0),this.mutationBuckets[y]===0&&(this.loggedTracker[y]||(this.loggedTracker[y]=!0,(f=(b=this.options).onBlockedNode)===null||f===void 0||f.call(b,y,E))),m)}));var p=this.numberOfChanges(u);return p!==0||h===p?a:void 0}),this.rrweb=e,this.options=s,this.refillRate=ur((t=this.options.refillRate)!==null&&t!==void 0?t:this.refillRate,0,100,"mutation throttling refill rate"),this.bucketSize=ur((r=this.options.bucketSize)!==null&&r!==void 0?r:this.bucketSize,0,100,"mutation throttling bucket size"),setInterval(()=>{this.refillBuckets()},1e3)}}var Qt=Uint8Array,Wt=Uint16Array,hn=Uint32Array,ss=new Qt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),as=new Qt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ka=new Qt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iu=function(n,e){for(var t=new Wt(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];var s=new hn(t[30]);for(r=1;r<30;++r)for(var a=t[r];a<t[r+1];++a)s[a]=a-t[r]<<5|r;return[t,s]},ou=iu(ss,2),hd=ou[0],Vo=ou[1];hd[28]=258,Vo[258]=28;for(var Qa=iu(as,0)[1],su=new Wt(32768),tt=0;tt<32768;++tt){var Pr=(43690&tt)>>>1|(21845&tt)<<1;Pr=(61680&(Pr=(52428&Pr)>>>2|(13107&Pr)<<2))>>>4|(3855&Pr)<<4,su[tt]=((65280&Pr)>>>8|(255&Pr)<<8)>>>1}var Mn=function(n,e,t){for(var r=n.length,s=0,a=new Wt(e);s<r;++s)++a[n[s]-1];var u,h=new Wt(e);for(s=0;s<e;++s)h[s]=h[s-1]+a[s-1]<<1;for(u=new Wt(r),s=0;s<r;++s)u[s]=su[h[n[s]-1]++]>>>15-n[s];return u},zr=new Qt(288);for(tt=0;tt<144;++tt)zr[tt]=8;for(tt=144;tt<256;++tt)zr[tt]=9;for(tt=256;tt<280;++tt)zr[tt]=7;for(tt=280;tt<288;++tt)zr[tt]=8;var Ri=new Qt(32);for(tt=0;tt<32;++tt)Ri[tt]=5;var pd=Mn(zr,9),gd=Mn(Ri,5),au=function(n){return(n/8>>0)+(7&n&&1)},lu=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof Wt?Wt:n instanceof hn?hn:Qt)(t-e);return r.set(n.subarray(e,t)),r},gr=function(n,e,t){t<<=7&e;var r=e/8>>0;n[r]|=t,n[r+1]|=t>>>8},wn=function(n,e,t){t<<=7&e;var r=e/8>>0;n[r]|=t,n[r+1]|=t>>>8,n[r+2]|=t>>>16},So=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var s=t.length,a=t.slice();if(!s)return[new Qt(0),0];if(s==1){var u=new Qt(t[0].s+1);return u[t[0].s]=1,[u,1]}t.sort(function(Se,qe){return Se.f-qe.f}),t.push({s:-1,f:25001});var h=t[0],p=t[1],m=0,g=1,f=2;for(t[0]={s:-1,f:h.f+p.f,l:h,r:p};g!=s-1;)h=t[t[m].f<t[f].f?m++:f++],p=t[m!=g&&t[m].f<t[f].f?m++:f++],t[g++]={s:-1,f:h.f+p.f,l:h,r:p};var b=a[0].s;for(r=1;r<s;++r)a[r].s>b&&(b=a[r].s);var y=new Wt(b+1),E=zo(t[g-1],y,0);if(E>e){r=0;var T=0,z=E-e,j=1<<z;for(a.sort(function(Se,qe){return y[qe.s]-y[Se.s]||Se.f-qe.f});r<s;++r){var $=a[r].s;if(!(y[$]>e))break;T+=j-(1<<E-y[$]),y[$]=e}for(T>>>=z;T>0;){var ae=a[r].s;y[ae]<e?T-=1<<e-y[ae]++-1:++r}for(;r>=0&&T;--r){var oe=a[r].s;y[oe]==e&&(--y[oe],++T)}E=e}return[new Qt(y),E]},zo=function(n,e,t){return n.s==-1?Math.max(zo(n.l,e,t+1),zo(n.r,e,t+1)):e[n.s]=t},el=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Wt(++e),r=0,s=n[0],a=1,u=function(p){t[r++]=p},h=1;h<=e;++h)if(n[h]==s&&h!=e)++a;else{if(!s&&a>2){for(;a>138;a-=138)u(32754);a>2&&(u(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(u(s),--a;a>6;a-=6)u(8304);a>2&&(u(a-3<<5|8208),a=0)}for(;a--;)u(s);a=1,s=n[h]}return[t.subarray(0,r),e]},Sn=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},Yo=function(n,e,t){var r=t.length,s=au(e+2);n[s]=255&r,n[s+1]=r>>>8,n[s+2]=255^n[s],n[s+3]=255^n[s+1];for(var a=0;a<r;++a)n[s+a+4]=t[a];return 8*(s+4+r)},tl=function(n,e,t,r,s,a,u,h,p,m,g){gr(e,g++,t),++s[256];for(var f=So(s,15),b=f[0],y=f[1],E=So(a,15),T=E[0],z=E[1],j=el(b),$=j[0],ae=j[1],oe=el(T),Se=oe[0],qe=oe[1],be=new Wt(19),Ce=0;Ce<$.length;++Ce)be[31&$[Ce]]++;for(Ce=0;Ce<Se.length;++Ce)be[31&Se[Ce]]++;for(var Re=So(be,7),je=Re[0],rt=Re[1],ct=19;ct>4&&!je[Ka[ct-1]];--ct);var pt,wt,_t,Ye,gt=m+5<<3,St=Sn(s,zr)+Sn(a,Ri)+u,It=Sn(s,b)+Sn(a,T)+u+14+3*ct+Sn(be,je)+(2*be[16]+3*be[17]+7*be[18]);if(gt<=St&&gt<=It)return Yo(e,g,n.subarray(p,p+m));if(gr(e,g,1+(It<St)),g+=2,It<St){pt=Mn(b,y),wt=b,_t=Mn(T,z),Ye=T;var Ct=Mn(je,rt);for(gr(e,g,ae-257),gr(e,g+5,qe-1),gr(e,g+10,ct-4),g+=14,Ce=0;Ce<ct;++Ce)gr(e,g+3*Ce,je[Ka[Ce]]);g+=3*ct;for(var zt=[$,Se],et=0;et<2;++et){var st=zt[et];for(Ce=0;Ce<st.length;++Ce){var Ze=31&st[Ce];gr(e,g,Ct[Ze]),g+=je[Ze],Ze>15&&(gr(e,g,st[Ce]>>>5&127),g+=st[Ce]>>>12)}}}else pt=pd,wt=zr,_t=gd,Ye=Ri;for(Ce=0;Ce<h;++Ce)if(r[Ce]>255){Ze=r[Ce]>>>18&31,wn(e,g,pt[Ze+257]),g+=wt[Ze+257],Ze>7&&(gr(e,g,r[Ce]>>>23&31),g+=ss[Ze]);var Xe=31&r[Ce];wn(e,g,_t[Xe]),g+=Ye[Xe],Xe>3&&(wn(e,g,r[Ce]>>>5&8191),g+=as[Xe])}else wn(e,g,pt[r[Ce]]),g+=wt[r[Ce]];return wn(e,g,pt[256]),g+wt[256]},fd=new hn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vd=function(){for(var n=new hn(256),e=0;e<256;++e){for(var t=e,r=9;--r;)t=(1&t&&3988292384)^t>>>1;n[e]=t}return n}(),md=function(){var n=4294967295;return{p:function(e){for(var t=n,r=0;r<e.length;++r)t=vd[255&t^e[r]]^t>>>8;n=t},d:function(){return 4294967295^n}}},_d=function(n,e,t,r,s){return function(a,u,h,p,m,g){var f=a.length,b=new Qt(p+f+5*(1+Math.floor(f/7e3))+m),y=b.subarray(p,b.length-m),E=0;if(!u||f<8)for(var T=0;T<=f;T+=65535){var z=T+65535;z<f?E=Yo(y,E,a.subarray(T,z)):(y[T]=g,E=Yo(y,E,a.subarray(T,f)))}else{for(var j=fd[u-1],$=j>>>13,ae=8191&j,oe=(1<<h)-1,Se=new Wt(32768),qe=new Wt(oe+1),be=Math.ceil(h/3),Ce=2*be,Re=function(ze){return(a[ze]^a[ze+1]<<be^a[ze+2]<<Ce)&oe},je=new hn(25e3),rt=new Wt(288),ct=new Wt(32),pt=0,wt=0,_t=(T=0,0),Ye=0,gt=0;T<f;++T){var St=Re(T),It=32767&T,Ct=qe[St];if(Se[It]=Ct,qe[St]=It,Ye<=T){var zt=f-T;if((pt>7e3||_t>24576)&&zt>423){E=tl(a,y,0,je,rt,ct,wt,_t,gt,T-gt,E),_t=pt=wt=0,gt=T;for(var et=0;et<286;++et)rt[et]=0;for(et=0;et<30;++et)ct[et]=0}var st=2,Ze=0,Xe=ae,Et=It-Ct&32767;if(zt>2&&St==Re(T-Et))for(var Gt=Math.min($,zt)-1,sr=Math.min(32767,T),Yt=Math.min(258,zt);Et<=sr&&--Xe&&It!=Ct;){if(a[T+st]==a[T+st-Et]){for(var O=0;O<Yt&&a[T+O]==a[T+O-Et];++O);if(O>st){if(st=O,Ze=Et,O>Gt)break;var x=Math.min(Et,O-2),D=0;for(et=0;et<x;++et){var W=T-Et+et+32768&32767,J=W-Se[W]+32768&32767;J>D&&(D=J,Ct=W)}}}Et+=(It=Ct)-(Ct=Se[It])+32768&32767}if(Ze){je[_t++]=268435456|Vo[st]<<18|Qa[Ze];var Ee=31&Vo[st],me=31&Qa[Ze];wt+=ss[Ee]+as[me],++rt[257+Ee],++ct[me],Ye=T+st,++pt}else je[_t++]=a[T],++rt[a[T]]}}E=tl(a,y,g,je,rt,ct,wt,_t,gt,T-gt,E)}return lu(b,0,p+au(E)+m)}(n,e.level==null?6:e.level,e.mem==null?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(n.length)))):12+e.mem,t,r,!s)},Zo=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},yd=function(n,e){var t=e.filename;if(n[0]=31,n[1]=139,n[2]=8,n[8]=e.level<2?4:e.level==9?2:0,n[9]=3,e.mtime!=0&&Zo(n,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){n[3]=8;for(var r=0;r<=t.length;++r)n[r+10]=t.charCodeAt(r)}},bd=function(n){return 10+(n.filename&&n.filename.length+1||0)};function uu(n,e){e===void 0&&(e={});var t=md(),r=n.length;t.p(n);var s=_d(n,e,bd(e),8),a=s.length;return yd(s,e),Zo(s,a-8,t.d()),Zo(s,a-4,r),s}function cu(n,e){var t=n.length;if(typeof TextEncoder<"u")return new TextEncoder().encode(n);for(var r=new Qt(n.length+(n.length>>>1)),s=0,a=function(m){r[s++]=m},u=0;u<t;++u){if(s+5>r.length){var h=new Qt(s+8+(t-u<<1));h.set(r),r=h}var p=n.charCodeAt(u);p<128||e?a(p):p<2048?(a(192|p>>>6),a(128|63&p)):p>55295&&p<57344?(a(240|(p=65536+(1047552&p)|1023&n.charCodeAt(++u))>>>18),a(128|p>>>12&63),a(128|p>>>6&63),a(128|63&p)):(a(224|p>>>12),a(128|p>>>6&63),a(128|63&p))}return lu(r,0,s)}var Rn="[SessionRecording]",Rt=jt(Rn),wd=3e5,Sd=[or.MouseMove,or.MouseInteraction,or.Scroll,or.ViewportResize,or.Input,or.TouchMove,or.MediaInteraction,or.Drag],rl=n=>({rrwebMethod:n,enqueuedAt:Date.now(),attempt:1});function Dr(n){return function(e,t){for(var r="",s=0;s<e.length;){var a=e[s++];r+=String.fromCharCode(a)}return r}(uu(cu(JSON.stringify(n))))}function nl(n){return n.type===vr.Custom&&n.data.tag==="sessionIdle"}function il(n,e){return e.some(t=>t.matching==="regex"&&new RegExp(t.url).test(n))}class Id{get sessionIdleThresholdMilliseconds(){return this.instance.config.session_recording.session_idle_threshold_ms||3e5}get rrwebRecord(){var e,t;return Le==null||(e=Le.__PosthogExtensions__)===null||e===void 0||(t=e.rrweb)===null||t===void 0?void 0:t.record}get started(){return this._captureStarted}get sessionManager(){if(!this.instance.sessionManager)throw new Error(Rn+" must be started with a valid sessionManager.");return this.instance.sessionManager}get fullSnapshotIntervalMillis(){var e,t;return this.triggerStatus==="trigger_pending"?6e4:(e=(t=this.instance.config.session_recording)===null||t===void 0?void 0:t.full_snapshot_interval_millis)!==null&&e!==void 0?e:wd}get isSampled(){var e=this.instance.get_property(kn);return qr(e)?e:null}get sessionDuration(){var e,t,r=(e=this.buffer)===null||e===void 0?void 0:e.data[((t=this.buffer)===null||t===void 0?void 0:t.data.length)-1],{sessionStartTimestamp:s}=this.sessionManager.checkAndGetSessionAndWindowId(!0);return r?r.timestamp-s:null}get isRecordingEnabled(){var e=!!this.instance.get_property(Ao),t=!this.instance.config.disable_session_recording;return C&&e&&t}get isConsoleLogCaptureEnabled(){var e=!!this.instance.get_property(Oa),t=this.instance.config.enable_recording_console_log;return t??e}get canvasRecording(){var e,t,r,s,a,u,h=this.instance.config.session_recording.captureCanvas,p=this.instance.get_property(Fa),m=(e=(t=h?.recordCanvas)!==null&&t!==void 0?t:p?.enabled)!==null&&e!==void 0&&e,g=(r=(s=h?.canvasFps)!==null&&s!==void 0?s:p?.fps)!==null&&r!==void 0?r:0,f=(a=(u=h?.canvasQuality)!==null&&u!==void 0?u:p?.quality)!==null&&a!==void 0?a:0;return{enabled:m,fps:ur(g,0,12,"canvas recording fps"),quality:ur(f,0,1,"canvas recording quality")}}get networkPayloadCapture(){var e,t,r=this.instance.get_property(Na),s={recordHeaders:(e=this.instance.config.session_recording)===null||e===void 0?void 0:e.recordHeaders,recordBody:(t=this.instance.config.session_recording)===null||t===void 0?void 0:t.recordBody},a=s?.recordHeaders||r?.recordHeaders,u=s?.recordBody||r?.recordBody,h=dt(this.instance.config.capture_performance)?this.instance.config.capture_performance.network_timing:this.instance.config.capture_performance,p=!!(qr(h)?h:r?.capturePerformance);return a||u||p?{recordHeaders:a,recordBody:u,recordPerformance:p}:void 0}get sampleRate(){var e=this.instance.get_property(La);return Ft(e)?e:null}get minimumDuration(){var e=this.instance.get_property(Pa);return Ft(e)?e:null}get status(){return this.receivedDecide?this.isRecordingEnabled?this._urlBlocked?"paused":Qe(this._linkedFlag)||this._linkedFlagSeen?this.triggerStatus==="trigger_pending"?"buffering":qr(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}get urlTriggerStatus(){var e;return this._urlTriggers.length===0?"trigger_disabled":((e=this.instance)===null||e===void 0?void 0:e.get_property(vo))===this.sessionId?"trigger_activated":"trigger_pending"}get eventTriggerStatus(){var e;return this._eventTriggers.length===0?"trigger_disabled":((e=this.instance)===null||e===void 0?void 0:e.get_property(mo))===this.sessionId?"trigger_activated":"trigger_pending"}get triggerStatus(){var e=this.eventTriggerStatus==="trigger_activated"||this.urlTriggerStatus==="trigger_activated",t=this.eventTriggerStatus==="trigger_pending"||this.urlTriggerStatus==="trigger_pending";return e?"trigger_activated":t?"trigger_pending":"trigger_disabled"}constructor(e){if(U(this,"queuedRRWebEvents",[]),U(this,"isIdle",!1),U(this,"_linkedFlagSeen",!1),U(this,"_lastActivityTimestamp",Date.now()),U(this,"_linkedFlag",null),U(this,"_removePageViewCaptureHook",void 0),U(this,"_onSessionIdListener",void 0),U(this,"_persistDecideOnSessionListener",void 0),U(this,"_samplingSessionListener",void 0),U(this,"_urlTriggers",[]),U(this,"_urlBlocklist",[]),U(this,"_urlBlocked",!1),U(this,"_eventTriggers",[]),U(this,"_removeEventTriggerCaptureHook",void 0),U(this,"_forceAllowLocalhostNetworkCapture",!1),U(this,"_onBeforeUnload",()=>{this._flushBuffer()}),U(this,"_onOffline",()=>{this._tryAddCustomEvent("browser offline",{})}),U(this,"_onOnline",()=>{this._tryAddCustomEvent("browser online",{})}),U(this,"_onVisibilityChange",()=>{if(he!=null&&he.visibilityState){var s="window "+he.visibilityState;this._tryAddCustomEvent(s,{})}}),this.instance=e,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,!this.instance.sessionManager)throw Rt.error("started without valid sessionManager"),new Error(Rn+" started without valid sessionManager. This is a bug.");if(this.instance.config.__preview_experimental_cookieless_mode)throw new Error(Rn+" cannot be used with __preview_experimental_cookieless_mode.");var{sessionId:t,windowId:r}=this.sessionManager.checkAndGetSessionAndWindowId();this.sessionId=t,this.windowId=r,this.buffer=this.clearBuffer(),this.sessionIdleThresholdMilliseconds>=this.sessionManager.sessionTimeoutMs&&Rt.warn("session_idle_threshold_ms (".concat(this.sessionIdleThresholdMilliseconds,") is greater than the session timeout (").concat(this.sessionManager.sessionTimeoutMs,"). Session will never be detected as idle"))}startIfEnabledOrStop(e){this.isRecordingEnabled?(this._startCapture(e),C?.addEventListener("beforeunload",this._onBeforeUnload),C?.addEventListener("offline",this._onOffline),C?.addEventListener("online",this._onOnline),C?.addEventListener("visibilitychange",this._onVisibilityChange),this._setupSampling(),this._addEventTriggerListener(),Qe(this._removePageViewCaptureHook)&&(this._removePageViewCaptureHook=this.instance.on("eventCaptured",t=>{try{if(t.event==="$pageview"){var r=t!=null&&t.properties.$current_url?this._maskUrl(t?.properties.$current_url):"";if(!r)return;this._tryAddCustomEvent("$pageview",{href:r})}}catch(s){Rt.error("Could not add $pageview to rrweb session",s)}})),this._onSessionIdListener||(this._onSessionIdListener=this.sessionManager.onSessionId((t,r,s)=>{var a,u,h,p;s&&(this._tryAddCustomEvent("$session_id_change",{sessionId:t,windowId:r,changeReason:s}),(a=this.instance)===null||a===void 0||(u=a.persistence)===null||u===void 0||u.unregister(mo),(h=this.instance)===null||h===void 0||(p=h.persistence)===null||p===void 0||p.unregister(vo))}))):this.stopRecording()}stopRecording(){var e,t,r,s;this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,C?.removeEventListener("beforeunload",this._onBeforeUnload),C?.removeEventListener("offline",this._onOffline),C?.removeEventListener("online",this._onOnline),C?.removeEventListener("visibilitychange",this._onVisibilityChange),this.clearBuffer(),clearInterval(this._fullSnapshotTimer),(e=this._removePageViewCaptureHook)===null||e===void 0||e.call(this),this._removePageViewCaptureHook=void 0,(t=this._removeEventTriggerCaptureHook)===null||t===void 0||t.call(this),this._removeEventTriggerCaptureHook=void 0,(r=this._onSessionIdListener)===null||r===void 0||r.call(this),this._onSessionIdListener=void 0,(s=this._samplingSessionListener)===null||s===void 0||s.call(this),this._samplingSessionListener=void 0,Rt.info("stopped"))}makeSamplingDecision(e){var t,r=this.sessionId!==e,s=this.sampleRate;if(Ft(s)){var a,u=this.isSampled,h=r||!qr(u);h?a=Math.random()<s:a=u,h&&(a?this._reportStarted("sampled"):Rt.warn("Sample rate (".concat(s,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:s,isSampled:a})),(t=this.instance.persistence)===null||t===void 0||t.register({[kn]:a})}else{var p;(p=this.instance.persistence)===null||p===void 0||p.register({[kn]:null})}}onRemoteConfig(e){var t,r,s,a,u,h;if(this._tryAddCustomEvent("$remote_config_received",e),this._persistRemoteConfig(e),this._linkedFlag=((t=e.sessionRecording)===null||t===void 0?void 0:t.linkedFlag)||null,(r=e.sessionRecording)!==null&&r!==void 0&&r.endpoint&&(this._endpoint=(h=e.sessionRecording)===null||h===void 0?void 0:h.endpoint),this._setupSampling(),!Qe(this._linkedFlag)&&!this._linkedFlagSeen){var p=xt(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,m=xt(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags((g,f)=>{var b=dt(f)&&p in f,y=m?f[p]===m:b;y&&this._reportStarted("linked_flag_matched",{linkedFlag:p,linkedVariant:m}),this._linkedFlagSeen=y})}(s=e.sessionRecording)!==null&&s!==void 0&&s.urlTriggers&&(this._urlTriggers=e.sessionRecording.urlTriggers),(a=e.sessionRecording)!==null&&a!==void 0&&a.urlBlocklist&&(this._urlBlocklist=e.sessionRecording.urlBlocklist),(u=e.sessionRecording)!==null&&u!==void 0&&u.eventTriggers&&(this._eventTriggers=e.sessionRecording.eventTriggers),this.receivedDecide=!0,this.startIfEnabledOrStop()}_setupSampling(){Ft(this.sampleRate)&&Qe(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId(e=>{this.makeSamplingDecision(e)}))}_persistRemoteConfig(e){if(this.instance.persistence){var t,r=this.instance.persistence,s=()=>{var a,u,h,p,m,g,f,b,y=(a=e.sessionRecording)===null||a===void 0?void 0:a.sampleRate,E=Qe(y)?null:parseFloat(y),T=(u=e.sessionRecording)===null||u===void 0?void 0:u.minimumDurationMilliseconds;r.register({[Ao]:!!e.sessionRecording,[Oa]:(h=e.sessionRecording)===null||h===void 0?void 0:h.consoleLogRecordingEnabled,[Na]:P({capturePerformance:e.capturePerformance},(p=e.sessionRecording)===null||p===void 0?void 0:p.networkPayloadCapture),[Fa]:{enabled:(m=e.sessionRecording)===null||m===void 0?void 0:m.recordCanvas,fps:(g=e.sessionRecording)===null||g===void 0?void 0:g.canvasFps,quality:(f=e.sessionRecording)===null||f===void 0?void 0:f.canvasQuality},[La]:E,[Pa]:pe(T)?null:T,[Da]:(b=e.sessionRecording)===null||b===void 0?void 0:b.scriptConfig})};s(),(t=this._persistDecideOnSessionListener)===null||t===void 0||t.call(this),this._persistDecideOnSessionListener=this.sessionManager.onSessionId(s)}}log(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"log";(t=this.instance.sessionRecording)===null||t===void 0||t.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:r,trace:[],payload:[JSON.stringify(e)]}},timestamp:Date.now()})}_startCapture(e){if(!pe(Object.assign)&&!pe(Array.from)&&!(this._captureStarted||this.instance.config.disable_session_recording||this.instance.consent.isOptedOut())){var t,r;this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord?this._onScriptLoaded():(t=Le.__PosthogExtensions__)===null||t===void 0||(r=t.loadExternalDependency)===null||r===void 0||r.call(t,this.instance,this.scriptName,s=>{if(s)return Rt.error("could not load recorder",s);this._onScriptLoaded()}),Rt.info("starting"),this.status==="active"&&this._reportStarted(e||"recording_initialized")}}get scriptName(){var e,t,r;return((e=this.instance)===null||e===void 0||(t=e.persistence)===null||t===void 0||(r=t.get_property(Da))===null||r===void 0?void 0:r.script)||"recorder"}isInteractiveEvent(e){var t;return e.type===3&&Sd.indexOf((t=e.data)===null||t===void 0?void 0:t.source)!==-1}_updateWindowAndSessionIds(e){var t=this.isInteractiveEvent(e);t||this.isIdle||e.timestamp-this._lastActivityTimestamp>this.sessionIdleThresholdMilliseconds&&(this.isIdle=!0,clearInterval(this._fullSnapshotTimer),this._tryAddCustomEvent("sessionIdle",{eventTimestamp:e.timestamp,lastActivityTimestamp:this._lastActivityTimestamp,threshold:this.sessionIdleThresholdMilliseconds,bufferLength:this.buffer.data.length,bufferSize:this.buffer.size}),this._flushBuffer());var r=!1;if(t&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),r=!0)),!this.isIdle){var{windowId:s,sessionId:a}=this.sessionManager.checkAndGetSessionAndWindowId(!t,e.timestamp),u=this.sessionId!==a,h=this.windowId!==s;this.windowId=s,this.sessionId=a,u||h?(this.stopRecording(),this.startIfEnabledOrStop("session_id_changed")):r&&this._scheduleFullSnapshot()}}_tryRRWebMethod(e){try{return e.rrwebMethod(),!0}catch(t){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):Rt.warn("could not emit queued rrweb event.",t,e),!1}}_tryAddCustomEvent(e,t){return this._tryRRWebMethod(rl(()=>this.rrwebRecord.addCustomEvent(e,t)))}_tryTakeFullSnapshot(){return this._tryRRWebMethod(rl(()=>this.rrwebRecord.takeFullSnapshot()))}_onScriptLoaded(){var e,t={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},r=this.instance.config.session_recording;for(var[s,a]of Object.entries(r||{}))s in t&&(s==="maskInputOptions"?t.maskInputOptions=P({password:!0},a):t[s]=a);if(this.canvasRecording&&this.canvasRecording.enabled&&(t.recordCanvas=!0,t.sampling={canvas:this.canvasRecording.fps},t.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=(e=this.mutationRateLimiter)!==null&&e!==void 0?e:new dd(this.rrwebRecord,{refillRate:this.instance.config.session_recording.__mutationRateLimiterRefillRate,bucketSize:this.instance.config.session_recording.__mutationRateLimiterBucketSize,onBlockedNode:(h,p)=>{var m="Too many mutations on node '".concat(h,"'. Rate limiting. This could be due to SVG animations or something similar");Rt.info(m,{node:p}),this.log(Rn+" "+m,"warn")}});var u=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(P({emit:h=>{this.onRRwebEmit(h)},plugins:u},t)),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:t,activePlugins:u.map(h=>h?.name)}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else Rt.error("onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}_scheduleFullSnapshot(){if(this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),!this.isIdle){var e=this.fullSnapshotIntervalMillis;e&&(this._fullSnapshotTimer=setInterval(()=>{this._tryTakeFullSnapshot()},e))}}_gatherRRWebPlugins(){var e,t,r,s,a=[],u=(e=Le.__PosthogExtensions__)===null||e===void 0||(t=e.rrwebPlugins)===null||t===void 0?void 0:t.getRecordConsolePlugin;u&&this.isConsoleLogCaptureEnabled&&a.push(u());var h=(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.rrwebPlugins)===null||s===void 0?void 0:s.getRecordNetworkPlugin;return this.networkPayloadCapture&&Jt(h)&&(!Wc.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?a.push(h(cd(this.instance.config,this.networkPayloadCapture))):Rt.info("NetworkCapture not started because we are on localhost.")),a}onRRwebEmit(e){var t;if(this._processQueuedEvents(),e&&dt(e)){if(e.type===vr.Meta){var r=this._maskUrl(e.data.href);if(this._lastHref=r,!r)return;e.data.href=r}else this._pageViewFallBack();if(this._checkUrlTriggerConditions(),this.status!=="paused"||function(f){return f.type===vr.Custom&&f.data.tag==="recording paused"}(e)){e.type===vr.FullSnapshot&&this._scheduleFullSnapshot(),e.type===vr.FullSnapshot&&this.triggerStatus==="trigger_pending"&&this.clearBuffer();var s=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(s){var a=function(f){var b=f;if(b&&dt(b)&&b.type===6&&dt(b.data)&&b.data.plugin==="rrweb/console@1"){b.data.payload.payload.length>10&&(b.data.payload.payload=b.data.payload.payload.slice(0,10),b.data.payload.payload.push("...[truncated]"));for(var y=[],E=0;E<b.data.payload.payload.length;E++)b.data.payload.payload[E]&&b.data.payload.payload[E].length>2e3?y.push(b.data.payload.payload[E].slice(0,2e3)+"...[truncated]"):y.push(b.data.payload.payload[E]);return b.data.payload.payload=y,f}return f}(s);if(this._updateWindowAndSessionIds(a),!this.isIdle||nl(a)){if(nl(a)){var u=a.data.payload;if(u){var h=u.lastActivityTimestamp,p=u.threshold;a.timestamp=h+p}}var m=(t=this.instance.config.session_recording.compress_events)===null||t===void 0||t?function(f){if(Ti(f)<1024)return f;try{if(f.type===vr.FullSnapshot)return P(P({},f),{},{data:Dr(f.data),cv:"2024-10"});if(f.type===vr.IncrementalSnapshot&&f.data.source===or.Mutation)return P(P({},f),{},{cv:"2024-10",data:P(P({},f.data),{},{texts:Dr(f.data.texts),attributes:Dr(f.data.attributes),removes:Dr(f.data.removes),adds:Dr(f.data.adds)})});if(f.type===vr.IncrementalSnapshot&&f.data.source===or.StyleSheetRule)return P(P({},f),{},{cv:"2024-10",data:P(P({},f.data),{},{adds:Dr(f.data.adds),removes:Dr(f.data.removes)})})}catch(b){Rt.error("could not compress event - will use uncompressed event",b)}return f}(a):a,g={$snapshot_bytes:Ti(m),$snapshot_data:m,$session_id:this.sessionId,$window_id:this.windowId};this.status!=="disabled"?this._captureSnapshotBuffered(g):this.clearBuffer()}}}}}_pageViewFallBack(){if(!this.instance.config.capture_pageview&&C){var e=this._maskUrl(C.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}_processQueuedEvents(){if(this.queuedRRWebEvents.length){var e=[...this.queuedRRWebEvents];this.queuedRRWebEvents=[],e.forEach(t=>{Date.now()-t.enqueuedAt<=2e3&&this._tryRRWebMethod(t)})}}_maskUrl(e){var t=this.instance.config.session_recording;if(t.maskNetworkRequestFn){var r,s={url:e};return(r=s=t.maskNetworkRequestFn(s))===null||r===void 0?void 0:r.url}return e}clearBuffer(){return this.buffer={size:0,data:[],sessionId:this.sessionId,windowId:this.windowId},this.buffer}_flushBuffer(){this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var e=this.minimumDuration,t=this.sessionDuration,r=Ft(t)&&t>=0,s=Ft(e)&&r&&t<e;return this.status==="buffering"||this.status==="paused"||s?(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3),this.buffer):(this.buffer.data.length>0&&Wo(this.buffer).forEach(a=>{this._captureSnapshot({$snapshot_bytes:a.size,$snapshot_data:a.data,$session_id:a.sessionId,$window_id:a.windowId,$lib:"web",$lib_version:_r.LIB_VERSION})}),this.clearBuffer())}_captureSnapshotBuffered(e){var t,r=2+(((t=this.buffer)===null||t===void 0?void 0:t.data.length)||0);!this.isIdle&&(this.buffer.size+e.$snapshot_bytes+r>943718.4||this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||this.isIdle||(this.flushBufferTimer=setTimeout(()=>{this._flushBuffer()},2e3))}_captureSnapshot(e){this.instance.capture("$snapshot",e,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}_checkUrlTriggerConditions(){if(C!==void 0&&C.location.href){var e=C.location.href,t=this.status==="paused",r=il(e,this._urlBlocklist);r&&!t?this._pauseRecording():!r&&t&&this._resumeRecording(),il(e,this._urlTriggers)&&this._activateTrigger("url")}}_activateTrigger(e){var t,r;this.triggerStatus==="trigger_pending"&&((t=this.instance)===null||t===void 0||(r=t.persistence)===null||r===void 0||r.register({[e==="url"?vo:mo]:this.sessionId}),this._flushBuffer(),this._reportStarted(e+"_trigger_matched"))}_pauseRecording(){this.status!=="paused"&&(this._urlBlocked=!0,clearInterval(this._fullSnapshotTimer),Rt.info("recording paused due to URL blocker"),this._tryAddCustomEvent("recording paused",{reason:"url blocker"}))}_resumeRecording(){this.status==="paused"&&(this._urlBlocked=!1,this._tryTakeFullSnapshot(),this._scheduleFullSnapshot(),this._tryAddCustomEvent("recording resumed",{reason:"left blocked url"}),Rt.info("recording resumed"))}_addEventTriggerListener(){this._eventTriggers.length!==0&&Qe(this._removeEventTriggerCaptureHook)&&(this._removeEventTriggerCaptureHook=this.instance.on("eventCaptured",e=>{try{this._eventTriggers.includes(e.event)&&this._activateTrigger("event")}catch(t){Rt.error("Could not activate event trigger",t)}}))}overrideLinkedFlag(){this._linkedFlagSeen=!0,this._reportStarted("linked_flag_overridden")}overrideSampling(){var e;(e=this.instance.persistence)===null||e===void 0||e.register({[kn]:!0}),this._reportStarted("sampling_overridden")}overrideTrigger(e){this._activateTrigger(e)}_reportStarted(e,t){this.instance.register_for_session({$session_recording_start_reason:e}),Rt.info(e.replace("_"," "),t),De(["recording_initialized","session_id_changed"],e)||this._tryAddCustomEvent(e,t)}}var Br=jt("[RemoteConfig]");class Cd{constructor(e){this.instance=e}get remoteConfig(){var e,t;return(e=Le._POSTHOG_REMOTE_CONFIG)===null||e===void 0||(t=e[this.instance.config.token])===null||t===void 0?void 0:t.config}_loadRemoteConfigJs(e){var t,r,s;(t=Le.__PosthogExtensions__)!==null&&t!==void 0&&t.loadExternalDependency?(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.loadExternalDependency)===null||s===void 0||s.call(r,this.instance,"remote-config",()=>e(this.remoteConfig)):(Br.error("PostHog Extensions not found. Cannot load remote config."),e())}_loadRemoteConfigJSON(e){this.instance._send_request({method:"GET",url:this.instance.requestRouter.endpointFor("assets","/array/".concat(this.instance.config.token,"/config")),callback:t=>{e(t.json)}})}load(){try{if(this.remoteConfig)return Br.info("Using preloaded remote config",this.remoteConfig),void this.onRemoteConfig(this.remoteConfig);if(this.instance.config.advanced_disable_decide)return void Br.warn("Remote config is disabled. Falling back to local config.");this._loadRemoteConfigJs(e=>{if(!e)return Br.info("No config found after loading remote JS config. Falling back to JSON."),void this._loadRemoteConfigJSON(t=>{this.onRemoteConfig(t)});this.onRemoteConfig(e)})}catch(e){Br.error("Error loading remote config",e)}}onRemoteConfig(e){e?this.instance.config.__preview_remote_config?(this.instance._onRemoteConfig(e),e.hasFeatureFlags!==!1&&this.instance.featureFlags.ensureFlagsLoaded()):Br.info("__preview_remote_config is disabled. Logging config instead",e):Br.error("Failed to fetch remote config from PostHog.")}}var mr,Ed=C!=null&&C.location?Ei(C.location.hash,"__posthog")||Ei(location.hash,"state"):null,ol="_postHogToolbarParams";(function(n){n[n.UNINITIALIZED=0]="UNINITIALIZED",n[n.LOADING=1]="LOADING",n[n.LOADED=2]="LOADED"})(mr||(mr={}));class kd{constructor(e){this.instance=e}setToolbarState(e){Le.ph_toolbar_state=e}getToolbarState(){var e;return(e=Le.ph_toolbar_state)!==null&&e!==void 0?e:mr.UNINITIALIZED}maybeLoadToolbar(){var e,t,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(!C||!he)return!1;r=(e=r)!==null&&e!==void 0?e:C.location,a=(t=a)!==null&&t!==void 0?t:C.history;try{if(!s){try{C.localStorage.setItem("test","test"),C.localStorage.removeItem("test")}catch{return!1}s=C?.localStorage}var u,h=Ed||Ei(r.hash,"__posthog")||Ei(r.hash,"state"),p=h?Ta(()=>JSON.parse(atob(decodeURIComponent(h))))||Ta(()=>JSON.parse(decodeURIComponent(h))):null;return p&&p.action==="ph_authorize"?((u=p).source="url",u&&Object.keys(u).length>0&&(p.desiredHash?r.hash=p.desiredHash:a?a.replaceState(a.state,"",r.pathname+r.search):r.hash="")):((u=JSON.parse(s.getItem(ol)||"{}")).source="localstorage",delete u.userIntent),!(!u.token||this.instance.config.token!==u.token)&&(this.loadToolbar(u),!0)}catch{return!1}}_callLoadToolbar(e){(Le.ph_load_toolbar||Le.ph_load_editor)(e,this.instance)}loadToolbar(e){var t=!(he==null||!he.getElementById(Al));if(!C||t)return!1;var r=this.instance.requestRouter.region==="custom"&&this.instance.config.advanced_disable_toolbar_metrics,s=P(P({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},r?{instrument:!1}:{});if(C.localStorage.setItem(ol,JSON.stringify(P(P({},s),{},{source:void 0}))),this.getToolbarState()===mr.LOADED)this._callLoadToolbar(s);else if(this.getToolbarState()===mr.UNINITIALIZED){var a,u;this.setToolbarState(mr.LOADING),(a=Le.__PosthogExtensions__)===null||a===void 0||(u=a.loadExternalDependency)===null||u===void 0||u.call(a,this.instance,"toolbar",h=>{if(h)return fe.error("[Toolbar] Failed to load",h),void this.setToolbarState(mr.UNINITIALIZED);this.setToolbarState(mr.LOADED),this._callLoadToolbar(s)}),yr(C,"turbolinks:load",()=>{this.setToolbarState(mr.UNINITIALIZED),this.loadToolbar(s)})}return!0}_loadEditor(e){return this.loadToolbar(e)}maybeLoadEditor(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;return this.maybeLoadToolbar(e,t,r)}}class Td{constructor(e){U(this,"isPaused",!0),U(this,"queue",[]),U(this,"flushTimeoutMs",3e3),this.sendRequest=e}enqueue(e){this.queue.push(e),this.flushTimeout||this.setFlushTimeout()}unload(){this.clearFlushTimeout();var e=this.queue.length>0?this.formatQueue():{},t=Object.values(e),r=[...t.filter(s=>s.url.indexOf("/e")===0),...t.filter(s=>s.url.indexOf("/e")!==0)];r.map(s=>{this.sendRequest(P(P({},s),{},{transport:"sendBeacon"}))})}enable(){this.isPaused=!1,this.setFlushTimeout()}setFlushTimeout(){var e=this;this.isPaused||(this.flushTimeout=setTimeout(()=>{if(this.clearFlushTimeout(),this.queue.length>0){var t=this.formatQueue(),r=function(a){var u=t[a],h=new Date().getTime();u.data&&ht(u.data)&&Ke(u.data,p=>{p.offset=Math.abs(p.timestamp-h),delete p.timestamp}),e.sendRequest(u)};for(var s in t)r(s)}},this.flushTimeoutMs))}clearFlushTimeout(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}formatQueue(){var e={};return Ke(this.queue,t=>{var r,s=t,a=(s?s.batchKey:null)||s.url;pe(e[a])&&(e[a]=P(P({},s),{},{data:[]})),(r=e[a].data)===null||r===void 0||r.push(s.data)}),this.queue=[],e}}var xd=function(n){var e,t,r,s,a="";for(e=t=0,r=(n=(n+"").replace(/\r\n/g,`
`).replace(/\r/g,`
`)).length,s=0;s<r;s++){var u=n.charCodeAt(s),h=null;u<128?t++:h=u>127&&u<2048?String.fromCharCode(u>>6|192,63&u|128):String.fromCharCode(u>>12|224,u>>6&63|128,63&u|128),Ar(h)||(t>e&&(a+=n.substring(e,t)),a+=h,e=t=s+1)}return t>e&&(a+=n.substring(e,n.length)),a},Rd=!!xo||!!To,sl="text/plain",Mi=(n,e)=>{var[t,r]=n.split("?"),s=P({},e);r?.split("&").forEach(u=>{var[h]=u.split("=");delete s[h]});var a=jc(s);return a=a?(r?r+"&":"")+a:r,"".concat(t,"?").concat(a)},di=(n,e)=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString():r,e),Io=n=>{var{data:e,compression:t}=n;if(e){if(t===ar.GZipJS){var r=uu(cu(di(e)),{mtime:0}),s=new Blob([r],{type:sl});return{contentType:sl,body:s,estimatedSize:s.size}}if(t===ar.Base64){var a=function(p){var m,g,f,b,y,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",T=0,z=0,j="",$=[];if(!p)return p;p=xd(p);do m=(y=p.charCodeAt(T++)<<16|p.charCodeAt(T++)<<8|p.charCodeAt(T++))>>18&63,g=y>>12&63,f=y>>6&63,b=63&y,$[z++]=E.charAt(m)+E.charAt(g)+E.charAt(f)+E.charAt(b);while(T<p.length);switch(j=$.join(""),p.length%3){case 1:j=j.slice(0,-2)+"==";break;case 2:j=j.slice(0,-1)+"="}return j}(di(e)),u=(p=>"data="+encodeURIComponent(typeof p=="string"?p:di(p)))(a);return{contentType:"application/x-www-form-urlencoded",body:u,estimatedSize:new Blob([u]).size}}var h=di(e);return{contentType:"application/json",body:h,estimatedSize:new Blob([h]).size}}},An=[];To&&An.push({transport:"fetch",method:n=>{var e,t,{contentType:r,body:s,estimatedSize:a}=(e=Io(n))!==null&&e!==void 0?e:{},u=new Headers;Ke(n.headers,function(g,f){u.append(f,g)}),r&&u.append("Content-Type",r);var h=n.url,p=null;if(Ea){var m=new Ea;p={signal:m.signal,timeout:setTimeout(()=>m.abort(),n.timeout)}}To(h,P({method:n?.method||"GET",headers:u,keepalive:n.method==="POST"&&(a||0)<52428.8,body:s,signal:(t=p)===null||t===void 0?void 0:t.signal},n.fetchOptions)).then(g=>g.text().then(f=>{var b,y={statusCode:g.status,text:f};if(g.status===200)try{y.json=JSON.parse(f)}catch(E){fe.error(E)}(b=n.callback)===null||b===void 0||b.call(n,y)})).catch(g=>{var f;fe.error(g),(f=n.callback)===null||f===void 0||f.call(n,{statusCode:0,text:g})}).finally(()=>p?clearTimeout(p.timeout):null)}}),xo&&An.push({transport:"XHR",method:n=>{var e,t=new xo;t.open(n.method||"GET",n.url,!0);var{contentType:r,body:s}=(e=Io(n))!==null&&e!==void 0?e:{};Ke(n.headers,function(a,u){t.setRequestHeader(u,a)}),r&&t.setRequestHeader("Content-Type",r),n.timeout&&(t.timeout=n.timeout),t.withCredentials=!0,t.onreadystatechange=()=>{if(t.readyState===4){var a,u={statusCode:t.status,text:t.responseText};if(t.status===200)try{u.json=JSON.parse(t.responseText)}catch{}(a=n.callback)===null||a===void 0||a.call(n,u)}},t.send(s)}}),Vt!=null&&Vt.sendBeacon&&An.push({transport:"sendBeacon",method:n=>{var e=Mi(n.url,{beacon:"1"});try{var t,{contentType:r,body:s}=(t=Io(n))!==null&&t!==void 0?t:{},a=typeof s=="string"?new Blob([s],{type:r}):s;Vt.sendBeacon(e,a)}catch{}}});var Md=["retriesPerformedSoFar"];class Ad{constructor(e){U(this,"isPolling",!1),U(this,"pollIntervalMs",3e3),U(this,"queue",[]),this.instance=e,this.queue=[],this.areWeOnline=!0,!pe(C)&&"onLine"in C.navigator&&(this.areWeOnline=C.navigator.onLine,C.addEventListener("online",()=>{this.areWeOnline=!0,this.flush()}),C.addEventListener("offline",()=>{this.areWeOnline=!1}))}retriableRequest(e){var{retriesPerformedSoFar:t}=e,r=Il(e,Md);Ft(t)&&t>0&&(r.url=Mi(r.url,{retry_count:t})),this.instance._send_request(P(P({},r),{},{callback:s=>{var a;s.statusCode!==200&&(s.statusCode<400||s.statusCode>=500)&&(t??0)<10?this.enqueue(P({retriesPerformedSoFar:t},r)):(a=r.callback)===null||a===void 0||a.call(r,s)}}))}enqueue(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var r=function(u){var h=3e3*Math.pow(2,u),p=h/2,m=Math.min(18e5,h),g=(Math.random()-.5)*(m-p);return Math.ceil(m+g)}(t),s=Date.now()+r;this.queue.push({retryAt:s,requestOptions:e});var a="Enqueued failed request for retry in ".concat(r);navigator.onLine||(a+=" (Browser is offline)"),fe.warn(a),this.isPolling||(this.isPolling=!0,this.poll())}poll(){this.poller&&clearTimeout(this.poller),this.poller=setTimeout(()=>{this.areWeOnline&&this.queue.length>0&&this.flush(),this.poll()},this.pollIntervalMs)}flush(){var e=Date.now(),t=[],r=this.queue.filter(a=>a.retryAt<e||(t.push(a),!1));if(this.queue=t,r.length>0)for(var{requestOptions:s}of r)this.retriableRequest(s)}unload(){for(var{requestOptions:e}of(this.poller&&(clearTimeout(this.poller),this.poller=void 0),this.queue))try{this.instance._send_request(P(P({},e),{},{transport:"sendBeacon"}))}catch(t){fe.error(t)}this.queue=[]}}var Ur,al=jt("[SessionId]");class Od{constructor(e,t,r){var s;if(U(this,"_sessionIdChangedHandlers",[]),!e.persistence)throw new Error("SessionIdManager requires a PostHogPersistence instance");if(e.config.__preview_experimental_cookieless_mode)throw new Error("SessionIdManager cannot be used with __preview_experimental_cookieless_mode");this.config=e.config,this.persistence=e.persistence,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=t||xr,this._windowIdGenerator=r||xr;var a=this.config.persistence_name||this.config.token,u=this.config.session_idle_timeout_seconds||1800;if(this._sessionTimeoutMs=1e3*ur(u,60,36e3,"session_idle_timeout_seconds",1800),e.register({$configured_session_timeout_ms:this._sessionTimeoutMs}),this.resetIdleTimer(),this._window_id_storage_key="ph_"+a+"_window_id",this._primary_window_exists_storage_key="ph_"+a+"_primary_window_exists",this._canUseSessionStorage()){var h=Tt.parse(this._window_id_storage_key),p=Tt.parse(this._primary_window_exists_storage_key);h&&!p?this._windowId=h:Tt.remove(this._window_id_storage_key),Tt.set(this._primary_window_exists_storage_key,!0)}if((s=this.config.bootstrap)!==null&&s!==void 0&&s.sessionID)try{var m=(g=>{var f=g.replace(/-/g,"");if(f.length!==32)throw new Error("Not a valid UUID");if(f[12]!=="7")throw new Error("Not a UUIDv7");return parseInt(f.substring(0,12),16)})(this.config.bootstrap.sessionID);this._setSessionId(this.config.bootstrap.sessionID,new Date().getTime(),m)}catch(g){al.error("Invalid sessionID in bootstrap",g)}this._listenToReloadWindow()}get sessionTimeoutMs(){return this._sessionTimeoutMs}onSessionId(e){return pe(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),()=>{this._sessionIdChangedHandlers=this._sessionIdChangedHandlers.filter(t=>t!==e)}}_canUseSessionStorage(){return this.config.persistence!=="memory"&&!this.persistence.disabled&&Tt.is_supported()}_setWindowId(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&Tt.set(this._window_id_storage_key,e))}_getWindowId(){return this._windowId?this._windowId:this._canUseSessionStorage()?Tt.parse(this._window_id_storage_key):null}_setSessionId(e,t,r){e===this._sessionId&&t===this._sessionActivityTimestamp&&r===this._sessionStartTimestamp||(this._sessionStartTimestamp=r,this._sessionActivityTimestamp=t,this._sessionId=e,this.persistence.register({[bi]:[t,e,r]}))}_getSessionId(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[bi];return ht(e)&&e.length===2&&e.push(e[0]),e||[0,null,0]}resetSessionId(){this._setSessionId(null,null,null)}_listenToReloadWindow(){C?.addEventListener("beforeunload",()=>{this._canUseSessionStorage()&&Tt.remove(this._primary_window_exists_storage_key)})}checkAndGetSessionAndWindowId(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.config.__preview_experimental_cookieless_mode)throw new Error("checkAndGetSessionAndWindowId should not be called in __preview_experimental_cookieless_mode");var r=t||new Date().getTime(),[s,a,u]=this._getSessionId(),h=this._getWindowId(),p=Ft(u)&&u>0&&Math.abs(r-u)>864e5,m=!1,g=!a,f=!e&&Math.abs(r-s)>this.sessionTimeoutMs;g||f||p?(a=this._sessionIdGenerator(),h=this._windowIdGenerator(),al.info("new session ID generated",{sessionId:a,windowId:h,changeReason:{noSessionId:g,activityTimeout:f,sessionPastMaximumLength:p}}),u=r,m=!0):h||(h=this._windowIdGenerator(),m=!0);var b=s===0||!e||p?r:s,y=u===0?new Date().getTime():u;return this._setWindowId(h),this._setSessionId(a,b,y),e||this.resetIdleTimer(),m&&this._sessionIdChangedHandlers.forEach(E=>E(a,h,m?{noSessionId:g,activityTimeout:f,sessionPastMaximumLength:p}:void 0)),{sessionId:a,windowId:h,sessionStartTimestamp:y,changeReason:m?{noSessionId:g,activityTimeout:f,sessionPastMaximumLength:p}:void 0,lastActivityTimestamp:s}}resetIdleTimer(){clearTimeout(this._enforceIdleTimeout),this._enforceIdleTimeout=setTimeout(()=>{this.resetSessionId()},1.1*this.sessionTimeoutMs)}}(function(n){n.US="us",n.EU="eu",n.CUSTOM="custom"})(Ur||(Ur={}));var ll="i.posthog.com";class Nd{constructor(e){U(this,"_regionCache",{}),this.instance=e}get apiHost(){var e=this.instance.config.api_host.trim().replace(/\/$/,"");return e==="https://app.posthog.com"?"https://us.i.posthog.com":e}get uiHost(){var e,t=(e=this.instance.config.ui_host)===null||e===void 0?void 0:e.replace(/\/$/,"");return t||(t=this.apiHost.replace(".".concat(ll),".posthog.com")),t==="https://app.posthog.com"?"https://us.posthog.com":t}get region(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Ur.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=Ur.EU:this._regionCache[this.apiHost]=Ur.CUSTOM),this._regionCache[this.apiHost]}endpointFor(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t&&(t=t[0]==="/"?t:"/".concat(t)),e==="ui")return this.uiHost+t;if(this.region===Ur.CUSTOM)return this.apiHost+t;var r=ll+t;switch(e){case"assets":return"https://".concat(this.region,"-assets.").concat(r);case"api":return"https://".concat(this.region,".").concat(r)}}}var du="posthog-js";function hu(n){var{organization:e,projectId:t,prefix:r,severityAllowList:s=["error"]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return a=>{var u,h,p,m,g;if(!(s==="*"||s.includes(a.level))||!n.__loaded)return a;a.tags||(a.tags={});var f=n.requestRouter.endpointFor("ui","/project/".concat(n.config.token,"/person/").concat(n.get_distinct_id()));a.tags["PostHog Person URL"]=f,n.sessionRecordingStarted()&&(a.tags["PostHog Recording URL"]=n.get_session_replay_url({withTimestamp:!0}));var b=((u=a.exception)===null||u===void 0?void 0:u.values)||[];b.map(E=>{E.stacktrace&&(E.stacktrace.type="raw")});var y={$exception_message:((h=b[0])===null||h===void 0?void 0:h.value)||a.message,$exception_type:(p=b[0])===null||p===void 0?void 0:p.type,$exception_personURL:f,$exception_level:a.level,$exception_list:b,$sentry_event_id:a.event_id,$sentry_exception:a.exception,$sentry_exception_message:((m=b[0])===null||m===void 0?void 0:m.value)||a.message,$sentry_exception_type:(g=b[0])===null||g===void 0?void 0:g.type,$sentry_tags:a.tags};return e&&t&&(y.$sentry_url=(r||"https://sentry.io/organizations/")+e+"/issues/?project="+t+"&query="+a.event_id),n.exceptions.sendExceptionEvent(y),a}}class Fd{constructor(e,t,r,s,a){this.name=du,this.setupOnce=function(u){u(hu(e,{organization:t,projectId:r,prefix:s,severityAllowList:a}))}}}var ul,Ai,ir,Co=jt("[SegmentIntegration]");function Ld(n,e){var t=n.config.segment;if(!t)return e();(function(r,s){var a=r.config.segment;if(!a)return s();var u=p=>{var m=()=>p.anonymousId()||xr();r.config.get_device_id=m,p.id()&&(r.register({distinct_id:p.id(),$device_id:m()}),r.persistence.set_property(fr,"identified")),s()},h=a.user();"then"in h&&Jt(h.then)?h.then(p=>u(p)):u(h)})(n,()=>{t.register((r=>{Promise&&Promise.resolve||Co.warn("This browser does not have Promise support, and can not use the segment integration");var s=(a,u)=>{var h;if(!u)return a;a.event.userId||a.event.anonymousId===r.get_distinct_id()||(Co.info("No userId set, resetting PostHog"),r.reset()),a.event.userId&&a.event.userId!==r.get_distinct_id()&&(Co.info("UserId set, identifying with PostHog"),r.identify(a.event.userId));var p=r._calculate_event_properties(u,(h=a.event.properties)!==null&&h!==void 0?h:{},new Date);return a.event.properties=Object.assign({},p,a.event.properties),a};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:()=>!0,load:()=>Promise.resolve(),track:a=>s(a,a.event.event),page:a=>s(a,"$pageview"),identify:a=>s(a,"$identify"),screen:a=>s(a,"$screen")}})(n)).then(()=>{e()})})}class Pd{constructor(e){this._instance=e}doPageView(e){var t,r=this._previousPageViewProperties(e);return this._currentPath=(t=C?.location.pathname)!==null&&t!==void 0?t:"",this._instance.scrollManager.resetContext(),this._prevPageviewTimestamp=e,r}doPageLeave(e){return this._previousPageViewProperties(e)}_previousPageViewProperties(e){var t=this._currentPath,r=this._prevPageviewTimestamp,s=this._instance.scrollManager.getContext();if(!r)return{};var a={};if(s){var{maxScrollHeight:u,lastScrollY:h,maxScrollY:p,maxContentHeight:m,lastContentY:g,maxContentY:f}=s;pe(u)||pe(h)||pe(p)||pe(m)||pe(g)||pe(f)||(u=Math.ceil(u),h=Math.ceil(h),p=Math.ceil(p),m=Math.ceil(m),g=Math.ceil(g),f=Math.ceil(f),a={$prev_pageview_last_scroll:h,$prev_pageview_last_scroll_percentage:u<=1?1:ur(h/u,0,1),$prev_pageview_max_scroll:p,$prev_pageview_max_scroll_percentage:u<=1?1:ur(p/u,0,1),$prev_pageview_last_content:g,$prev_pageview_last_content_percentage:m<=1?1:ur(g/m,0,1),$prev_pageview_max_content:f,$prev_pageview_max_content_percentage:m<=1?1:ur(f/m,0,1)})}return t&&(a.$prev_pageview_pathname=t),r&&(a.$prev_pageview_duration=(e.getTime()-r.getTime())/1e3),a}}(function(n){n.Popover="popover",n.API="api",n.Widget="widget"})(ul||(ul={})),function(n){n.Open="open",n.MultipleChoice="multiple_choice",n.SingleChoice="single_choice",n.Rating="rating",n.Link="link"}(Ai||(Ai={})),function(n){n.NextQuestion="next_question",n.End="end",n.ResponseBased="response_based",n.SpecificQuestion="specific_question"}(ir||(ir={}));class pu{constructor(){U(this,"events",{}),this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.events[e]=this.events[e].filter(r=>r!==t)}}emit(e,t){for(var r of this.events[e]||[])r(t);for(var s of this.events["*"]||[])s(e,t)}}class jr{constructor(e){U(this,"_debugEventEmitter",new pu),U(this,"checkStep",(t,r)=>this.checkStepEvent(t,r)&&this.checkStepUrl(t,r)&&this.checkStepElement(t,r)),U(this,"checkStepEvent",(t,r)=>r==null||!r.event||t?.event===r?.event),this.instance=e,this.actionEvents=new Set,this.actionRegistry=new Set}init(){var e;if(!pe((e=this.instance)===null||e===void 0?void 0:e._addCaptureHook)){var t;(t=this.instance)===null||t===void 0||t._addCaptureHook((r,s)=>{this.on(r,s)})}}register(e){var t,r;if(!pe((t=this.instance)===null||t===void 0?void 0:t._addCaptureHook)&&(e.forEach(u=>{var h,p;(h=this.actionRegistry)===null||h===void 0||h.add(u),(p=u.steps)===null||p===void 0||p.forEach(m=>{var g;(g=this.actionEvents)===null||g===void 0||g.add(m?.event||"")})}),(r=this.instance)!==null&&r!==void 0&&r.autocapture)){var s,a=new Set;e.forEach(u=>{var h;(h=u.steps)===null||h===void 0||h.forEach(p=>{p!=null&&p.selector&&a.add(p?.selector)})}),(s=this.instance)===null||s===void 0||s.autocapture.setElementSelectors(a)}}on(e,t){var r;t!=null&&e.length!=0&&(this.actionEvents.has(e)||this.actionEvents.has(t?.event))&&this.actionRegistry&&((r=this.actionRegistry)===null||r===void 0?void 0:r.size)>0&&this.actionRegistry.forEach(s=>{this.checkAction(t,s)&&this._debugEventEmitter.emit("actionCaptured",s.name)})}_addActionHook(e){this.onAction("actionCaptured",t=>e(t))}checkAction(e,t){if(t?.steps==null)return!1;for(var r of t.steps)if(this.checkStep(e,r))return!0;return!1}onAction(e,t){return this._debugEventEmitter.on(e,t)}checkStepUrl(e,t){if(t!=null&&t.url){var r,s=e==null||(r=e.properties)===null||r===void 0?void 0:r.$current_url;if(!s||typeof s!="string"||!jr.matchString(s,t?.url,t?.url_matching||"contains"))return!1}return!0}static matchString(e,t,r){switch(r){case"regex":return!!C&&un(e,t);case"exact":return t===e;case"contains":var s=jr.escapeStringRegexp(t).replace(/_/g,".").replace(/%/g,".*");return un(e,s);default:return!1}}static escapeStringRegexp(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}checkStepElement(e,t){if((t!=null&&t.href||t!=null&&t.tag_name||t!=null&&t.text)&&!this.getElementsList(e).some(a=>!(t!=null&&t.href&&!jr.matchString(a.href||"",t?.href,t?.href_matching||"exact"))&&(t==null||!t.tag_name||a.tag_name===t?.tag_name)&&!(t!=null&&t.text&&!jr.matchString(a.text||"",t?.text,t?.text_matching||"exact")&&!jr.matchString(a.$el_text||"",t?.text,t?.text_matching||"exact"))))return!1;if(t!=null&&t.selector){var r,s=e==null||(r=e.properties)===null||r===void 0?void 0:r.$element_selectors;if(!s||!s.includes(t?.selector))return!1}return!0}getElementsList(e){return e?.properties.$elements==null?[]:e?.properties.$elements}}class Dn{constructor(e){this.instance=e,this.eventToSurveys=new Map,this.actionToSurveys=new Map}register(e){var t;pe((t=this.instance)===null||t===void 0?void 0:t._addCaptureHook)||(this.setupEventBasedSurveys(e),this.setupActionBasedSurveys(e))}setupActionBasedSurveys(e){var t=e.filter(r=>{var s,a,u,h;return((s=r.conditions)===null||s===void 0?void 0:s.actions)&&((a=r.conditions)===null||a===void 0||(u=a.actions)===null||u===void 0||(h=u.values)===null||h===void 0?void 0:h.length)>0});t.length!==0&&(this.actionMatcher==null&&(this.actionMatcher=new jr(this.instance),this.actionMatcher.init(),this.actionMatcher._addActionHook(r=>{this.onAction(r)})),t.forEach(r=>{var s,a,u,h,p,m,g,f,b,y;r.conditions&&(s=r.conditions)!==null&&s!==void 0&&s.actions&&(a=r.conditions)!==null&&a!==void 0&&(u=a.actions)!==null&&u!==void 0&&u.values&&((h=r.conditions)===null||h===void 0||(p=h.actions)===null||p===void 0||(m=p.values)===null||m===void 0?void 0:m.length)>0&&((g=this.actionMatcher)===null||g===void 0||g.register(r.conditions.actions.values),(f=r.conditions)===null||f===void 0||(b=f.actions)===null||b===void 0||(y=b.values)===null||y===void 0||y.forEach(E=>{if(E&&E.name){var T=this.actionToSurveys.get(E.name);T&&T.push(r.id),this.actionToSurveys.set(E.name,T||[r.id])}}))}))}setupEventBasedSurveys(e){var t;e.filter(r=>{var s,a,u,h;return((s=r.conditions)===null||s===void 0?void 0:s.events)&&((a=r.conditions)===null||a===void 0||(u=a.events)===null||u===void 0||(h=u.values)===null||h===void 0?void 0:h.length)>0}).length!==0&&((t=this.instance)===null||t===void 0||t._addCaptureHook((r,s)=>{this.onEvent(r,s)}),e.forEach(r=>{var s,a,u;(s=r.conditions)===null||s===void 0||(a=s.events)===null||a===void 0||(u=a.values)===null||u===void 0||u.forEach(h=>{if(h&&h.name){var p=this.eventToSurveys.get(h.name);p&&p.push(r.id),this.eventToSurveys.set(h.name,p||[r.id])}})}))}onEvent(e,t){var r,s,a=((r=this.instance)===null||r===void 0||(s=r.persistence)===null||s===void 0?void 0:s.props[ii])||[];if(Dn.SURVEY_SHOWN_EVENT_NAME==e&&t&&a.length>0){var u,h=t==null||(u=t.properties)===null||u===void 0?void 0:u.$survey_id;if(h){var p=a.indexOf(h);p>=0&&(a.splice(p,1),this._updateActivatedSurveys(a))}}else this.eventToSurveys.has(e)&&this._updateActivatedSurveys(a.concat(this.eventToSurveys.get(e)||[]))}onAction(e){var t,r,s=((t=this.instance)===null||t===void 0||(r=t.persistence)===null||r===void 0?void 0:r.props[ii])||[];this.actionToSurveys.has(e)&&this._updateActivatedSurveys(s.concat(this.actionToSurveys.get(e)||[]))}_updateActivatedSurveys(e){var t,r;(t=this.instance)===null||t===void 0||(r=t.persistence)===null||r===void 0||r.register({[ii]:[...new Set(e)]})}getSurveys(){var e,t,r=(e=this.instance)===null||e===void 0||(t=e.persistence)===null||t===void 0?void 0:t.props[ii];return r||[]}getEventToSurveys(){return this.eventToSurveys}_getActionMatcher(){return this.actionMatcher}}U(Dn,"SURVEY_SHOWN_EVENT_NAME","survey shown");var gu,ut,fu,Gr,cl,vu,Xo,mu,Jo={},_u=[],Dd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ls=Array.isArray;function Rr(n,e){for(var t in e)n[t]=e[t];return n}function yu(n){var e=n.parentNode;e&&e.removeChild(n)}function Eo(n,e,t,r,s){var a={type:n,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:s??++fu,__i:-1,__u:0};return s==null&&ut.vnode!=null&&ut.vnode(a),a}function us(n){return n.children}function mi(n,e){this.props=n,this.context=e}function pn(n,e){if(e==null)return n.__?pn(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?pn(n):null}function bu(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return bu(n)}}function Ko(n){(!n.__d&&(n.__d=!0)&&Gr.push(n)&&!Oi.__r++||cl!==ut.debounceRendering)&&((cl=ut.debounceRendering)||vu)(Oi)}function Oi(){var n,e,t,r,s,a,u,h,p;for(Gr.sort(Xo);n=Gr.shift();)n.__d&&(e=Gr.length,r=void 0,a=(s=(t=n).__v).__e,h=[],p=[],(u=t.__P)&&((r=Rr({},s)).__v=s.__v+1,ut.vnode&&ut.vnode(r),Iu(u,r,s,t.__n,u.ownerSVGElement!==void 0,32&s.__u?[a]:null,h,a??pn(s),!!(32&s.__u),p),r.__.__k[r.__i]=r,$d(h,r,p),r.__e!=a&&bu(r)),Gr.length>e&&Gr.sort(Xo));Oi.__r=0}function wu(n,e,t,r,s,a,u,h,p,m,g){var f,b,y,E,T,z=r&&r.__k||_u,j=e.length;for(t.__d=p,Bd(t,e,z),p=t.__d,f=0;f<j;f++)(y=t.__k[f])!=null&&typeof y!="boolean"&&typeof y!="function"&&(b=y.__i===-1?Jo:z[y.__i]||Jo,y.__i=f,Iu(n,y,b,s,a,u,h,p,m,g),E=y.__e,y.ref&&b.ref!=y.ref&&(b.ref&&cs(b.ref,null,y),g.push(y.ref,y.__c||E,y)),T==null&&E!=null&&(T=E),65536&y.__u||b.__k===y.__k?p=Su(y,p,n):typeof y.type=="function"&&y.__d!==void 0?p=y.__d:E&&(p=E.nextSibling),y.__d=void 0,y.__u&=-196609);t.__d=p,t.__e=T}function Bd(n,e,t){var r,s,a,u,h,p=e.length,m=t.length,g=m,f=0;for(n.__k=[],r=0;r<p;r++)(s=n.__k[r]=(s=e[r])==null||typeof s=="boolean"||typeof s=="function"?null:typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?Eo(null,s,null,null,s):ls(s)?Eo(us,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?Eo(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s)!=null?(s.__=n,s.__b=n.__b+1,h=Hd(s,t,u=r+f,g),s.__i=h,a=null,h!==-1&&(g--,(a=t[h])&&(a.__u|=131072)),a==null||a.__v===null?(h==-1&&f--,typeof s.type!="function"&&(s.__u|=65536)):h!==u&&(h===u+1?f++:h>u?g>p-u?f+=h-u:f--:f=h<u&&h==u-1?h-u:0,h!==r+f&&(s.__u|=65536))):(a=t[r])&&a.key==null&&a.__e&&(a.__e==n.__d&&(n.__d=pn(a)),Qo(a,a,!1),t[r]=null,g--);if(g)for(r=0;r<m;r++)(a=t[r])!=null&&!(131072&a.__u)&&(a.__e==n.__d&&(n.__d=pn(a)),Qo(a,a))}function Su(n,e,t){var r,s;if(typeof n.type=="function"){for(r=n.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=n,e=Su(r[s],e,t));return e}return n.__e!=e&&(t.insertBefore(n.__e,e||null),e=n.__e),e&&e.nextSibling}function Hd(n,e,t,r){var s=n.key,a=n.type,u=t-1,h=t+1,p=e[t];if(p===null||p&&s==p.key&&a===p.type)return t;if(r>(p!=null&&!(131072&p.__u)?1:0))for(;u>=0||h<e.length;){if(u>=0){if((p=e[u])&&!(131072&p.__u)&&s==p.key&&a===p.type)return u;u--}if(h<e.length){if((p=e[h])&&!(131072&p.__u)&&s==p.key&&a===p.type)return h;h++}}return-1}function dl(n,e,t){e[0]==="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||Dd.test(e)?t:t+"px"}function hi(n,e,t,r,s){var a;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof r=="string"&&(n.style.cssText=r=""),r)for(e in r)t&&e in t||dl(n.style,e,"");if(t)for(e in t)r&&t[e]===r[e]||dl(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")a=e!==(e=e.replace(/(PointerCapture)$|Capture$/,"$1")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+a]=t,t?r?t.u=r.u:(t.u=Date.now(),n.addEventListener(e,a?pl:hl,a)):n.removeEventListener(e,a?pl:hl,a);else{if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e!=="rowSpan"&&e!=="colSpan"&&e!=="role"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!=="-"?n.removeAttribute(e):n.setAttribute(e,t))}}function hl(n){var e=this.l[n.type+!1];if(n.t){if(n.t<=e.u)return}else n.t=Date.now();return e(ut.event?ut.event(n):n)}function pl(n){return this.l[n.type+!0](ut.event?ut.event(n):n)}function Iu(n,e,t,r,s,a,u,h,p,m){var g,f,b,y,E,T,z,j,$,ae,oe,Se,qe,be,Ce,Re=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(p=!!(32&t.__u),a=[h=e.__e=t.__e]),(g=ut.__b)&&g(e);e:if(typeof Re=="function")try{if(j=e.props,$=(g=Re.contextType)&&r[g.__c],ae=g?$?$.props.value:g.__:r,t.__c?z=(f=e.__c=t.__c).__=f.__E:("prototype"in Re&&Re.prototype.render?e.__c=f=new Re(j,ae):(e.__c=f=new mi(j,ae),f.constructor=Re,f.render=jd),$&&$.sub(f),f.props=j,f.state||(f.state={}),f.context=ae,f.__n=r,b=f.__d=!0,f.__h=[],f._sb=[]),f.__s==null&&(f.__s=f.state),Re.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Rr({},f.__s)),Rr(f.__s,Re.getDerivedStateFromProps(j,f.__s))),y=f.props,E=f.state,f.__v=e,b)Re.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(Re.getDerivedStateFromProps==null&&j!==y&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(j,ae),!f.__e&&(f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(j,f.__s,ae)===!1||e.__v===t.__v)){for(e.__v!==t.__v&&(f.props=j,f.state=f.__s,f.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(je){je&&(je.__=e)}),oe=0;oe<f._sb.length;oe++)f.__h.push(f._sb[oe]);f._sb=[],f.__h.length&&u.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(j,f.__s,ae),f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(y,E,T)})}if(f.context=ae,f.props=j,f.__P=n,f.__e=!1,Se=ut.__r,qe=0,"prototype"in Re&&Re.prototype.render){for(f.state=f.__s,f.__d=!1,Se&&Se(e),g=f.render(f.props,f.state,f.context),be=0;be<f._sb.length;be++)f.__h.push(f._sb[be]);f._sb=[]}else do f.__d=!1,Se&&Se(e),g=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++qe<25);f.state=f.__s,f.getChildContext!=null&&(r=Rr(Rr({},r),f.getChildContext())),b||f.getSnapshotBeforeUpdate==null||(T=f.getSnapshotBeforeUpdate(y,E)),wu(n,ls(Ce=g!=null&&g.type===us&&g.key==null?g.props.children:g)?Ce:[Ce],e,t,r,s,a,u,h,p,m),f.base=e.__e,e.__u&=-161,f.__h.length&&u.push(f),z&&(f.__E=f.__=null)}catch(je){e.__v=null,p||a!=null?(e.__e=h,e.__u|=p?160:32,a[a.indexOf(h)]=null):(e.__e=t.__e,e.__k=t.__k),ut.__e(je,e,t)}else a==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=Wd(t.__e,e,t,r,s,a,u,p,m);(g=ut.diffed)&&g(e)}function $d(n,e,t){e.__d=void 0;for(var r=0;r<t.length;r++)cs(t[r],t[++r],t[++r]);ut.__c&&ut.__c(e,n),n.some(function(s){try{n=s.__h,s.__h=[],n.some(function(a){a.call(s)})}catch(a){ut.__e(a,s.__v)}})}function Wd(n,e,t,r,s,a,u,h,p){var m,g,f,b,y,E,T,z=t.props,j=e.props,$=e.type;if($==="svg"&&(s=!0),a!=null){for(m=0;m<a.length;m++)if((y=a[m])&&"setAttribute"in y==!!$&&($?y.localName===$:y.nodeType===3)){n=y,a[m]=null;break}}if(n==null){if($===null)return document.createTextNode(j);n=s?document.createElementNS("http://www.w3.org/2000/svg",$):document.createElement($,j.is&&j),a=null,h=!1}if($===null)z===j||h&&n.data===j||(n.data=j);else{if(a=a&&gu.call(n.childNodes),z=t.props||Jo,!h&&a!=null)for(z={},m=0;m<n.attributes.length;m++)z[(y=n.attributes[m]).name]=y.value;for(m in z)y=z[m],m=="children"||(m=="dangerouslySetInnerHTML"?f=y:m==="key"||m in j||hi(n,m,null,y,s));for(m in j)y=j[m],m=="children"?b=y:m=="dangerouslySetInnerHTML"?g=y:m=="value"?E=y:m=="checked"?T=y:m==="key"||h&&typeof y!="function"||z[m]===y||hi(n,m,y,z[m],s);if(g)h||f&&(g.__html===f.__html||g.__html===n.innerHTML)||(n.innerHTML=g.__html),e.__k=[];else if(f&&(n.innerHTML=""),wu(n,ls(b)?b:[b],e,t,r,s&&$!=="foreignObject",a,u,a?a[0]:t.__k&&pn(t,0),h,p),a!=null)for(m=a.length;m--;)a[m]!=null&&yu(a[m]);h||(m="value",E!==void 0&&(E!==n[m]||$==="progress"&&!E||$==="option"&&E!==z[m])&&hi(n,m,E,z[m],!1),m="checked",T!==void 0&&T!==n[m]&&hi(n,m,T,z[m],!1))}return n}function cs(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(r){ut.__e(r,t)}}function Qo(n,e,t){var r,s;if(ut.unmount&&ut.unmount(n),(r=n.ref)&&(r.current&&r.current!==n.__e||cs(r,null,e)),(r=n.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(a){ut.__e(a,e)}r.base=r.__P=null,n.__c=void 0}if(r=n.__k)for(s=0;s<r.length;s++)r[s]&&Qo(r[s],e,t||typeof n.type!="function");t||n.__e==null||yu(n.__e),n.__=n.__e=n.__d=void 0}function jd(n,e,t){return this.constructor(n,t)}gu=_u.slice,ut={__e:function(n,e,t,r){for(var s,a,u;e=e.__;)if((s=e.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(n)),u=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,r||{}),u=s.__d),u)return s.__E=s}catch(h){n=h}throw n}},fu=0,mi.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Rr({},this.state),typeof n=="function"&&(n=n(Rr({},t),this.props)),n&&Rr(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),Ko(this))},mi.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Ko(this))},mi.prototype.render=us,Gr=[],vu=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Xo=function(n,e){return n.__v.__b-e.__v.__b},Oi.__r=0,mu=0;(function(n,e){var t={__c:e="__cC"+mu++,__:n,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,a;return this.getChildContext||(s=[],(a={})[e]=this,this.getChildContext=function(){return a},this.shouldComponentUpdate=function(u){this.props.value!==u.value&&s.some(function(h){h.__e=!0,Ko(h)})},this.sub=function(u){s.push(u);var h=u.componentWillUnmount;u.componentWillUnmount=function(){s.splice(s.indexOf(u),1),h&&h.call(u)}}),r.children}};t.Provider.__=t.Consumer.contextType=t})({isPreviewMode:!1,previewPageIndex:0,handleCloseSurveyPopup:()=>{},isPopup:!0});var In=jt("[Surveys]"),Gd={icontains:n=>!!C&&C.location.href.toLowerCase().indexOf(n.toLowerCase())>-1,not_icontains:n=>!!C&&C.location.href.toLowerCase().indexOf(n.toLowerCase())===-1,regex:n=>!!C&&un(C.location.href,n),not_regex:n=>!!C&&!un(C.location.href,n),exact:n=>C?.location.href===n,is_not:n=>C?.location.href!==n};class qd{constructor(e){this.instance=e,this._surveyEventReceiver=null}onRemoteConfig(e){this._decideServerResponse=!!e.surveys,this.loadIfEnabled()}reset(){localStorage.removeItem("lastSeenSurveyDate");var e=(()=>{for(var t=[],r=0;r<localStorage.length;r++){var s=localStorage.key(r);s!=null&&s.startsWith("seenSurvey_")&&t.push(s)}return t})();e.forEach(t=>localStorage.removeItem(t))}loadIfEnabled(){var e,t,r,s=Le==null||(e=Le.__PosthogExtensions__)===null||e===void 0?void 0:e.generateSurveys;this.instance.config.disable_surveys||!this._decideServerResponse||s||(this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Dn(this.instance)),(t=Le.__PosthogExtensions__)===null||t===void 0||(r=t.loadExternalDependency)===null||r===void 0||r.call(t,this.instance,"surveys",a=>{var u,h;if(a)return In.error("Could not load surveys script",a);this._surveyManager=(u=Le.__PosthogExtensions__)===null||u===void 0||(h=u.generateSurveys)===null||h===void 0?void 0:h.call(u,this.instance)}))}getSurveys(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(this.instance.config.disable_surveys)return e([]);this._surveyEventReceiver==null&&(this._surveyEventReceiver=new Dn(this.instance));var r=this.instance.get_property(Oo);if(r&&!t)return e(r);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",callback:s=>{var a;if(s.statusCode!==200||!s.json)return e([]);var u,h=s.json.surveys||[],p=h.filter(m=>{var g,f,b,y,E,T,z,j,$,ae,oe,Se;return((g=m.conditions)===null||g===void 0?void 0:g.events)&&((f=m.conditions)===null||f===void 0||(b=f.events)===null||b===void 0?void 0:b.values)&&((y=m.conditions)===null||y===void 0||(E=y.events)===null||E===void 0||(T=E.values)===null||T===void 0?void 0:T.length)>0||((z=m.conditions)===null||z===void 0?void 0:z.actions)&&((j=m.conditions)===null||j===void 0||($=j.actions)===null||$===void 0?void 0:$.values)&&((ae=m.conditions)===null||ae===void 0||(oe=ae.actions)===null||oe===void 0||(Se=oe.values)===null||Se===void 0?void 0:Se.length)>0});return p.length>0&&((u=this._surveyEventReceiver)===null||u===void 0||u.register(p)),(a=this.instance.persistence)===null||a===void 0||a.register({[Oo]:h}),e(h)}})}getActiveMatchingSurveys(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.getSurveys(r=>{var s,a=r.filter(p=>!(!p.start_date||p.end_date)).filter(p=>{var m,g,f,b;if(!p.conditions)return!0;var y=(m=p.conditions)===null||m===void 0||!m.url||Gd[(g=(f=p.conditions)===null||f===void 0?void 0:f.urlMatchType)!==null&&g!==void 0?g:"icontains"](p.conditions.url),E=(b=p.conditions)===null||b===void 0||!b.selector||he?.querySelector(p.conditions.selector);return y&&E}),u=(s=this._surveyEventReceiver)===null||s===void 0?void 0:s.getSurveys(),h=a.filter(p=>{var m,g,f,b,y,E,T,z,j,$,ae;if(!(p.linked_flag_key||p.targeting_flag_key||p.internal_targeting_flag_key||(m=p.feature_flag_keys)!==null&&m!==void 0&&m.length))return!0;var oe=!p.linked_flag_key||this.instance.featureFlags.isFeatureEnabled(p.linked_flag_key),Se=!p.targeting_flag_key||this.instance.featureFlags.isFeatureEnabled(p.targeting_flag_key),qe=((g=p.conditions)===null||g===void 0?void 0:g.events)&&((f=p.conditions)===null||f===void 0||(b=f.events)===null||b===void 0?void 0:b.values)&&((y=p.conditions)===null||y===void 0||(E=y.events)===null||E===void 0?void 0:E.values.length)>0,be=((T=p.conditions)===null||T===void 0?void 0:T.actions)&&((z=p.conditions)===null||z===void 0||(j=z.actions)===null||j===void 0?void 0:j.values)&&(($=p.conditions)===null||$===void 0||(ae=$.actions)===null||ae===void 0?void 0:ae.values.length)>0,Ce=!qe&&!be||u?.includes(p.id),Re=this._canActivateRepeatedly(p),je=!(p.internal_targeting_flag_key&&!Re)||this.instance.featureFlags.isFeatureEnabled(p.internal_targeting_flag_key),rt=this.checkFlags(p);return oe&&Se&&je&&Ce&&rt});return e(h)},t)}checkFlags(e){var t;return(t=e.feature_flag_keys)===null||t===void 0||!t.length||e.feature_flag_keys.every(r=>{var{key:s,value:a}=r;return!s||!a||this.instance.featureFlags.isFeatureEnabled(a)})}getNextSurveyStep(e,t,r){var s,a=e.questions[t],u=t+1;if((s=a.branching)===null||s===void 0||!s.type)return t===e.questions.length-1?ir.End:u;if(a.branching.type===ir.End)return ir.End;if(a.branching.type===ir.SpecificQuestion){if(Number.isInteger(a.branching.index))return a.branching.index}else if(a.branching.type===ir.ResponseBased){if(a.type===Ai.SingleChoice){var h,p,m=a.choices.indexOf("".concat(r));if((h=a.branching)!==null&&h!==void 0&&(p=h.responseValues)!==null&&p!==void 0&&p.hasOwnProperty(m)){var g=a.branching.responseValues[m];return Number.isInteger(g)?g:g===ir.End?ir.End:u}}else if(a.type===Ai.Rating){var f,b;if(typeof r!="number"||!Number.isInteger(r))throw new Error("The response type must be an integer");var y=function(T,z){if(z===3){if(T<1||T>3)throw new Error("The response must be in range 1-3");return T===1?"negative":T===2?"neutral":"positive"}if(z===5){if(T<1||T>5)throw new Error("The response must be in range 1-5");return T<=2?"negative":T===3?"neutral":"positive"}if(z===7){if(T<1||T>7)throw new Error("The response must be in range 1-7");return T<=3?"negative":T===4?"neutral":"positive"}if(z===10){if(T<0||T>10)throw new Error("The response must be in range 0-10");return T<=6?"detractors":T<=8?"passives":"promoters"}throw new Error("The scale must be one of: 3, 5, 7, 10")}(r,a.scale);if((f=a.branching)!==null&&f!==void 0&&(b=f.responseValues)!==null&&b!==void 0&&b.hasOwnProperty(y)){var E=a.branching.responseValues[y];return Number.isInteger(E)?E:E===ir.End?ir.End:u}}return u}return In.warn("Falling back to next question index due to unexpected branching type"),u}_canActivateRepeatedly(e){var t;return Qe((t=Le.__PosthogExtensions__)===null||t===void 0?void 0:t.canActivateRepeatedly)?(In.warn("init was not called"),!1):Le.__PosthogExtensions__.canActivateRepeatedly(e)}canRenderSurvey(e){Qe(this._surveyManager)?In.warn("init was not called"):this.getSurveys(t=>{var r=t.filter(s=>s.id===e)[0];this._surveyManager.canRenderSurvey(r)})}renderSurvey(e,t){Qe(this._surveyManager)?In.warn("init was not called"):this.getSurveys(r=>{var s=r.filter(a=>a.id===e)[0];this._surveyManager.renderSurvey(s,he?.querySelector(t))})}}var gl=jt("[RateLimiter]");class Ud{constructor(e){var t,r;U(this,"serverLimits",{}),U(this,"lastEventRateLimited",!1),U(this,"checkForLimiting",s=>{var a=s.text;if(a&&a.length)try{(JSON.parse(a).quota_limited||[]).forEach(u=>{gl.info("".concat(u||"events"," is quota limited.")),this.serverLimits[u]=new Date().getTime()+6e4})}catch(u){return void gl.warn('could not rate limit - continuing. Error: "'.concat(u?.message,'"'),{text:a})}}),this.instance=e,this.captureEventsPerSecond=((t=e.config.rate_limiting)===null||t===void 0?void 0:t.events_per_second)||10,this.captureEventsBurstLimit=Math.max(((r=e.config.rate_limiting)===null||r===void 0?void 0:r.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}clientRateLimitContext(){var e,t,r,s=arguments.length>0&&arguments[0]!==void 0&&arguments[0],a=new Date().getTime(),u=(e=(t=this.instance.persistence)===null||t===void 0?void 0:t.get_property(Fo))!==null&&e!==void 0?e:{tokens:this.captureEventsBurstLimit,last:a};u.tokens+=(a-u.last)/1e3*this.captureEventsPerSecond,u.last=a,u.tokens>this.captureEventsBurstLimit&&(u.tokens=this.captureEventsBurstLimit);var h=u.tokens<1;return h||s||(u.tokens=Math.max(0,u.tokens-1)),!h||this.lastEventRateLimited||s||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=h,(r=this.instance.persistence)===null||r===void 0||r.set_property(Fo,u),{isRateLimited:h,remainingTokens:u.tokens}}isServerRateLimited(e){var t=this.serverLimits[e||"events"]||!1;return t!==!1&&new Date().getTime()<t}}var Vd=()=>P({initialPathName:Ht?.pathname||"",referringDomain:lt.referringDomain()},lt.campaignParams());class zd{constructor(e,t,r){U(this,"_onSessionIdCallback",s=>{var a=this._getStoredProps();if(!a||a.sessionId!==s){var u={sessionId:s,props:this._sessionSourceParamGenerator()};this._persistence.register({[No]:u})}}),this._sessionIdManager=e,this._persistence=t,this._sessionSourceParamGenerator=r||Vd,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}_getStoredProps(){return this._persistence.props[No]}getSessionProps(){var e,t=(e=this._getStoredProps())===null||e===void 0?void 0:e.props;return t?{$client_session_initial_referring_host:t.referringDomain,$client_session_initial_pathname:t.initialPathName,$client_session_initial_utm_source:t.utm_source,$client_session_initial_utm_campaign:t.utm_campaign,$client_session_initial_utm_medium:t.utm_medium,$client_session_initial_utm_content:t.utm_content,$client_session_initial_utm_term:t.utm_term}:{}}}var Yd=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","bingbot","bingpreview","bot.htm","bot.php","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","gptbot","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","headlesschrome","cypress","Google-HotelAdsVerifier","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],fl=function(n,e){if(!n)return!1;var t=n.toLowerCase();return Yd.concat(e||[]).some(r=>{var s=r.toLowerCase();return t.indexOf(s)!==-1})},Cu=function(n,e){if(!n)return!1;var t=n.userAgent;if(t&&fl(t,e))return!0;try{var r=n?.userAgentData;if(r!=null&&r.brands&&r.brands.some(s=>fl(s?.brand,e)))return!0}catch{}return!!n.webdriver};class Eu{constructor(){this.clicks=[]}isRageClick(e,t,r){var s=this.clicks[this.clicks.length-1];if(s&&Math.abs(e-s.x)+Math.abs(t-s.y)<30&&r-s.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:r}),this.clicks.length===3)return!0}else this.clicks=[{x:e,y:t,timestamp:r}];return!1}}var pi=jt("[Dead Clicks]"),Zd=()=>!0,Xd=n=>{var e,t=!((e=n.instance.persistence)===null||e===void 0||!e.get_property(Ml)),r=n.instance.config.capture_dead_clicks;return qr(r)?r:t};class ku{get lazyLoadedDeadClicksAutocapture(){return this._lazyLoadedDeadClicksAutocapture}constructor(e,t,r){this.instance=e,this.isEnabled=t,this.onCapture=r,this.startIfEnabled()}onRemoteConfig(e){this.instance.persistence&&this.instance.persistence.register({[Ml]:e?.captureDeadClicks}),this.startIfEnabled()}startIfEnabled(){this.isEnabled(this)&&this.loadScript(()=>{this.start()})}loadScript(e){var t,r,s;(t=Le.__PosthogExtensions__)!==null&&t!==void 0&&t.initDeadClicksAutocapture&&e(),(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.loadExternalDependency)===null||s===void 0||s.call(r,this.instance,"dead-clicks-autocapture",a=>{a?pi.error("failed to load script",a):e()})}start(){var e;if(he){if(!this._lazyLoadedDeadClicksAutocapture&&(e=Le.__PosthogExtensions__)!==null&&e!==void 0&&e.initDeadClicksAutocapture){var t=dt(this.instance.config.capture_dead_clicks)?this.instance.config.capture_dead_clicks:{};t.__onCapture=this.onCapture,this._lazyLoadedDeadClicksAutocapture=Le.__PosthogExtensions__.initDeadClicksAutocapture(this.instance,t),this._lazyLoadedDeadClicksAutocapture.start(he),pi.info("starting...")}}else pi.error("`document` not found. Cannot start.")}stop(){this._lazyLoadedDeadClicksAutocapture&&(this._lazyLoadedDeadClicksAutocapture.stop(),this._lazyLoadedDeadClicksAutocapture=void 0,pi.info("stopping..."))}}var Jd=jt("[Heatmaps]");function vl(n){return dt(n)&&"clientX"in n&&"clientY"in n&&Ft(n.clientX)&&Ft(n.clientY)}class Kd{constructor(e){var t;U(this,"rageclicks",new Eu),U(this,"_enabledServerSide",!1),U(this,"_initialized",!1),U(this,"_flushInterval",null),this.instance=e,this._enabledServerSide=!((t=this.instance.persistence)===null||t===void 0||!t.props[Mo]),C?.addEventListener("beforeunload",()=>{this.flush()})}get flushIntervalMilliseconds(){var e=5e3;return dt(this.instance.config.capture_heatmaps)&&this.instance.config.capture_heatmaps.flush_interval_milliseconds&&(e=this.instance.config.capture_heatmaps.flush_interval_milliseconds),e}get isEnabled(){return pe(this.instance.config.capture_heatmaps)?pe(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps:this.instance.config.capture_heatmaps!==!1}startIfEnabled(){if(this.isEnabled){if(this._initialized)return;Jd.info("starting..."),this._setupListeners(),this._flushInterval=setInterval(this.flush.bind(this),this.flushIntervalMilliseconds)}else{var e,t;clearInterval((e=this._flushInterval)!==null&&e!==void 0?e:void 0),(t=this.deadClicksCapture)===null||t===void 0||t.stop(),this.getAndClearBuffer()}}onRemoteConfig(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register({[Mo]:t}),this._enabledServerSide=t,this.startIfEnabled()}getAndClearBuffer(){var e=this.buffer;return this.buffer=void 0,e}_onDeadClick(e){this._onClick(e.originalEvent,"deadclick")}_setupListeners(){C&&he&&(yr(he,"click",e=>this._onClick(e||C?.event),!1,!0),yr(he,"mousemove",e=>this._onMouseMove(e||C?.event),!1,!0),this.deadClicksCapture=new ku(this.instance,Zd,this._onDeadClick.bind(this)),this.deadClicksCapture.startIfEnabled(),this._initialized=!0)}_getProperties(e,t){var r=this.instance.scrollManager.scrollY(),s=this.instance.scrollManager.scrollX(),a=this.instance.scrollManager.scrollElement(),u=function(h,p,m){for(var g=h;g&&Li(g)&&!Mr(g,"body");){if(g===m)return!1;if(De(p,C?.getComputedStyle(g).position))return!0;g=Kl(g)}return!1}(Jl(e),["fixed","sticky"],a);return{x:e.clientX+(u?0:s),y:e.clientY+(u?0:r),target_fixed:u,type:t}}_onClick(e){var t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"click";if(!za(e.target)&&vl(e)){var s=this._getProperties(e,r);(t=this.rageclicks)!==null&&t!==void 0&&t.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._capture(P(P({},s),{},{type:"rageclick"})),this._capture(s)}}_onMouseMove(e){!za(e.target)&&vl(e)&&(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout(()=>{this._capture(this._getProperties(e,"mousemove"))},500))}_capture(e){if(C){var t=C.location.href;this.buffer=this.buffer||{},this.buffer[t]||(this.buffer[t]=[]),this.buffer[t].push(e)}}flush(){this.buffer&&!rn(this.buffer)&&this.instance.capture("$$heatmap",{$heatmap_data:this.getAndClearBuffer()})}}class Qd{constructor(e){U(this,"_updateScrollData",()=>{var t,r,s,a;this.context||(this.context={});var u=this.scrollElement(),h=this.scrollY(),p=u?Math.max(0,u.scrollHeight-u.clientHeight):0,m=h+(u?.clientHeight||0),g=u?.scrollHeight||0;this.context.lastScrollY=Math.ceil(h),this.context.maxScrollY=Math.max(h,(t=this.context.maxScrollY)!==null&&t!==void 0?t:0),this.context.maxScrollHeight=Math.max(p,(r=this.context.maxScrollHeight)!==null&&r!==void 0?r:0),this.context.lastContentY=m,this.context.maxContentY=Math.max(m,(s=this.context.maxContentY)!==null&&s!==void 0?s:0),this.context.maxContentHeight=Math.max(g,(a=this.context.maxContentHeight)!==null&&a!==void 0?a:0)}),this.instance=e}getContext(){return this.context}resetContext(){var e=this.context;return setTimeout(this._updateScrollData,0),e}startMeasuringScrollPosition(){C?.addEventListener("scroll",this._updateScrollData,!0),C?.addEventListener("scrollend",this._updateScrollData,!0),C?.addEventListener("resize",this._updateScrollData)}scrollElement(){if(!this.instance.config.scroll_root_selector)return C?.document.documentElement;var e=ht(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector];for(var t of e){var r=C?.document.querySelector(t);if(r)return r}}scrollY(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return C&&(C.scrollY||C.pageYOffset||C.document.documentElement.scrollTop)||0}scrollX(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return C&&(C.scrollX||C.pageXOffset||C.document.documentElement.scrollLeft)||0}}var ml=jt("[AutoCapture]");function ko(n,e){return e.length>n?e.slice(0,n)+"...":e}function eh(n){if(n.previousElementSibling)return n.previousElementSibling;var e=n;do e=e.previousSibling;while(e&&!Li(e));return e}function th(n,e,t,r){var s=n.tagName.toLowerCase(),a={tag_name:s};jo.indexOf(s)>-1&&!t&&(s.toLowerCase()==="a"||s.toLowerCase()==="button"?a.$el_text=ko(1024,ru(n)):a.$el_text=ko(1024,Pi(n)));var u=xi(n);u.length>0&&(a.classes=u.filter(function(g){return g!==""})),Ke(n.attributes,function(g){var f;if((!Ql(n)||["name","id","class","aria-label"].indexOf(g.name)!==-1)&&(r==null||!r.includes(g.name))&&!e&&dn(g.value)&&(f=g.name,!xt(f)||f.substring(0,10)!=="_ngcontent"&&f.substring(0,7)!=="_nghost")){var b=g.value;g.name==="class"&&(b=os(b).join(" ")),a["attr__"+g.name]=ko(1024,b)}});for(var h=1,p=1,m=n;m=eh(m);)h++,m.tagName===n.tagName&&p++;return a.nth_child=h,a.nth_of_type=p,a}function rh(n,e){for(var t,r,{e:s,maskAllElementAttributes:a,maskAllText:u,elementAttributeIgnoreList:h,elementsChainAsString:p}=e,m=[n],g=n;g.parentNode&&!Mr(g,"body");)Zl(g.parentNode)?(m.push(g.parentNode.host),g=g.parentNode.host):(m.push(g.parentNode),g=g.parentNode);var f,b=[],y={},E=!1,T=!1;if(Ke(m,oe=>{var Se=Go(oe);oe.tagName.toLowerCase()==="a"&&(E=oe.getAttribute("href"),E=Se&&E&&dn(E)&&E),De(xi(oe),"ph-no-capture")&&(T=!0),b.push(th(oe,a,u,h));var qe=function(be){if(!Go(be))return{};var Ce={};return Ke(be.attributes,function(Re){if(Re.name&&Re.name.indexOf("data-ph-capture-attribute")===0){var je=Re.name.replace("data-ph-capture-attribute-",""),rt=Re.value;je&&rt&&dn(rt)&&(Ce[je]=rt)}}),Ce}(oe);Lt(y,qe)}),T)return{props:{},explicitNoCapture:T};if(u||(n.tagName.toLowerCase()==="a"||n.tagName.toLowerCase()==="button"?b[0].$el_text=ru(n):b[0].$el_text=Pi(n)),E){var z,j;b[0].attr__href=E;var $=(z=sn(E))===null||z===void 0?void 0:z.host,ae=C==null||(j=C.location)===null||j===void 0?void 0:j.host;$&&ae&&$!==ae&&(f=E)}return{props:Lt({$event_type:s.type,$ce_version:1},p?{}:{$elements:b},{$elements_chain:od(b)},(t=b[0])!==null&&t!==void 0&&t.$el_text?{$el_text:(r=b[0])===null||r===void 0?void 0:r.$el_text}:{},f&&s.type==="click"?{$external_click_url:f}:{},y)}}class nh{constructor(e){U(this,"_initialized",!1),U(this,"_isDisabledServerSide",null),U(this,"rageclicks",new Eu),U(this,"_elementsChainAsString",!1),this.instance=e,this._elementSelectors=null}get config(){var e,t,r=dt(this.instance.config.autocapture)?this.instance.config.autocapture:{};return r.url_allowlist=(e=r.url_allowlist)===null||e===void 0?void 0:e.map(s=>new RegExp(s)),r.url_ignorelist=(t=r.url_ignorelist)===null||t===void 0?void 0:t.map(s=>new RegExp(s)),r}_addDomEventHandlers(){if(this.isBrowserSupported()){if(C&&he){var e=r=>{r=r||C?.event;try{this._captureEvent(r)}catch(s){ml.error("Failed to capture event",s)}},t=r=>{r=r||C?.event,this._captureEvent(r,fo)};yr(he,"submit",e,!1,!0),yr(he,"change",e,!1,!0),yr(he,"click",e,!1,!0),this.config.capture_copied_text&&(yr(he,"copy",t,!1,!0),yr(he,"cut",t,!1,!0))}}else ml.info("Disabling Automatic Event Collection because this browser is not supported")}startIfEnabled(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}onRemoteConfig(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register({[xa]:!!e.autocapture_opt_out}),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}setElementSelectors(e){this._elementSelectors=e}getElementSelectors(e){var t,r=[];return(t=this._elementSelectors)===null||t===void 0||t.forEach(s=>{var a=he?.querySelectorAll(s);a?.forEach(u=>{e===u&&r.push(s)})}),r}get isEnabled(){var e,t,r=(e=this.instance.persistence)===null||e===void 0?void 0:e.props[xa],s=this._isDisabledServerSide;if(Ar(s)&&!qr(r)&&!this.instance.config.advanced_disable_decide)return!1;var a=(t=this._isDisabledServerSide)!==null&&t!==void 0?t:!!r;return!!this.instance.config.autocapture&&!a}_captureEvent(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"$autocapture";if(this.isEnabled){var r,s=Jl(e);Yl(s)&&(s=s.parentNode||null),t==="$autocapture"&&e.type==="click"&&e instanceof MouseEvent&&this.instance.config.rageclick&&(r=this.rageclicks)!==null&&r!==void 0&&r.isRageClick(e.clientX,e.clientY,new Date().getTime())&&this._captureEvent(e,"$rageclick");var a=t===fo;if(s&&ed(s,e,this.config,a,a?["copy","cut"]:void 0)){var{props:u,explicitNoCapture:h}=rh(s,{e,maskAllElementAttributes:this.instance.config.mask_all_element_attributes,maskAllText:this.instance.config.mask_all_text,elementAttributeIgnoreList:this.config.element_attribute_ignorelist,elementsChainAsString:this._elementsChainAsString});if(h)return!1;var p=this.getElementSelectors(s);if(p&&p.length>0&&(u.$element_selectors=p),t===fo){var m,g=Xl(C==null||(m=C.getSelection())===null||m===void 0?void 0:m.toString()),f=e.type||"clipboard";if(!g)return!1;u.$selected_content=g,u.$copy_type=f}return this.instance.capture(t,u),!0}}}isBrowserSupported(){return Jt(he?.querySelectorAll)}}var ih=jt("[TracingHeaders]");class oh{constructor(e){U(this,"_restoreXHRPatch",void 0),U(this,"_restoreFetchPatch",void 0),U(this,"_startCapturing",()=>{var t,r,s,a;pe(this._restoreXHRPatch)&&((t=Le.__PosthogExtensions__)===null||t===void 0||(r=t.tracingHeadersPatchFns)===null||r===void 0||r._patchXHR(this.instance.sessionManager)),pe(this._restoreFetchPatch)&&((s=Le.__PosthogExtensions__)===null||s===void 0||(a=s.tracingHeadersPatchFns)===null||a===void 0||a._patchFetch(this.instance.sessionManager))}),this.instance=e}_loadScript(e){var t,r,s;(t=Le.__PosthogExtensions__)!==null&&t!==void 0&&t.tracingHeadersPatchFns&&e(),(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.loadExternalDependency)===null||s===void 0||s.call(r,this.instance,"tracing-headers",a=>{if(a)return ih.error("failed to load script",a);e()})}startIfEnabledOrStop(){var e,t;this.instance.config.__add_tracing_headers?this._loadScript(this._startCapturing):((e=this._restoreXHRPatch)===null||e===void 0||e.call(this),(t=this._restoreFetchPatch)===null||t===void 0||t.call(this),this._restoreXHRPatch=void 0,this._restoreFetchPatch=void 0)}}var Tr;(function(n){n[n.PENDING=-1]="PENDING",n[n.DENIED=0]="DENIED",n[n.GRANTED=1]="GRANTED"})(Tr||(Tr={}));class sh{constructor(e){this.instance=e}get config(){return this.instance.config}get consent(){return this.getDnt()?Tr.DENIED:this.storedConsent}isOptedOut(){return this.consent===Tr.DENIED||this.consent===Tr.PENDING&&this.config.opt_out_capturing_by_default}isOptedIn(){return!this.isOptedOut()}optInOut(e){this.storage.set(this.storageKey,e?1:0,this.config.cookie_expiration,this.config.cross_subdomain_cookie,this.config.secure_cookie)}reset(){this.storage.remove(this.storageKey,this.config.cross_subdomain_cookie)}get storageKey(){var{token:e,opt_out_capturing_cookie_prefix:t}=this.instance.config;return(t||"__ph_opt_in_out_")+e}get storedConsent(){var e=this.storage.get(this.storageKey);return e==="1"?Tr.GRANTED:e==="0"?Tr.DENIED:Tr.PENDING}get storage(){if(!this._storage){var e=this.config.opt_out_capturing_persistence_type;this._storage=e==="localStorage"?mt:br;var t=e==="localStorage"?br:mt;t.get(this.storageKey)&&(this._storage.get(this.storageKey)||this.optInOut(t.get(this.storageKey)==="1"),t.remove(this.storageKey,this.config.cross_subdomain_cookie))}return this._storage}getDnt(){return!!this.config.respect_dnt&&!!xl([Vt?.doNotTrack,Vt?.msDoNotTrack,Le.doNotTrack],e=>De([!0,1,"1","yes"],e))}}var gi=jt("[ExceptionAutocapture]");class ah{constructor(e){var t;U(this,"originalOnUnhandledRejectionHandler",void 0),U(this,"startCapturing",()=>{var r,s,a,u;if(C&&this.isEnabled&&!this.hasHandlers&&!this.isCapturing){var h=(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.errorWrappingFunctions)===null||s===void 0?void 0:s.wrapOnError,p=(a=Le.__PosthogExtensions__)===null||a===void 0||(u=a.errorWrappingFunctions)===null||u===void 0?void 0:u.wrapUnhandledRejection;if(h&&p)try{this.unwrapOnError=h(this.captureException.bind(this)),this.unwrapUnhandledRejection=p(this.captureException.bind(this))}catch(m){gi.error("failed to start",m),this.stopCapturing()}else gi.error("failed to load error wrapping functions - cannot start")}}),this.instance=e,this.remoteEnabled=!((t=this.instance.persistence)===null||t===void 0||!t.props[Ra]),this.startIfEnabled()}get isEnabled(){var e;return(e=this.remoteEnabled)!==null&&e!==void 0&&e}get isCapturing(){var e;return!(C==null||(e=C.onerror)===null||e===void 0||!e.__POSTHOG_INSTRUMENTED__)}get hasHandlers(){return this.originalOnUnhandledRejectionHandler||this.unwrapOnError}startIfEnabled(){this.isEnabled&&!this.isCapturing&&(gi.info("enabled, starting..."),this.loadScript(this.startCapturing))}loadScript(e){var t,r;this.hasHandlers&&e(),(t=Le.__PosthogExtensions__)===null||t===void 0||(r=t.loadExternalDependency)===null||r===void 0||r.call(t,this.instance,"exception-autocapture",s=>{if(s)return gi.error("failed to load script",s);e()})}stopCapturing(){var e,t;(e=this.unwrapOnError)===null||e===void 0||e.call(this),(t=this.unwrapUnhandledRejection)===null||t===void 0||t.call(this)}onRemoteConfig(e){var t=e.autocaptureExceptions;this.remoteEnabled=!!t||!1,this.instance.persistence&&this.instance.persistence.register({[Ra]:this.remoteEnabled}),this.startIfEnabled()}captureException(e){var t=this.instance.requestRouter.endpointFor("ui");e.$exception_personURL="".concat(t,"/project/").concat(this.instance.config.token,"/person/").concat(this.instance.get_distinct_id()),this.instance.exceptions.sendExceptionEvent(e)}}var Hr=jt("[Web Vitals]"),_l=9e5;class lh{constructor(e){var t;U(this,"_enabledServerSide",!1),U(this,"_initialized",!1),U(this,"buffer",{url:void 0,metrics:[],firstMetricTimestamp:void 0}),U(this,"_flushToCapture",()=>{clearTimeout(this._delayedFlushTimer),this.buffer.metrics.length!==0&&(this.instance.capture("$web_vitals",this.buffer.metrics.reduce((r,s)=>P(P({},r),{},{["$web_vitals_".concat(s.name,"_event")]:P({},s),["$web_vitals_".concat(s.name,"_value")]:s.value}),{})),this.buffer={url:void 0,metrics:[],firstMetricTimestamp:void 0})}),U(this,"_addToBuffer",r=>{var s,a=(s=this.instance.sessionManager)===null||s===void 0?void 0:s.checkAndGetSessionAndWindowId(!0);if(pe(a))Hr.error("Could not read session ID. Dropping metrics!");else{this.buffer=this.buffer||{url:void 0,metrics:[],firstMetricTimestamp:void 0};var u=this._currentURL();pe(u)||(Qe(r?.name)||Qe(r?.value)?Hr.error("Invalid metric received",r):this._maxAllowedValue&&r.value>=this._maxAllowedValue?Hr.error("Ignoring metric with value >= "+this._maxAllowedValue,r):(this.buffer.url!==u&&(this._flushToCapture(),this._delayedFlushTimer=setTimeout(this._flushToCapture,this.flushToCaptureTimeoutMs)),pe(this.buffer.url)&&(this.buffer.url=u),this.buffer.firstMetricTimestamp=pe(this.buffer.firstMetricTimestamp)?Date.now():this.buffer.firstMetricTimestamp,r.attribution&&r.attribution.interactionTargetElement&&(r.attribution.interactionTargetElement=void 0),this.buffer.metrics.push(P(P({},r),{},{$current_url:u,$session_id:a.sessionId,$window_id:a.windowId,timestamp:Date.now()})),this.buffer.metrics.length===this.allowedMetrics.length&&this._flushToCapture()))}}),U(this,"_startCapturing",()=>{var r,s,a,u,h=Le.__PosthogExtensions__;pe(h)||pe(h.postHogWebVitalsCallbacks)||({onLCP:r,onCLS:s,onFCP:a,onINP:u}=h.postHogWebVitalsCallbacks),r&&s&&a&&u?(this.allowedMetrics.indexOf("LCP")>-1&&r(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("CLS")>-1&&s(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("FCP")>-1&&a(this._addToBuffer.bind(this)),this.allowedMetrics.indexOf("INP")>-1&&u(this._addToBuffer.bind(this)),this._initialized=!0):Hr.error("web vitals callbacks not loaded - not starting")}),this.instance=e,this._enabledServerSide=!((t=this.instance.persistence)===null||t===void 0||!t.props[Ma]),this.startIfEnabled()}get allowedMetrics(){var e,t,r=dt(this.instance.config.capture_performance)?(e=this.instance.config.capture_performance)===null||e===void 0?void 0:e.web_vitals_allowed_metrics:void 0;return pe(r)?((t=this.instance.persistence)===null||t===void 0?void 0:t.props[Aa])||["CLS","FCP","INP","LCP"]:r}get flushToCaptureTimeoutMs(){return(dt(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals_delayed_flush_ms:void 0)||5e3}get _maxAllowedValue(){var e=dt(this.instance.config.capture_performance)&&Ft(this.instance.config.capture_performance.__web_vitals_max_value)?this.instance.config.capture_performance.__web_vitals_max_value:_l;return 0<e&&e<=6e4?_l:e}get isEnabled(){var e=dt(this.instance.config.capture_performance)?this.instance.config.capture_performance.web_vitals:void 0;return qr(e)?e:this._enabledServerSide}startIfEnabled(){this.isEnabled&&!this._initialized&&(Hr.info("enabled, starting..."),this.loadScript(this._startCapturing))}onRemoteConfig(e){var t=dt(e.capturePerformance)&&!!e.capturePerformance.web_vitals,r=dt(e.capturePerformance)?e.capturePerformance.web_vitals_allowed_metrics:void 0;this.instance.persistence&&(this.instance.persistence.register({[Ma]:t}),this.instance.persistence.register({[Aa]:r})),this._enabledServerSide=t,this.startIfEnabled()}loadScript(e){var t,r,s;(t=Le.__PosthogExtensions__)!==null&&t!==void 0&&t.postHogWebVitalsCallbacks&&e(),(r=Le.__PosthogExtensions__)===null||r===void 0||(s=r.loadExternalDependency)===null||s===void 0||s.call(r,this.instance,"web-vitals",a=>{a?Hr.error("failed to load script",a):e()})}_currentURL(){var e=C?C.location.href:void 0;return e||Hr.error("Could not determine current URL"),e}}var uh={icontains:(n,e)=>!!C&&e.href.toLowerCase().indexOf(n.toLowerCase())>-1,not_icontains:(n,e)=>!!C&&e.href.toLowerCase().indexOf(n.toLowerCase())===-1,regex:(n,e)=>!!C&&un(e.href,n),not_regex:(n,e)=>!!C&&!un(e.href,n),exact:(n,e)=>e.href===n,is_not:(n,e)=>e.href!==n};class yt{constructor(e){var t=this;U(this,"getWebExperimentsAndEvaluateDisplayLogic",function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];t.getWebExperiments(s=>{yt.logInfo("retrieved web experiments from the server"),t._flagToExperiments=new Map,s.forEach(a=>{if(a.feature_flag_key){var u;t._flagToExperiments&&(yt.logInfo("setting flag key ",a.feature_flag_key," to web experiment ",a),(u=t._flagToExperiments)===null||u===void 0||u.set(a.feature_flag_key,a));var h=t.instance.getFeatureFlag(a.feature_flag_key);xt(h)&&a.variants[h]&&t.applyTransforms(a.name,h,a.variants[h].transforms)}else if(a.variants)for(var p in a.variants){var m=a.variants[p];yt.matchesTestVariant(m)&&t.applyTransforms(a.name,p,m.transforms)}})},r)}),this.instance=e,this.instance.onFeatureFlags(r=>{this.onFeatureFlags(r)})}onFeatureFlags(e){if(this._is_bot())yt.logInfo("Refusing to render web experiment since the viewer is a likely bot");else if(!this.instance.config.disable_web_experiments){if(Qe(this._flagToExperiments))return this._flagToExperiments=new Map,this.loadIfEnabled(),void this.previewWebExperiment();yt.logInfo("applying feature flags",e),e.forEach(t=>{var r;if(this._flagToExperiments&&(r=this._flagToExperiments)!==null&&r!==void 0&&r.has(t)){var s,a=this.instance.getFeatureFlag(t),u=(s=this._flagToExperiments)===null||s===void 0?void 0:s.get(t);a&&u!=null&&u.variants[a]&&this.applyTransforms(u.name,a,u.variants[a].transforms)}})}}previewWebExperiment(){var e=yt.getWindowLocation();if(e!=null&&e.search){var t=Ci(e?.search,"__experiment_id"),r=Ci(e?.search,"__experiment_variant");t&&r&&(yt.logInfo("previewing web experiments ".concat(t," && ").concat(r)),this.getWebExperiments(s=>{this.showPreviewWebExperiment(parseInt(t),r,s)},!1,!0))}}loadIfEnabled(){this.instance.config.disable_web_experiments||this.getWebExperimentsAndEvaluateDisplayLogic()}getWebExperiments(e,t,r){if(this.instance.config.disable_web_experiments&&!r)return e([]);var s=this.instance.get_property("$web_experiments");if(s&&!t)return e(s);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/web_experiments/?token=".concat(this.instance.config.token)),method:"GET",callback:a=>{if(a.statusCode!==200||!a.json)return e([]);var u=a.json.experiments||[];return e(u)}})}showPreviewWebExperiment(e,t,r){var s=r.filter(a=>a.id===e);s&&s.length>0&&(yt.logInfo("Previewing web experiment [".concat(s[0].name,"] with variant [").concat(t,"]")),this.applyTransforms(s[0].name,t,s[0].variants[t].transforms,!0))}static matchesTestVariant(e){return!Qe(e.conditions)&&yt.matchUrlConditions(e)&&yt.matchUTMConditions(e)}static matchUrlConditions(e){var t;if(Qe(e.conditions)||Qe((t=e.conditions)===null||t===void 0?void 0:t.url))return!0;var r,s,a,u=yt.getWindowLocation();return!!u&&((r=e.conditions)===null||r===void 0||!r.url||uh[(s=(a=e.conditions)===null||a===void 0?void 0:a.urlMatchType)!==null&&s!==void 0?s:"icontains"](e.conditions.url,u))}static getWindowLocation(){return C?.location}static matchUTMConditions(e){var t;if(Qe(e.conditions)||Qe((t=e.conditions)===null||t===void 0?void 0:t.utm))return!0;var r=lt.campaignParams();if(r.utm_source){var s,a,u,h,p,m,g,f,b,y,E,T,z,j,$,ae,oe=(s=e.conditions)===null||s===void 0||(a=s.utm)===null||a===void 0||!a.utm_campaign||((u=e.conditions)===null||u===void 0||(h=u.utm)===null||h===void 0?void 0:h.utm_campaign)==r.utm_campaign,Se=(p=e.conditions)===null||p===void 0||(m=p.utm)===null||m===void 0||!m.utm_source||((g=e.conditions)===null||g===void 0||(f=g.utm)===null||f===void 0?void 0:f.utm_source)==r.utm_source,qe=(b=e.conditions)===null||b===void 0||(y=b.utm)===null||y===void 0||!y.utm_medium||((E=e.conditions)===null||E===void 0||(T=E.utm)===null||T===void 0?void 0:T.utm_medium)==r.utm_medium,be=(z=e.conditions)===null||z===void 0||(j=z.utm)===null||j===void 0||!j.utm_term||(($=e.conditions)===null||$===void 0||(ae=$.utm)===null||ae===void 0?void 0:ae.utm_term)==r.utm_term;return oe&&qe&&be&&Se}return!1}static logInfo(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];fe.info("[WebExperiments] ".concat(e),r)}applyTransforms(e,t,r,s){var a;this._is_bot()?yt.logInfo("Refusing to render web experiment since the viewer is a likely bot"):t!=="control"?r.forEach(u=>{if(u.selector){var h;yt.logInfo("applying transform of variant ".concat(t," for experiment ").concat(e," "),u);var p,m=0,g=(h=document)===null||h===void 0?void 0:h.querySelectorAll(u.selector);g?.forEach(f=>{var b=f;m+=1,u.attributes&&u.attributes.forEach(y=>{switch(y.name){case"text":b.innerText=y.value;break;case"html":b.innerHTML=y.value;break;case"cssClass":b.className=y.value;break;default:b.setAttribute(y.name,y.value)}}),u.text&&(b.innerText=u.text),u.html&&(b.parentElement?b.parentElement.innerHTML=u.html:b.innerHTML=u.html),u.css&&b.setAttribute("style",u.css)}),this.instance&&this.instance.capture&&this.instance.capture("$web_experiment_applied",{$web_experiment_name:e,$web_experiment_variant:t,$web_experiment_preview:s,$web_experiment_document_url:(p=yt.getWindowLocation())===null||p===void 0?void 0:p.href,$web_experiment_elements_modified:m})}}):(yt.logInfo("Control variants leave the page unmodified."),this.instance&&this.instance.capture&&this.instance.capture("$web_experiment_applied",{$web_experiment_name:e,$web_experiment_preview:s,$web_experiment_variant:t,$web_experiment_document_url:(a=yt.getWindowLocation())===null||a===void 0?void 0:a.href,$web_experiment_elements_modified:0}))}_is_bot(){return Vt&&this.instance?Cu(Vt,this.instance.config.custom_blocked_useragents):void 0}}class ch{constructor(e){this.instance=e}sendExceptionEvent(e){this.instance.capture("$exception",e,{_noTruncate:!0,_batchKey:"exceptionEvent"})}}var dh=["$set_once","$set"],$r=jt("[SiteApps]");class hh{constructor(e){this.instance=e,this.bufferedInvocations=[],this.apps={}}get isEnabled(){return!!this.instance.config.opt_in_site_apps}eventCollector(e,t){if(t){var r=this.globalsForEvent(t);this.bufferedInvocations.push(r),this.bufferedInvocations.length>1e3&&(this.bufferedInvocations=this.bufferedInvocations.slice(10))}}get siteAppLoaders(){var e,t;return(e=Le._POSTHOG_REMOTE_CONFIG)===null||e===void 0||(t=e[this.instance.config.token])===null||t===void 0?void 0:t.siteApps}init(){if(this.isEnabled){var e=this.instance._addCaptureHook(this.eventCollector.bind(this));this.stopBuffering=()=>{e(),this.bufferedInvocations=[],this.stopBuffering=void 0}}}globalsForEvent(e){var t,r,s,a,u,h,p;if(!e)throw new Error("Event payload is required");var m={},g=this.instance.get_property("$groups")||[],f=this.instance.get_property("$stored_group_properties")||{};for(var[b,y]of Object.entries(f))m[b]={id:g[b],type:b,properties:y};var{$set_once:E,$set:T}=e;return{event:P(P({},Il(e,dh)),{},{properties:P(P(P({},e.properties),T?{$set:P(P({},(t=(r=e.properties)===null||r===void 0?void 0:r.$set)!==null&&t!==void 0?t:{}),T)}:{}),E?{$set_once:P(P({},(s=(a=e.properties)===null||a===void 0?void 0:a.$set_once)!==null&&s!==void 0?s:{}),E)}:{}),elements_chain:(u=(h=e.properties)===null||h===void 0?void 0:h.$elements_chain)!==null&&u!==void 0?u:"",distinct_id:(p=e.properties)===null||p===void 0?void 0:p.distinct_id}),person:{properties:this.instance.get_property("$stored_person_properties")},groups:m}}setupSiteApp(e){var t={id:e.id,loaded:!1,errored:!1};this.apps[e.id]=t;var r=a=>{var u;for(var h of(this.apps[e.id].errored=!a,this.apps[e.id].loaded=!0,$r.info("Site app with id ".concat(e.id," ").concat(a?"loaded":"errored")),a&&this.bufferedInvocations.length&&($r.info("Processing ".concat(this.bufferedInvocations.length," events for site app with id ").concat(e.id)),this.bufferedInvocations.forEach(p=>{var m;return(m=t.processEvent)===null||m===void 0?void 0:m.call(t,p)})),Object.values(this.apps)))if(!h.loaded)return;(u=this.stopBuffering)===null||u===void 0||u.call(this)};try{var{processEvent:s}=e.init({posthog:this.instance,callback:a=>{r(a)}});s&&(t.processEvent=s)}catch(a){$r.error("Error while initializing PostHog app with config id ".concat(e.id),a),r(!1)}}onCapturedEvent(e){if(Object.keys(this.apps).length!==0){var t=this.globalsForEvent(e);for(var r of Object.values(this.apps))try{var s;(s=r.processEvent)===null||s===void 0||s.call(r,t)}catch(a){$r.error("Error while processing event ".concat(e.event," for site app ").concat(r.id),a)}}}onRemoteConfig(e){var t,r,s,a=this;if((t=this.siteAppLoaders)!==null&&t!==void 0&&t.length){if(!this.isEnabled)return void $r.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.');for(var u of this.siteAppLoaders)this.setupSiteApp(u);this.instance.on("eventCaptured",g=>this.onCapturedEvent(g))}else if((r=this.stopBuffering)===null||r===void 0||r.call(this),(s=e.siteApps)!==null&&s!==void 0&&s.length)if(this.isEnabled){var h=function(g,f){var b,y;Le["__$$ph_site_app_".concat(g)]=a.instance,(b=Le.__PosthogExtensions__)===null||b===void 0||(y=b.loadSiteApp)===null||y===void 0||y.call(b,a.instance,f,E=>{if(E)return $r.error("Error while initializing PostHog app with config id ".concat(g),E)})};for(var{id:p,url:m}of e.siteApps)h(p,m)}else $r.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}var On={},es=()=>{},tn="posthog",Tu=!Rd&&bt?.indexOf("MSIE")===-1&&bt?.indexOf("Mozilla")===-1,yl=()=>{var n,e,t;return{api_host:"https://us.i.posthog.com",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(e=he?.location,t=e?.hostname,!!xt(t)&&t.split(".").slice(-2).join(".")!=="herokuapp.com"),persistence:"localStorage+cookie",persistence_name:"",loaded:es,store_google:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:"if_capture_pageview",debug:Ht&&xt(Ht?.search)&&Ht.search.indexOf("__posthog_debug=true")!==-1||!1,verbose:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_web_experiments:!0,disable_surveys:!1,enable_recording_console_log:void 0,secure_cookie:(C==null||(n=C.location)===null||n===void 0?void 0:n.protocol)==="https:",ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,on_request_error:r=>{var s="Bad HTTP status: "+r.statusCode+" "+r.text;fe.error(s)},get_device_id:r=>r,_onCapture:es,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"identified_only",__add_tracing_headers:!1,before_send:void 0}},bl=n=>{var e={};pe(n.process_person)||(e.person_profiles=n.process_person),pe(n.xhr_headers)||(e.request_headers=n.xhr_headers),pe(n.cookie_name)||(e.persistence_name=n.cookie_name),pe(n.disable_cookie)||(e.disable_persistence=n.disable_cookie);var t=Lt({},e,n);return ht(n.property_blacklist)&&(pe(n.property_denylist)?t.property_denylist=n.property_blacklist:ht(n.property_denylist)?t.property_denylist=[...n.property_blacklist,...n.property_denylist]:fe.error("Invalid value for property_denylist config: "+n.property_denylist)),t};class ph{constructor(){U(this,"__forceAllowLocalhost",!1)}get _forceAllowLocalhost(){return this.__forceAllowLocalhost}set _forceAllowLocalhost(e){fe.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}class Di{get decideEndpointWasHit(){var e,t;return(e=(t=this.featureFlags)===null||t===void 0?void 0:t.hasLoadedFlags)!==null&&e!==void 0&&e}constructor(){U(this,"webPerformance",new ph),U(this,"version",_r.LIB_VERSION),U(this,"_internalEventEmitter",new pu),this.config=yl(),this.SentryIntegration=Fd,this.sentryIntegration=e=>function(t,r){var s=hu(t,r);return{name:du,processEvent:a=>s(a)}}(this,e),this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this._initialPageviewCaptured=!1,this._initialPersonProfilesConfig=null,this.featureFlags=new Oc(this),this.toolbar=new kd(this),this.scrollManager=new Qd(this),this.pageViewManager=new Pd(this),this.surveys=new qd(this),this.experiments=new yt(this),this.exceptions=new ch(this),this.rateLimiter=new Ud(this),this.requestRouter=new Nd(this),this.consent=new sh(this),this.people={set:(e,t,r)=>{var s=xt(e)?{[e]:t}:e;this.setPersonProperties(s),r?.({})},set_once:(e,t,r)=>{var s=xt(e)?{[e]:t}:e;this.setPersonProperties(void 0,s),r?.({})}},this.on("eventCaptured",e=>fe.info('send "'.concat(e?.event,'"'),e))}init(e,t,r){if(r&&r!==tn){var s,a=(s=On[r])!==null&&s!==void 0?s:new Di;return a._init(e,t,r),On[r]=a,On[tn][r]=a,a}return this._init(e,t,r)}_init(e){var t,r,s,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=arguments.length>2?arguments[2]:void 0;if(pe(e)||ka(e))return fe.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return fe.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;this.__loaded=!0,this.config={},this._triggered_notifs=[],a.person_profiles&&(this._initialPersonProfilesConfig=a.person_profiles),this.set_config(Lt({},yl(),bl(a),{name:u,token:e})),this.config.on_xhr_error&&fe.error("on_xhr_error is deprecated. Use on_request_error instead"),this.compression=a.disable_compression?void 0:ar.GZipJS,this.persistence=new wo(this.config),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new wo(P(P({},this.config),{},{persistence:"sessionStorage"}));var h=P({},this.persistence.props),p=P({},this.sessionPersistence.props);if(this._requestQueue=new Td($=>this._send_retriable_request($)),this._retryQueue=new Ad(this),this.__request_queue=[],this.config.__preview_experimental_cookieless_mode||(this.sessionManager=new Od(this),this.sessionPropsManager=new zd(this.sessionManager,this.persistence)),new oh(this).startIfEnabledOrStop(),this.siteApps=new hh(this),(t=this.siteApps)===null||t===void 0||t.init(),this.config.__preview_experimental_cookieless_mode||(this.sessionRecording=new Id(this),this.sessionRecording.startIfEnabledOrStop()),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new nh(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new Kd(this),this.heatmaps.startIfEnabled(),this.webVitalsAutocapture=new lh(this),this.exceptionObserver=new ah(this),this.exceptionObserver.startIfEnabled(),this.deadClicksAutocapture=new ku(this,Xd),this.deadClicksAutocapture.startIfEnabled(),_r.DEBUG=_r.DEBUG||this.config.debug,_r.DEBUG&&fe.info("Starting in debug mode",{this:this,config:a,thisC:P({},this.config),p:h,s:p}),this._sync_opt_out_with_persistence(),((r=a.bootstrap)===null||r===void 0?void 0:r.distinctID)!==void 0){var m,g,f=this.config.get_device_id(xr()),b=(m=a.bootstrap)!==null&&m!==void 0&&m.isIdentifiedID?f:a.bootstrap.distinctID;this.persistence.set_property(fr,(g=a.bootstrap)!==null&&g!==void 0&&g.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:a.bootstrap.distinctID,$device_id:b})}if(this._hasBootstrappedFeatureFlags()){var y,E,T=Object.keys(((y=a.bootstrap)===null||y===void 0?void 0:y.featureFlags)||{}).filter($=>{var ae,oe;return!((ae=a.bootstrap)===null||ae===void 0||(oe=ae.featureFlags)===null||oe===void 0||!oe[$])}).reduce(($,ae)=>{var oe,Se;return $[ae]=((oe=a.bootstrap)===null||oe===void 0||(Se=oe.featureFlags)===null||Se===void 0?void 0:Se[ae])||!1,$},{}),z=Object.keys(((E=a.bootstrap)===null||E===void 0?void 0:E.featureFlagPayloads)||{}).filter($=>T[$]).reduce(($,ae)=>{var oe,Se,qe,be;return(oe=a.bootstrap)!==null&&oe!==void 0&&(Se=oe.featureFlagPayloads)!==null&&Se!==void 0&&Se[ae]&&($[ae]=(qe=a.bootstrap)===null||qe===void 0||(be=qe.featureFlagPayloads)===null||be===void 0?void 0:be[ae]),$},{});this.featureFlags.receivedFeatureFlags({featureFlags:T,featureFlagPayloads:z})}if(this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Ba,$device_id:null},"");else if(!this.get_distinct_id()){var j=this.config.get_device_id(xr());this.register_once({distinct_id:j,$device_id:j},""),this.persistence.set_property(fr,"anonymous")}return C==null||(s=C.addEventListener)===null||s===void 0||s.call(C,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),this.toolbar.maybeLoadToolbar(),a.segment?Ld(this,()=>this._loaded()):this._loaded(),Jt(this.config._onCapture)&&this.config._onCapture!==es&&(fe.warn("onCapture is deprecated. Please use `before_send` instead"),this.on("eventCaptured",$=>this.config._onCapture($.event,$))),this}_onRemoteConfig(e){var t,r,s,a,u,h,p,m,g;if(!he||!he.body)return fe.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout(()=>{this._onRemoteConfig(e)},500);this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=De(e.supportedCompression,ar.GZipJS)?ar.GZipJS:De(e.supportedCompression,ar.Base64)?ar.Base64:void 0),(t=e.analytics)!==null&&t!==void 0&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),this.set_config({person_profiles:this._initialPersonProfilesConfig?this._initialPersonProfilesConfig:e.defaultIdentifiedOnly?"identified_only":"always"}),(r=this.siteApps)===null||r===void 0||r.onRemoteConfig(e),(s=this.sessionRecording)===null||s===void 0||s.onRemoteConfig(e),(a=this.autocapture)===null||a===void 0||a.onRemoteConfig(e),(u=this.heatmaps)===null||u===void 0||u.onRemoteConfig(e),(h=this.surveys)===null||h===void 0||h.onRemoteConfig(e),(p=this.webVitalsAutocapture)===null||p===void 0||p.onRemoteConfig(e),(m=this.exceptionObserver)===null||m===void 0||m.onRemoteConfig(e),(g=this.deadClicksAutocapture)===null||g===void 0||g.onRemoteConfig(e)}_loaded(){try{this.config.loaded(this)}catch(e){fe.critical("`loaded` function failed",e)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout(()=>{this.consent.isOptedIn()&&this._captureInitialPageview()},1),new Cd(this).load(),this.featureFlags.decide()}_start_queue_if_opted_in(){var e;this.has_opted_out_capturing()||this.config.request_batching&&((e=this._requestQueue)===null||e===void 0||e.enable())}_dom_loaded(){this.has_opted_out_capturing()||on(this.__request_queue,e=>this._send_retriable_request(e)),this.__request_queue=[],this._start_queue_if_opted_in()}_handle_unload(){var e,t;this.config.request_batching?(this._shouldCapturePageleave()&&this.capture("$pageleave"),(e=this._requestQueue)===null||e===void 0||e.unload(),(t=this._retryQueue)===null||t===void 0||t.unload()):this._shouldCapturePageleave()&&this.capture("$pageleave",null,{transport:"sendBeacon"})}_send_request(e){this.__loaded&&(Tu?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=Mi(e.url,{ip:this.config.ip?1:0}),e.headers=P({},this.config.request_headers),e.compression=e.compression==="best-available"?this.compression:e.compression,e.fetchOptions=e.fetchOptions||this.config.fetch_options,(t=>{var r,s,a,u=P({},t);u.timeout=u.timeout||6e4,u.url=Mi(u.url,{_:new Date().getTime().toString(),ver:_r.LIB_VERSION,compression:u.compression});var h=(r=u.transport)!==null&&r!==void 0?r:"fetch",p=(s=(a=xl(An,m=>m.transport===h))===null||a===void 0?void 0:a.method)!==null&&s!==void 0?s:An[0].method;if(!p)throw new Error("No available transport method");p(u)})(P(P({},e),{},{callback:t=>{var r,s,a;this.rateLimiter.checkForLimiting(t),t.statusCode>=400&&((s=(a=this.config).on_request_error)===null||s===void 0||s.call(a,t)),(r=e.callback)===null||r===void 0||r.call(e,t)}}))))}_send_retriable_request(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}_execute_array(e){var t,r=[],s=[],a=[];on(e,h=>{h&&(t=h[0],ht(t)?a.push(h):Jt(h)?h.call(this):ht(h)&&t==="alias"?r.push(h):ht(h)&&t.indexOf("capture")!==-1&&Jt(this[t])?a.push(h):s.push(h))});var u=function(h,p){on(h,function(m){if(ht(m[0])){var g=p;Ke(m,function(f){g=g[f[0]].apply(g,f.slice(1))})}else this[m[0]].apply(this,m.slice(1))},p)};u(r,this),u(s,this),u(a,this)}_hasBootstrappedFeatureFlags(){var e,t;return((e=this.config.bootstrap)===null||e===void 0?void 0:e.featureFlags)&&Object.keys((t=this.config.bootstrap)===null||t===void 0?void 0:t.featureFlags).length>0||!1}push(e){this._execute_array([e])}capture(e,t,r){var s;if(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue){if(!this.consent.isOptedOut())if(!pe(e)&&xt(e)){if(this.config.opt_out_useragent_filter||!this._is_bot()){var a=r!=null&&r.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(a==null||!a.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.store_google&&this.sessionPersistence.update_campaign_params(),this.config.save_referrer&&this.sessionPersistence.update_referrer_info(),(this.config.store_google||this.config.save_referrer)&&this.persistence.set_initial_person_info();var u=new Date,h=r?.timestamp||u,p={uuid:xr(),event:e,properties:this._calculate_event_properties(e,t||{},h)};a&&(p.properties.$lib_rate_limit_remaining_tokens=a.remainingTokens),r?.$set&&(p.$set=r?.$set);var m=this._calculate_set_once_properties(r?.$set_once);m&&(p.$set_once=m),(p=Mc(p,r!=null&&r._noTruncate?null:this.config.properties_string_max_length)).timestamp=h,pe(r?.timestamp)||(p.properties.$event_time_override_provided=!0,p.properties.$event_time_override_system_time=u);var g=P(P({},p.properties.$set),p.$set);if(rn(g)||this.setPersonPropertiesForFlags(g),!Qe(this.config.before_send)){var f=this._runBeforeSend(p);if(!f)return;p=f}this._internalEventEmitter.emit("eventCaptured",p);var b={method:"POST",url:(s=r?._url)!==null&&s!==void 0?s:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:p,compression:"best-available",batchKey:r?._batchKey};return!this.config.request_batching||r&&(r==null||!r._batchKey)||r!=null&&r.send_instantly?this._send_retriable_request(b):this._requestQueue.enqueue(b),p}fe.critical("This capture call is ignored due to client rate limiting.")}}else fe.error("No event name provided to posthog.capture")}else fe.uninitializedWarning("posthog.capture")}_addCaptureHook(e){return this.on("eventCaptured",t=>e(t.event,t))}_calculate_event_properties(e,t,r){if(r=r||new Date,!this.persistence||!this.sessionPersistence)return t;var s=this.persistence.remove_event_timer(e),a=P({},t);if(a.token=this.config.token,this.config.__preview_experimental_cookieless_mode&&(a.$cklsh_mode=!0),e==="$snapshot"){var u=P(P({},this.persistence.properties()),this.sessionPersistence.properties());return a.distinct_id=u.distinct_id,(!xt(a.distinct_id)&&!Ft(a.distinct_id)||ka(a.distinct_id))&&fe.error("Invalid distinct_id for replay event. This indicates a bug in your implementation"),a}var h=lt.properties();if(this.sessionManager){var{sessionId:p,windowId:m}=this.sessionManager.checkAndGetSessionAndWindowId();a.$session_id=p,a.$window_id=m}if(this.sessionRecording&&(a.$recording_status=this.sessionRecording.status),this.requestRouter.region===Ur.CUSTOM&&(a.$lib_custom_api_host=this.config.api_host),this.sessionPropsManager&&this.config.__preview_send_client_session_params&&(e==="$pageview"||e==="$pageleave"||e==="$autocapture")){var g=this.sessionPropsManager.getSessionProps();a=Lt(a,g)}if(!this.config.disable_scroll_properties){var f={};e==="$pageview"?f=this.pageViewManager.doPageView(r):e==="$pageleave"&&(f=this.pageViewManager.doPageLeave(r)),a=Lt(a,f)}if(e==="$pageview"&&he&&(a.title=he.title),!pe(s)){var b=r.getTime()-s;a.$duration=parseFloat((b/1e3).toFixed(3))}bt&&this.config.opt_out_useragent_filter&&(a.$browser_type=this._is_bot()?"bot":"browser"),(a=Lt({},h,this.persistence.properties(),this.sessionPersistence.properties(),a)).$is_identified=this._isIdentified(),ht(this.config.property_denylist)?Ke(this.config.property_denylist,function(T){delete a[T]}):fe.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var y=this.config.sanitize_properties;y&&(a=y(a,e));var E=this._hasPersonProcessing();return a.$process_person_profile=E,E&&this._requirePersonProcessing("_calculate_event_properties"),a}_calculate_set_once_properties(e){if(!this.persistence||!this._hasPersonProcessing())return e;var t=Lt({},this.persistence.get_initial_props(),e||{}),r=this.config.sanitize_properties;return r&&(t=r(t,"$set_once")),rn(t)?void 0:t}register(e,t){var r;(r=this.persistence)===null||r===void 0||r.register(e,t)}register_once(e,t,r){var s;(s=this.persistence)===null||s===void 0||s.register_once(e,t,r)}register_for_session(e){var t;(t=this.sessionPersistence)===null||t===void 0||t.register(e)}unregister(e){var t;(t=this.persistence)===null||t===void 0||t.unregister(e)}unregister_for_session(e){var t;(t=this.sessionPersistence)===null||t===void 0||t.unregister(e)}_register_single(e,t){this.register({[e]:t})}getFeatureFlag(e,t){return this.featureFlags.getFeatureFlag(e,t)}getFeatureFlagPayload(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch{return t}}isFeatureEnabled(e,t){return this.featureFlags.isFeatureEnabled(e,t)}reloadFeatureFlags(){this.featureFlags.reloadFeatureFlags()}updateEarlyAccessFeatureEnrollment(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}getEarlyAccessFeatures(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,t)}on(e,t){return this._internalEventEmitter.on(e,t)}onFeatureFlags(e){return this.featureFlags.onFeatureFlags(e)}onSessionId(e){var t,r;return(t=(r=this.sessionManager)===null||r===void 0?void 0:r.onSessionId(e))!==null&&t!==void 0?t:()=>{}}getSurveys(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getSurveys(e,t)}getActiveMatchingSurveys(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this.surveys.getActiveMatchingSurveys(e,t)}renderSurvey(e,t){this.surveys.renderSurvey(e,t)}canRenderSurvey(e){this.surveys.canRenderSurvey(e)}getNextSurveyStep(e,t,r){return this.surveys.getNextSurveyStep(e,t,r)}identify(e,t,r){if(!this.__loaded||!this.persistence)return fe.uninitializedWarning("posthog.identify");if(Ft(e)&&(e=e.toString(),fe.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))fe.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var s=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var a=s;this.register_once({$had_persisted_distinct_id:!0,$device_id:a},"")}e!==s&&e!==this.get_property(Cn)&&(this.unregister(Cn),this.register({distinct_id:e}));var u=(this.persistence.get_property(fr)||"anonymous")==="anonymous";e!==s&&u?(this.persistence.set_property(fr,"identified"),this.setPersonPropertiesForFlags(t||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:s},{$set:t||{},$set_once:r||{}}),this.featureFlags.setAnonymousDistinctId(s)):(t||r)&&this.setPersonProperties(t,r),e!==s&&(this.reloadFeatureFlags(),this.unregister(wi))}}else fe.error("Unique user id has not been set in posthog.identify")}setPersonProperties(e,t){(e||t)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:t||{}}))}group(e,t,r){if(e&&t){if(this._requirePersonProcessing("posthog.group")){var s=this.getGroups();s[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:P(P({},s),{},{[e]:t})}),r&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:r}),this.setGroupPropertiesForFlags({[e]:r})),s[e]===t||r||this.reloadFeatureFlags()}}else fe.error("posthog.group requires a group type and group key")}resetGroups(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}setPersonPropertiesForFlags(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.featureFlags.setPersonPropertiesForFlags(e,t)}resetPersonPropertiesForFlags(){this.featureFlags.resetPersonPropertiesForFlags()}setGroupPropertiesForFlags(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}resetGroupPropertiesForFlags(e){this.featureFlags.resetGroupPropertiesForFlags(e)}reset(e){var t,r,s,a,u;if(fe.info("reset"),!this.__loaded)return fe.uninitializedWarning("posthog.reset");var h=this.get_property("$device_id");if(this.consent.reset(),(t=this.persistence)===null||t===void 0||t.clear(),(r=this.sessionPersistence)===null||r===void 0||r.clear(),(s=this.surveys)===null||s===void 0||s.reset(),(a=this.persistence)===null||a===void 0||a.set_property(fr,"anonymous"),(u=this.sessionManager)===null||u===void 0||u.resetSessionId(),this.config.__preview_experimental_cookieless_mode)this.register_once({distinct_id:Ba,$device_id:null},"");else{var p=this.config.get_device_id(xr());this.register_once({distinct_id:p,$device_id:e?p:h},"")}}get_distinct_id(){return this.get_property("distinct_id")}getGroups(){return this.get_property("$groups")||{}}get_session_id(){var e,t;return(e=(t=this.sessionManager)===null||t===void 0?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)!==null&&e!==void 0?e:""}get_session_replay_url(e){if(!this.sessionManager)return"";var{sessionId:t,sessionStartTimestamp:r}=this.sessionManager.checkAndGetSessionAndWindowId(!0),s=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(t));if(e!=null&&e.withTimestamp&&r){var a,u=(a=e.timestampLookBack)!==null&&a!==void 0?a:10;if(!r)return s;var h=Math.max(Math.floor((new Date().getTime()-r)/1e3)-u,0);s+="?t=".concat(h)}return s}alias(e,t){return e===this.get_property(Rl)?(fe.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(pe(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(Cn,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(fe.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}set_config(e){var t,r,s,a,u=P({},this.config);dt(e)&&(Lt(this.config,bl(e)),(t=this.persistence)===null||t===void 0||t.update_config(this.config,u),this.sessionPersistence=this.config.persistence==="sessionStorage"||this.config.persistence==="memory"?this.persistence:new wo(P(P({},this.config),{},{persistence:"sessionStorage"})),mt.is_supported()&&mt.get("ph_debug")==="true"&&(this.config.debug=!0),this.config.debug&&(_r.DEBUG=!0,fe.info("set_config",{config:e,oldConfig:u,newConfig:P({},this.config)})),(r=this.sessionRecording)===null||r===void 0||r.startIfEnabledOrStop(),(s=this.autocapture)===null||s===void 0||s.startIfEnabled(),(a=this.heatmaps)===null||a===void 0||a.startIfEnabled(),this.surveys.loadIfEnabled(),this._sync_opt_out_with_persistence())}startSessionRecording(e){var t=e===!0,r={sampling:t||!(e==null||!e.sampling),linked_flag:t||!(e==null||!e.linked_flag),url_trigger:t||!(e==null||!e.url_trigger),event_trigger:t||!(e==null||!e.event_trigger)};if(Object.values(r).some(Boolean)){var s,a,u,h,p;(s=this.sessionManager)===null||s===void 0||s.checkAndGetSessionAndWindowId(),r.sampling&&((a=this.sessionRecording)===null||a===void 0||a.overrideSampling()),r.linked_flag&&((u=this.sessionRecording)===null||u===void 0||u.overrideLinkedFlag()),r.url_trigger&&((h=this.sessionRecording)===null||h===void 0||h.overrideTrigger("url")),r.event_trigger&&((p=this.sessionRecording)===null||p===void 0||p.overrideTrigger("event"))}this.set_config({disable_session_recording:!1})}stopSessionRecording(){this.set_config({disable_session_recording:!0})}sessionRecordingStarted(){var e;return!((e=this.sessionRecording)===null||e===void 0||!e.started)}captureException(e,t){var r,s=new Error("PostHog syntheticException"),a=Jt((r=Le.__PosthogExtensions__)===null||r===void 0?void 0:r.parseErrorAsProperties)?Le.__PosthogExtensions__.parseErrorAsProperties([e.message,void 0,void 0,void 0,e],{syntheticException:s}):P({$exception_level:"error",$exception_list:[{type:e.name,value:e.message,mechanism:{handled:!0,synthetic:!1}}]},t);this.exceptions.sendExceptionEvent(a)}loadToolbar(e){return this.toolbar.loadToolbar(e)}get_property(e){var t;return(t=this.persistence)===null||t===void 0?void 0:t.props[e]}getSessionProperty(e){var t;return(t=this.sessionPersistence)===null||t===void 0?void 0:t.props[e]}toString(){var e,t=(e=this.config.name)!==null&&e!==void 0?e:tn;return t!==tn&&(t=tn+"."+t),t}_isIdentified(){var e,t;return((e=this.persistence)===null||e===void 0?void 0:e.get_property(fr))==="identified"||((t=this.sessionPersistence)===null||t===void 0?void 0:t.get_property(fr))==="identified"}_hasPersonProcessing(){var e,t,r,s;return!(this.config.person_profiles==="never"||this.config.person_profiles==="identified_only"&&!this._isIdentified()&&rn(this.getGroups())&&((e=this.persistence)===null||e===void 0||(t=e.props)===null||t===void 0||!t[Cn])&&((r=this.persistence)===null||r===void 0||(s=r.props)===null||s===void 0||!s[Si]))}_shouldCapturePageleave(){return this.config.capture_pageleave===!0||this.config.capture_pageleave==="if_capture_pageview"&&this.config.capture_pageview}createPersonProfile(){this._hasPersonProcessing()||this._requirePersonProcessing("posthog.createPersonProfile")&&this.setPersonProperties({},{})}_requirePersonProcessing(e){return this.config.person_profiles==="never"?(fe.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(Si,!0),!0)}_sync_opt_out_with_persistence(){var e,t,r,s,a=this.consent.isOptedOut(),u=this.config.opt_out_persistence_by_default,h=this.config.disable_persistence||a&&!!u;((e=this.persistence)===null||e===void 0?void 0:e.disabled)!==h&&((r=this.persistence)===null||r===void 0||r.set_disabled(h)),((t=this.sessionPersistence)===null||t===void 0?void 0:t.disabled)!==h&&((s=this.sessionPersistence)===null||s===void 0||s.set_disabled(h))}opt_in_capturing(e){var t;this.consent.optInOut(!0),this._sync_opt_out_with_persistence(),(pe(e?.captureEventName)||e!=null&&e.captureEventName)&&this.capture((t=e?.captureEventName)!==null&&t!==void 0?t:"$opt_in",e?.captureProperties,{send_instantly:!0}),this.config.capture_pageview&&this._captureInitialPageview()}opt_out_capturing(){this.consent.optInOut(!1),this._sync_opt_out_with_persistence()}has_opted_in_capturing(){return this.consent.isOptedIn()}has_opted_out_capturing(){return this.consent.isOptedOut()}clear_opt_in_out_capturing(){this.consent.reset(),this._sync_opt_out_with_persistence()}_is_bot(){return Vt?Cu(Vt,this.config.custom_blocked_useragents):void 0}_captureInitialPageview(){he&&!this._initialPageviewCaptured&&(this._initialPageviewCaptured=!0,this.capture("$pageview",{title:he.title},{send_instantly:!0}))}debug(e){e===!1?(C?.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(C?.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}_runBeforeSend(e){if(Qe(this.config.before_send))return e;var t=ht(this.config.before_send)?this.config.before_send:[this.config.before_send],r=e;for(var s of t){if(r=s(r),Qe(r)){var a="Event '".concat(e.event,"' was rejected in beforeSend function");return xc(e.event)?fe.warn("".concat(a,". This can cause unexpected behavior.")):fe.info(a),null}r.properties&&!rn(r.properties)||fe.warn("Event '".concat(e.event,"' has no properties after beforeSend function, this is likely an error."))}return r}}(function(n,e){for(var t=0;t<e.length;t++)n.prototype[e[t]]=Rc(n.prototype[e[t]])})(Di,["identify"]);var wl,gh=(wl=On[tn]=new Di,function(){function n(){n.done||(n.done=!0,Tu=!1,Ke(On,function(e){e._dom_loaded()}))}he!=null&&he.addEventListener&&(he.readyState==="complete"?n():he.addEventListener("DOMContentLoaded",n,!1)),C&&yr(C,"load",n,!0)}(),wl);export{gh as posthog};
