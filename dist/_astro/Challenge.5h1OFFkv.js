import{j as s}from"./jsx-runtime.vlAWDSmm.js";import{r as n}from"./index.BwNzhqGF.js";import{c as R}from"./index.BQXz43h1.js";import{s as _}from"./pathHelpers.kwYD5byA.js";import{g as $,Q as w}from"./QuestionStore.Dp9S3Fqa.js";import{c as j}from"./clsx.B-dksMZM.js";import"./_commonjsHelpers.Cpj98o6Y.js";const B=n.createContext({answers:[],setAnswers:()=>{},currentChallenge:0,setCurrentChallenge:()=>{},totalQuestions:0,setTotalQuestions:()=>{},correctAnswers:0,setCorrectAnswers:()=>{}}),i=$();function P({children:S,title:a,group:x,question:o,options:u,explanation:A,index:l}){let t=null;const{setTotalQuestions:E,setCorrectAnswers:T}=n.useContext(B),p=n.useRef(null),[c,h]=n.useState("untouched"),[d,g]=n.useState(void 0),[f,z]=n.useState(!1),[N,Q]=n.useState(A),[v,b]=n.useState(0),y=()=>{const e=document.querySelectorAll("main .challenge"),r=document.querySelectorAll("main .challenge.correct");E(e?.length),T(r?.length)};n.useEffect(()=>{t||(t=w(i?.location.pathname)),t&&b(t.sumOfTries())},[i?.location?.pathname]),n.useEffect(()=>{t||(t=w(i?.location.pathname)),t&&t.addQuestion({title:a,group:x,question:o,index:l})},[t,a,x,o,u,A]),n.useEffect(()=>{const e=t?.isCorrect({index:l})??void 0;g(e),h(e===!0?"correct":e===!1?"incorrect":"")},[]);const k=(e,r)=>{const m=i?.posthog;m&&m.capture(e,r)},H=e=>{t||(t=w(i?.location.pathname)),t?.answerQuestion({index:l},e),e.isAnswer?(g(!0),h("correct pulse")):(g(!1),h("incorrect shake")),k("QuizAnswer",{isCorrect:e.isAnswer,option:e,question:o||"",title:a,questionIndex:l}),setTimeout(y,20)};n.useEffect(()=>{const e=c.includes("shake")||c.includes("pulse");if(c&&e){const r=c.split(" ").filter(m=>!["shake","pulse"].includes(m));setTimeout(()=>{h(r.join(" "))},1e3)}},[c]),n.useEffect(()=>{if(p.current){const e=p.current.querySelector("div.explanation")?.innerHTML;e&&Q(e)}},[N]);const C=(l??0)+1;u.filter(e=>e.isAnswer).length===0&&console.error("No correct answers found for question:",o,a,u);const q=u.map(e=>{const r=d&&e.isAnswer;return d&&!e.isAnswer?null:s.jsx("a",{className:R("option",{"correct-answer":r}),onClick:()=>!d&&H(e),children:s.jsx("label",{children:e.text})},e.text)}).filter(Boolean);return s.jsxs("div",{id:`qq-${C}`,className:j("challenge",c),ref:p,"data-answer-count":v,"data-question-correct":d,children:[s.jsxs("div",{className:"quiz-header",children:[s.jsxs("div",{className:"quiz-question-count",children:[s.jsxs("a",{href:`#qq-${C}`,children:[C,"."]}),"Â "]}),s.jsx("h2",{className:"quiz-title",id:_(a),children:x})]}),s.jsx("div",{className:"quiz-question",children:o||S}),s.jsx("aside",{className:"quiz-hint-toggle",children:s.jsxs("button",{onClick:()=>z(!f),className:j("hint-toggle",{open:f}),children:[f?"Hide":"Show"," Explainer"," "]})}),s.jsxs("section",{className:j("quiz-body-panel","card-container",{"card-flip":f}),style:{height:`${80*q.length}px`,transition:"height 0.2s ease-in-out"},children:[s.jsx("section",{className:"quiz-options card card-front",children:q}),s.jsx("section",{className:"explanation card card-back ",children:s.jsx("p",{className:"help-box",dangerouslySetInnerHTML:{__html:N}})})]})]})}export{P as default};
